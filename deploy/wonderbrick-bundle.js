(()=>{var ii=Object.create;var pt=Object.defineProperty;var ri=Object.getOwnPropertyDescriptor;var si=Object.getOwnPropertyNames;var oi=Object.getPrototypeOf,ai=Object.prototype.hasOwnProperty;var li=(t,e,n)=>e in t?pt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ci=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Je=(t,e)=>{for(var n in e)pt(t,n,{get:e[n],enumerable:!0})},_i=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of si(e))!ai.call(t,s)&&s!==n&&pt(t,s,{get:()=>e[s],enumerable:!(i=ri(e,s))||i.enumerable});return t};var hn=(t,e,n)=>(n=t!=null?ii(oi(t)):{},_i(e||!t||!t.__esModule?pt(n,"default",{value:t,enumerable:!0}):n,t));var M=(t,e,n)=>(li(t,typeof e!="symbol"?e+"":e,n),n);var pn=(t,e,n)=>new Promise((i,s)=>{var o=h=>{try{c(n.next(h))}catch(p){s(p)}},l=h=>{try{c(n.throw(h))}catch(p){s(p)}},c=h=>h.done?i(h.value):Promise.resolve(h.value).then(o,l);c((n=n.apply(t,e)).next())});var $t=ci(jt=>{(function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var r=this||e;return r._counter=1e3,r._html5AudioPool=[],r.html5PoolSize=10,r._codecs={},r._howls=[],r._muted=!1,r._volume=1,r._canPlayEvent="canplaythrough",r._navigator=typeof window<"u"&&window.navigator?window.navigator:null,r.masterGain=null,r.noAudio=!1,r.usingWebAudio=!0,r.autoSuspend=!0,r.ctx=null,r.autoUnlock=!0,r._setup(),r},volume:function(r){var a=this||e;if(r=parseFloat(r),a.ctx||p(),typeof r<"u"&&r>=0&&r<=1){if(a._volume=r,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(r,e.ctx.currentTime);for(var _=0;_<a._howls.length;_++)if(!a._howls[_]._webAudio)for(var m=a._howls[_]._getSoundIds(),u=0;u<m.length;u++){var f=a._howls[_]._soundById(m[u]);f&&f._node&&(f._node.volume=f._volume*r)}return a}return a._volume},mute:function(r){var a=this||e;a.ctx||p(),a._muted=r,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(r?0:a._volume,e.ctx.currentTime);for(var _=0;_<a._howls.length;_++)if(!a._howls[_]._webAudio)for(var m=a._howls[_]._getSoundIds(),u=0;u<m.length;u++){var f=a._howls[_]._soundById(m[u]);f&&f._node&&(f._node.muted=r?!0:f._muted)}return a},stop:function(){for(var r=this||e,a=0;a<r._howls.length;a++)r._howls[a].stop();return r},unload:function(){for(var r=this||e,a=r._howls.length-1;a>=0;a--)r._howls[a].unload();return r.usingWebAudio&&r.ctx&&typeof r.ctx.close<"u"&&(r.ctx.close(),r.ctx=null,p()),r},codecs:function(r){return(this||e)._codecs[r.replace(/^x-/,"")]},_setup:function(){var r=this||e;if(r.state=r.ctx&&r.ctx.state||"suspended",r._autoSuspend(),!r.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(r._canPlayEvent="canplay")}catch{r.noAudio=!0}else r.noAudio=!0;try{var a=new Audio;a.muted&&(r.noAudio=!0)}catch{}return r.noAudio||r._setupCodecs(),r},_setupCodecs:function(){var r=this||e,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return r}if(!a||typeof a.canPlayType!="function")return r;var _=a.canPlayType("audio/mpeg;").replace(/^no$/,""),m=r._navigator?r._navigator.userAgent:"",u=m.match(/OPR\/([0-6].)/g),f=u&&parseInt(u[0].split("/")[1],10)<33,d=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,b=m.match(/Version\/(.*?) /),w=d&&b&&parseInt(b[1],10)<15;return r._codecs={mp3:!!(!f&&(_||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!_,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!w&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!w&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},r},_unlockAudio:function(){var r=this||e;if(!(r._audioUnlocked||!r.ctx)){r._audioUnlocked=!1,r.autoUnlock=!1,!r._mobileUnloaded&&r.ctx.sampleRate!==44100&&(r._mobileUnloaded=!0,r.unload()),r._scratchBuffer=r.ctx.createBuffer(1,1,22050);var a=function(_){for(;r._html5AudioPool.length<r.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,r._releaseHtml5Audio(m)}catch{r.noAudio=!0;break}for(var u=0;u<r._howls.length;u++)if(!r._howls[u]._webAudio)for(var f=r._howls[u]._getSoundIds(),d=0;d<f.length;d++){var b=r._howls[u]._soundById(f[d]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}r._autoResume();var w=r.ctx.createBufferSource();w.buffer=r._scratchBuffer,w.connect(r.ctx.destination),typeof w.start>"u"?w.noteOn(0):w.start(0),typeof r.ctx.resume=="function"&&r.ctx.resume(),w.onended=function(){w.disconnect(0),r._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var y=0;y<r._howls.length;y++)r._howls[y]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),r}},_obtainHtml5Audio:function(){var r=this||e;if(r._html5AudioPool.length)return r._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(r){var a=this||e;return r._unlocked&&a._html5AudioPool.push(r),a},_autoSuspend:function(){var r=this;if(!(!r.autoSuspend||!r.ctx||typeof r.ctx.suspend>"u"||!e.usingWebAudio)){for(var a=0;a<r._howls.length;a++)if(r._howls[a]._webAudio){for(var _=0;_<r._howls[a]._sounds.length;_++)if(!r._howls[a]._sounds[_]._paused)return r}return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){if(r.autoSuspend){r._suspendTimer=null,r.state="suspending";var m=function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())};r.ctx.suspend().then(m,m)}},3e4),r}},_autoResume:function(){var r=this;if(!(!r.ctx||typeof r.ctx.resume>"u"||!e.usingWebAudio))return r.state==="running"&&r.ctx.state!=="interrupted"&&r._suspendTimer?(clearTimeout(r._suspendTimer),r._suspendTimer=null):r.state==="suspended"||r.state==="running"&&r.ctx.state==="interrupted"?(r.ctx.resume().then(function(){r.state="running";for(var a=0;a<r._howls.length;a++)r._howls[a]._emit("resume")}),r._suspendTimer&&(clearTimeout(r._suspendTimer),r._suspendTimer=null)):r.state==="suspending"&&(r._resumeAfterSuspend=!0),r}};var e=new t,n=function(r){var a=this;if(!r.src||r.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(r)};n.prototype={init:function(r){var a=this;return e.ctx||p(),a._autoplay=r.autoplay||!1,a._format=typeof r.format!="string"?r.format:[r.format],a._html5=r.html5||!1,a._muted=r.mute||!1,a._loop=r.loop||!1,a._pool=r.pool||5,a._preload=typeof r.preload=="boolean"||r.preload==="metadata"?r.preload:!0,a._rate=r.rate||1,a._sprite=r.sprite||{},a._src=typeof r.src!="string"?r.src:[r.src],a._volume=r.volume!==void 0?r.volume:1,a._xhr={method:r.xhr&&r.xhr.method?r.xhr.method:"GET",headers:r.xhr&&r.xhr.headers?r.xhr.headers:null,withCredentials:r.xhr&&r.xhr.withCredentials?r.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=r.onend?[{fn:r.onend}]:[],a._onfade=r.onfade?[{fn:r.onfade}]:[],a._onload=r.onload?[{fn:r.onload}]:[],a._onloaderror=r.onloaderror?[{fn:r.onloaderror}]:[],a._onplayerror=r.onplayerror?[{fn:r.onplayerror}]:[],a._onpause=r.onpause?[{fn:r.onpause}]:[],a._onplay=r.onplay?[{fn:r.onplay}]:[],a._onstop=r.onstop?[{fn:r.onstop}]:[],a._onmute=r.onmute?[{fn:r.onmute}]:[],a._onvolume=r.onvolume?[{fn:r.onvolume}]:[],a._onrate=r.onrate?[{fn:r.onrate}]:[],a._onseek=r.onseek?[{fn:r.onseek}]:[],a._onunlock=r.onunlock?[{fn:r.onunlock}]:[],a._onresume=[],a._webAudio=e.usingWebAudio&&!a._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var r=this,a=null;if(e.noAudio){r._emit("loaderror",null,"No audio support.");return}typeof r._src=="string"&&(r._src=[r._src]);for(var _=0;_<r._src.length;_++){var m,u;if(r._format&&r._format[_])m=r._format[_];else{if(u=r._src[_],typeof u!="string"){r._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(u),m||(m=/\.([^.]+)$/.exec(u.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&e.codecs(m)){a=r._src[_];break}}if(!a){r._emit("loaderror",null,"No codec support for selected audio sources.");return}return r._src=a,r._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(r._html5=!0,r._webAudio=!1),new i(r),r._webAudio&&o(r),r},play:function(r,a){var _=this,m=null;if(typeof r=="number")m=r,r=null;else{if(typeof r=="string"&&_._state==="loaded"&&!_._sprite[r])return null;if(typeof r>"u"&&(r="__default",!_._playLock)){for(var u=0,f=0;f<_._sounds.length;f++)_._sounds[f]._paused&&!_._sounds[f]._ended&&(u++,m=_._sounds[f]._id);u===1?r=null:m=null}}var d=m?_._soundById(m):_._inactiveSound();if(!d)return null;if(m&&!r&&(r=d._sprite||"__default"),_._state!=="loaded"){d._sprite=r,d._ended=!1;var b=d._id;return _._queue.push({event:"play",action:function(){_.play(b)}}),b}if(m&&!d._paused)return a||_._loadQueue("play"),d._id;_._webAudio&&e._autoResume();var w=Math.max(0,d._seek>0?d._seek:_._sprite[r][0]/1e3),y=Math.max(0,(_._sprite[r][0]+_._sprite[r][1])/1e3-w),A=y*1e3/Math.abs(d._rate),T=_._sprite[r][0]/1e3,j=(_._sprite[r][0]+_._sprite[r][1])/1e3;d._sprite=r,d._ended=!1;var I=function(){d._paused=!1,d._seek=w,d._start=T,d._stop=j,d._loop=!!(d._loop||_._sprite[r][2])};if(w>=j){_._ended(d);return}var C=d._node;if(_._webAudio){var k=function(){_._playLock=!1,I(),_._refreshBuffer(d);var R=d._muted||_._muted?0:d._volume;C.gain.setValueAtTime(R,e.ctx.currentTime),d._playStart=e.ctx.currentTime,typeof C.bufferSource.start>"u"?d._loop?C.bufferSource.noteGrainOn(0,w,86400):C.bufferSource.noteGrainOn(0,w,y):d._loop?C.bufferSource.start(0,w,86400):C.bufferSource.start(0,w,y),A!==1/0&&(_._endTimers[d._id]=setTimeout(_._ended.bind(_,d),A)),a||setTimeout(function(){_._emit("play",d._id),_._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?k():(_._playLock=!0,_.once("resume",k),_._clearTimer(d._id))}else{var F=function(){C.currentTime=w,C.muted=d._muted||_._muted||e._muted||C.muted,C.volume=d._volume*e.volume(),C.playbackRate=d._rate;try{var R=C.play();if(R&&typeof Promise<"u"&&(R instanceof Promise||typeof R.then=="function")?(_._playLock=!0,I(),R.then(function(){_._playLock=!1,C._unlocked=!0,a?_._loadQueue():_._emit("play",d._id)}).catch(function(){_._playLock=!1,_._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),d._ended=!0,d._paused=!0})):a||(_._playLock=!1,I(),_._emit("play",d._id)),C.playbackRate=d._rate,C.paused){_._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}r!=="__default"||d._loop?_._endTimers[d._id]=setTimeout(_._ended.bind(_,d),A):(_._endTimers[d._id]=function(){_._ended(d),C.removeEventListener("ended",_._endTimers[d._id],!1)},C.addEventListener("ended",_._endTimers[d._id],!1))}catch(O){_._emit("playerror",d._id,O)}};C.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(C.src=_._src,C.load());var L=window&&window.ejecta||!C.readyState&&e._navigator.isCocoonJS;if(C.readyState>=3||L)F();else{_._playLock=!0,_._state="loading";var B=function(){_._state="loaded",F(),C.removeEventListener(e._canPlayEvent,B,!1)};C.addEventListener(e._canPlayEvent,B,!1),_._clearTimer(d._id)}}return d._id},pause:function(r){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(r)}}),a;for(var _=a._getSoundIds(r),m=0;m<_.length;m++){a._clearTimer(_[m]);var u=a._soundById(_[m]);if(u&&!u._paused&&(u._seek=a.seek(_[m]),u._rateSeek=0,u._paused=!0,a._stopFade(_[m]),u._node))if(a._webAudio){if(!u._node.bufferSource)continue;typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),a._cleanBuffer(u._node)}else(!isNaN(u._node.duration)||u._node.duration===1/0)&&u._node.pause();arguments[1]||a._emit("pause",u?u._id:null)}return a},stop:function(r,a){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"stop",action:function(){_.stop(r)}}),_;for(var m=_._getSoundIds(r),u=0;u<m.length;u++){_._clearTimer(m[u]);var f=_._soundById(m[u]);f&&(f._seek=f._start||0,f._rateSeek=0,f._paused=!0,f._ended=!0,_._stopFade(m[u]),f._node&&(_._webAudio?f._node.bufferSource&&(typeof f._node.bufferSource.stop>"u"?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),_._cleanBuffer(f._node)):(!isNaN(f._node.duration)||f._node.duration===1/0)&&(f._node.currentTime=f._start||0,f._node.pause(),f._node.duration===1/0&&_._clearSound(f._node))),a||_._emit("stop",f._id))}return _},mute:function(r,a){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"mute",action:function(){_.mute(r,a)}}),_;if(typeof a>"u")if(typeof r=="boolean")_._muted=r;else return _._muted;for(var m=_._getSoundIds(a),u=0;u<m.length;u++){var f=_._soundById(m[u]);f&&(f._muted=r,f._interval&&_._stopFade(f._id),_._webAudio&&f._node?f._node.gain.setValueAtTime(r?0:f._volume,e.ctx.currentTime):f._node&&(f._node.muted=e._muted?!0:r),_._emit("mute",f._id))}return _},volume:function(){var r=this,a=arguments,_,m;if(a.length===0)return r._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var u=r._getSoundIds(),f=u.indexOf(a[0]);f>=0?m=parseInt(a[0],10):_=parseFloat(a[0])}else a.length>=2&&(_=parseFloat(a[0]),m=parseInt(a[1],10));var d;if(typeof _<"u"&&_>=0&&_<=1){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,a)}}),r;typeof m>"u"&&(r._volume=_),m=r._getSoundIds(m);for(var b=0;b<m.length;b++)d=r._soundById(m[b]),d&&(d._volume=_,a[2]||r._stopFade(m[b]),r._webAudio&&d._node&&!d._muted?d._node.gain.setValueAtTime(_,e.ctx.currentTime):d._node&&!d._muted&&(d._node.volume=_*e.volume()),r._emit("volume",d._id))}else return d=m?r._soundById(m):r._sounds[0],d?d._volume:0;return r},fade:function(r,a,_,m){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"fade",action:function(){u.fade(r,a,_,m)}}),u;r=Math.min(Math.max(0,parseFloat(r)),1),a=Math.min(Math.max(0,parseFloat(a)),1),_=parseFloat(_),u.volume(r,m);for(var f=u._getSoundIds(m),d=0;d<f.length;d++){var b=u._soundById(f[d]);if(b){if(m||u._stopFade(f[d]),u._webAudio&&!b._muted){var w=e.ctx.currentTime,y=w+_/1e3;b._volume=r,b._node.gain.setValueAtTime(r,w),b._node.gain.linearRampToValueAtTime(a,y)}u._startFadeInterval(b,r,a,_,f[d],typeof m>"u")}}return u},_startFadeInterval:function(r,a,_,m,u,f){var d=this,b=a,w=_-a,y=Math.abs(w/.01),A=Math.max(4,y>0?m/y:m),T=Date.now();r._fadeTo=_,r._interval=setInterval(function(){var j=(Date.now()-T)/m;T=Date.now(),b+=w*j,b=Math.round(b*100)/100,w<0?b=Math.max(_,b):b=Math.min(_,b),d._webAudio?r._volume=b:d.volume(b,r._id,!0),f&&(d._volume=b),(_<a&&b<=_||_>a&&b>=_)&&(clearInterval(r._interval),r._interval=null,r._fadeTo=null,d.volume(_,r._id),d._emit("fade",r._id))},A)},_stopFade:function(r){var a=this,_=a._soundById(r);return _&&_._interval&&(a._webAudio&&_._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(_._interval),_._interval=null,a.volume(_._fadeTo,r),_._fadeTo=null,a._emit("fade",r)),a},loop:function(){var r=this,a=arguments,_,m,u;if(a.length===0)return r._loop;if(a.length===1)if(typeof a[0]=="boolean")_=a[0],r._loop=_;else return u=r._soundById(parseInt(a[0],10)),u?u._loop:!1;else a.length===2&&(_=a[0],m=parseInt(a[1],10));for(var f=r._getSoundIds(m),d=0;d<f.length;d++)u=r._soundById(f[d]),u&&(u._loop=_,r._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=_,_&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop,r.playing(f[d])&&(r.pause(f[d],!0),r.play(f[d],!0)))));return r},rate:function(){var r=this,a=arguments,_,m;if(a.length===0)m=r._sounds[0]._id;else if(a.length===1){var u=r._getSoundIds(),f=u.indexOf(a[0]);f>=0?m=parseInt(a[0],10):_=parseFloat(a[0])}else a.length===2&&(_=parseFloat(a[0]),m=parseInt(a[1],10));var d;if(typeof _=="number"){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,a)}}),r;typeof m>"u"&&(r._rate=_),m=r._getSoundIds(m);for(var b=0;b<m.length;b++)if(d=r._soundById(m[b]),d){r.playing(m[b])&&(d._rateSeek=r.seek(m[b]),d._playStart=r._webAudio?e.ctx.currentTime:d._playStart),d._rate=_,r._webAudio&&d._node&&d._node.bufferSource?d._node.bufferSource.playbackRate.setValueAtTime(_,e.ctx.currentTime):d._node&&(d._node.playbackRate=_);var w=r.seek(m[b]),y=(r._sprite[d._sprite][0]+r._sprite[d._sprite][1])/1e3-w,A=y*1e3/Math.abs(d._rate);(r._endTimers[m[b]]||!d._paused)&&(r._clearTimer(m[b]),r._endTimers[m[b]]=setTimeout(r._ended.bind(r,d),A)),r._emit("rate",d._id)}}else return d=r._soundById(m),d?d._rate:r._rate;return r},seek:function(){var r=this,a=arguments,_,m;if(a.length===0)r._sounds.length&&(m=r._sounds[0]._id);else if(a.length===1){var u=r._getSoundIds(),f=u.indexOf(a[0]);f>=0?m=parseInt(a[0],10):r._sounds.length&&(m=r._sounds[0]._id,_=parseFloat(a[0]))}else a.length===2&&(_=parseFloat(a[0]),m=parseInt(a[1],10));if(typeof m>"u")return 0;if(typeof _=="number"&&(r._state!=="loaded"||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,a)}}),r;var d=r._soundById(m);if(d)if(typeof _=="number"&&_>=0){var b=r.playing(m);b&&r.pause(m,!0),d._seek=_,d._ended=!1,r._clearTimer(m),!r._webAudio&&d._node&&!isNaN(d._node.duration)&&(d._node.currentTime=_);var w=function(){b&&r.play(m,!0),r._emit("seek",m)};if(b&&!r._webAudio){var y=function(){r._playLock?setTimeout(y,0):w()};setTimeout(y,0)}else w()}else if(r._webAudio){var A=r.playing(m)?e.ctx.currentTime-d._playStart:0,T=d._rateSeek?d._rateSeek-d._seek:0;return d._seek+(T+A*Math.abs(d._rate))}else return d._node.currentTime;return r},playing:function(r){var a=this;if(typeof r=="number"){var _=a._soundById(r);return _?!_._paused:!1}for(var m=0;m<a._sounds.length;m++)if(!a._sounds[m]._paused)return!0;return!1},duration:function(r){var a=this,_=a._duration,m=a._soundById(r);return m&&(_=a._sprite[m._sprite][1]/1e3),_},state:function(){return this._state},unload:function(){for(var r=this,a=r._sounds,_=0;_<a.length;_++)a[_]._paused||r.stop(a[_]._id),r._webAudio||(r._clearSound(a[_]._node),a[_]._node.removeEventListener("error",a[_]._errorFn,!1),a[_]._node.removeEventListener(e._canPlayEvent,a[_]._loadFn,!1),a[_]._node.removeEventListener("ended",a[_]._endFn,!1),e._releaseHtml5Audio(a[_]._node)),delete a[_]._node,r._clearTimer(a[_]._id);var m=e._howls.indexOf(r);m>=0&&e._howls.splice(m,1);var u=!0;for(_=0;_<e._howls.length;_++)if(e._howls[_]._src===r._src||r._src.indexOf(e._howls[_]._src)>=0){u=!1;break}return s&&u&&delete s[r._src],e.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(r,a,_,m){var u=this,f=u["_on"+r];return typeof a=="function"&&f.push(m?{id:_,fn:a,once:m}:{id:_,fn:a}),u},off:function(r,a,_){var m=this,u=m["_on"+r],f=0;if(typeof a=="number"&&(_=a,a=null),a||_)for(f=0;f<u.length;f++){var d=_===u[f].id;if(a===u[f].fn&&d||!a&&d){u.splice(f,1);break}}else if(r)m["_on"+r]=[];else{var b=Object.keys(m);for(f=0;f<b.length;f++)b[f].indexOf("_on")===0&&Array.isArray(m[b[f]])&&(m[b[f]]=[])}return m},once:function(r,a,_){var m=this;return m.on(r,a,_,1),m},_emit:function(r,a,_){for(var m=this,u=m["_on"+r],f=u.length-1;f>=0;f--)(!u[f].id||u[f].id===a||r==="load")&&(setTimeout(function(d){d.call(this,a,_)}.bind(m,u[f].fn),0),u[f].once&&m.off(r,u[f].fn,u[f].id));return m._loadQueue(r),m},_loadQueue:function(r){var a=this;if(a._queue.length>0){var _=a._queue[0];_.event===r&&(a._queue.shift(),a._loadQueue()),r||_.action()}return a},_ended:function(r){var a=this,_=r._sprite;if(!a._webAudio&&r._node&&!r._node.paused&&!r._node.ended&&r._node.currentTime<r._stop)return setTimeout(a._ended.bind(a,r),100),a;var m=!!(r._loop||a._sprite[_][2]);if(a._emit("end",r._id),!a._webAudio&&m&&a.stop(r._id,!0).play(r._id),a._webAudio&&m){a._emit("play",r._id),r._seek=r._start||0,r._rateSeek=0,r._playStart=e.ctx.currentTime;var u=(r._stop-r._start)*1e3/Math.abs(r._rate);a._endTimers[r._id]=setTimeout(a._ended.bind(a,r),u)}return a._webAudio&&!m&&(r._paused=!0,r._ended=!0,r._seek=r._start||0,r._rateSeek=0,a._clearTimer(r._id),a._cleanBuffer(r._node),e._autoSuspend()),!a._webAudio&&!m&&a.stop(r._id,!0),a},_clearTimer:function(r){var a=this;if(a._endTimers[r]){if(typeof a._endTimers[r]!="function")clearTimeout(a._endTimers[r]);else{var _=a._soundById(r);_&&_._node&&_._node.removeEventListener("ended",a._endTimers[r],!1)}delete a._endTimers[r]}return a},_soundById:function(r){for(var a=this,_=0;_<a._sounds.length;_++)if(r===a._sounds[_]._id)return a._sounds[_];return null},_inactiveSound:function(){var r=this;r._drain();for(var a=0;a<r._sounds.length;a++)if(r._sounds[a]._ended)return r._sounds[a].reset();return new i(r)},_drain:function(){var r=this,a=r._pool,_=0,m=0;if(!(r._sounds.length<a)){for(m=0;m<r._sounds.length;m++)r._sounds[m]._ended&&_++;for(m=r._sounds.length-1;m>=0;m--){if(_<=a)return;r._sounds[m]._ended&&(r._webAudio&&r._sounds[m]._node&&r._sounds[m]._node.disconnect(0),r._sounds.splice(m,1),_--)}}},_getSoundIds:function(r){var a=this;if(typeof r>"u"){for(var _=[],m=0;m<a._sounds.length;m++)_.push(a._sounds[m]._id);return _}else return[r]},_refreshBuffer:function(r){var a=this;return r._node.bufferSource=e.ctx.createBufferSource(),r._node.bufferSource.buffer=s[a._src],r._panner?r._node.bufferSource.connect(r._panner):r._node.bufferSource.connect(r._node),r._node.bufferSource.loop=r._loop,r._loop&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop||0),r._node.bufferSource.playbackRate.setValueAtTime(r._rate,e.ctx.currentTime),a},_cleanBuffer:function(r){var a=this,_=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),_))try{r.bufferSource.buffer=e._scratchBuffer}catch{}return r.bufferSource=null,a},_clearSound:function(r){var a=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);a||(r.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(r){this._parent=r,this.init()};i.prototype={init:function(){var r=this,a=r._parent;return r._muted=a._muted,r._loop=a._loop,r._volume=a._volume,r._rate=a._rate,r._seek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,a._sounds.push(r),r.create(),r},create:function(){var r=this,a=r._parent,_=e._muted||r._muted||r._parent._muted?0:r._volume;return a._webAudio?(r._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),r._node.gain.setValueAtTime(_,e.ctx.currentTime),r._node.paused=!0,r._node.connect(e.masterGain)):e.noAudio||(r._node=e._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(e._canPlayEvent,r._loadFn,!1),r._endFn=r._endListener.bind(r),r._node.addEventListener("ended",r._endFn,!1),r._node.src=a._src,r._node.preload=a._preload===!0?"auto":a._preload,r._node.volume=_*e.volume(),r._node.load()),r},reset:function(){var r=this,a=r._parent;return r._muted=a._muted,r._loop=a._loop,r._volume=a._volume,r._rate=a._rate,r._seek=0,r._rateSeek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,r},_errorListener:function(){var r=this;r._parent._emit("loaderror",r._id,r._node.error?r._node.error.code:0),r._node.removeEventListener("error",r._errorFn,!1)},_loadListener:function(){var r=this,a=r._parent;a._duration=Math.ceil(r._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),r._node.removeEventListener(e._canPlayEvent,r._loadFn,!1)},_endListener:function(){var r=this,a=r._parent;a._duration===1/0&&(a._duration=Math.ceil(r._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(r)),r._node.removeEventListener("ended",r._endFn,!1)}};var s={},o=function(r){var a=r._src;if(s[a]){r._duration=s[a].duration,h(r);return}if(/^data:[^;]+;base64,/.test(a)){for(var _=atob(a.split(",")[1]),m=new Uint8Array(_.length),u=0;u<_.length;++u)m[u]=_.charCodeAt(u);c(m.buffer,r)}else{var f=new XMLHttpRequest;f.open(r._xhr.method,a,!0),f.withCredentials=r._xhr.withCredentials,f.responseType="arraybuffer",r._xhr.headers&&Object.keys(r._xhr.headers).forEach(function(d){f.setRequestHeader(d,r._xhr.headers[d])}),f.onload=function(){var d=(f.status+"")[0];if(d!=="0"&&d!=="2"&&d!=="3"){r._emit("loaderror",null,"Failed loading audio file with status: "+f.status+".");return}c(f.response,r)},f.onerror=function(){r._webAudio&&(r._html5=!0,r._webAudio=!1,r._sounds=[],delete s[a],r.load())},l(f)}},l=function(r){try{r.send()}catch{r.onerror()}},c=function(r,a){var _=function(){a._emit("loaderror",null,"Decoding audio data failed.")},m=function(u){u&&a._sounds.length>0?(s[a._src]=u,h(a,u)):_()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(r).then(m).catch(_):e.ctx.decodeAudioData(r,m,_)},h=function(r,a){a&&!r._duration&&(r._duration=a.duration),Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue())},p=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var r=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),a=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),_=a?parseInt(a[1],10):null;if(r&&_&&_<9){var m=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!m&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:e,Howl:n}}),typeof jt<"u"&&(jt.Howler=e,jt.Howl=n),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=e,global.Howl=n,global.Sound=i):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=i)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var i=n._howls.length-1;i>=0;i--)n._howls[i].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,i){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,i=typeof i!="number"?s._pos[2]:i,typeof e=="number")s._pos=[e,n,i],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,n,i,s,o,l){var c=this;if(!c.ctx||!c.ctx.listener)return c;var h=c._orientation;if(n=typeof n!="number"?h[1]:n,i=typeof i!="number"?h[2]:i,s=typeof s!="number"?h[3]:s,o=typeof o!="number"?h[4]:o,l=typeof l!="number"?h[5]:l,typeof e=="number")c._orientation=[e,n,i,s,o,l],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(l,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,n,i,s,o,l);else return h;return c},Howl.prototype.init=function(e){return function(n){var i=this;return i._orientation=n.orientation||[1,0,0],i._stereo=n.stereo||null,i._pos=n.pos||null,i._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},i._onstereo=n.onstereo?[{fn:n.onstereo}]:[],i._onpos=n.onpos?[{fn:n.onpos}]:[],i._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var o=i._getSoundIds(n),l=0;l<o.length;l++){var c=i._soundById(o[l]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&t(c,s),s==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",c._id);else return c._stereo}return i},Howl.prototype.pos=function(e,n,i,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(e,n,i,s)}}),o;if(n=typeof n!="number"?0:n,i=typeof i!="number"?-.5:i,typeof s>"u")if(typeof e=="number")o._pos=[e,n,i];else return o._pos;for(var l=o._getSoundIds(s),c=0;c<l.length;c++){var h=o._soundById(l[c]);if(h)if(typeof e=="number")h._pos=[e,n,i],h._node&&((!h._panner||h._panner.pan)&&t(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):h._panner.setPosition(e,n,i)),o._emit("pos",h._id);else return h._pos}return o},Howl.prototype.orientation=function(e,n,i,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(e,n,i,s)}}),o;if(n=typeof n!="number"?o._orientation[1]:n,i=typeof i!="number"?o._orientation[2]:i,typeof s>"u")if(typeof e=="number")o._orientation=[e,n,i];else return o._orientation;for(var l=o._getSoundIds(s),c=0;c<l.length;c++){var h=o._soundById(l[c]);if(h)if(typeof e=="number")h._orientation=[e,n,i],h._node&&(h._panner||(h._pos||(h._pos=o._pos||[0,0,-.5]),t(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):h._panner.setOrientation(e,n,i)),o._emit("orientation",h._id);else return h._orientation}return o},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,i,s,o;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")i=n[0],typeof s>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:e._panningModel});else return o=e._soundById(parseInt(n[0],10)),o?o._pannerAttr:e._pannerAttr;else n.length===2&&(i=n[0],s=parseInt(n[1],10));for(var l=e._getSoundIds(s),c=0;c<l.length;c++)if(o=e._soundById(l[c]),o){var h=o._pannerAttr;h={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:h.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:h.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:h.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:h.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:h.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:h.panningModel};var p=o._panner;p?(p.coneInnerAngle=h.coneInnerAngle,p.coneOuterAngle=h.coneOuterAngle,p.coneOuterGain=h.coneOuterGain,p.distanceModel=h.distanceModel,p.maxDistance=h.maxDistance,p.refDistance=h.refDistance,p.rolloffFactor=h.rolloffFactor,p.panningModel=h.panningModel):(o._pos||(o._pos=e._pos||[0,0,-.5]),t(o,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var n=this,i=n._parent;n._orientation=i._orientation,n._stereo=i._stereo,n._pos=i._pos,n._pannerAttr=i._pannerAttr,e.call(this),n._stereo?i.stereo(n._stereo):n._pos&&i.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,i=n._parent;return n._orientation=i._orientation,n._stereo=i._stereo,n._pos=i._pos,n._pannerAttr=i._pannerAttr,n._stereo?i.stereo(n._stereo):n._pos?i.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,i._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()});var g;(function(t){t[t.Bool=2]="Bool",t[t.Int=4]="Int",t[t.Float=8]="Float",t[t.String=16]="String",t[t.Enum=32]="Enum",t[t.Object=64]="Object",t[t.Mesh=128]="Mesh",t[t.Texture=256]="Texture",t[t.Material=512]="Material",t[t.Animation=1024]="Animation",t[t.Skin=2048]="Skin",t[t.Color=4096]="Color"})(g||(g={}));var mt;(function(t){t[t.Sphere=0]="Sphere",t[t.AxisAlignedBox=1]="AxisAlignedBox",t[t.Box=2]="Box"})(mt||(mt={}));var mn;(function(t){t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"})(mn||(mn={}));var dn;(function(t){t[t.Line=1]="Line",t[t.Middle=2]="Middle",t[t.Top=3]="Top",t[t.Bottom=4]="Bottom"})(dn||(dn={}));var un;(function(t){t[t.None=0]="None",t[t.Outline=1]="Outline"})(un||(un={}));var fn;(function(t){t[t.Head=0]="Head",t[t.EyeLeft=1]="EyeLeft",t[t.EyeRight=2]="EyeRight",t[t.ControllerLeft=3]="ControllerLeft",t[t.ControllerRight=4]="ControllerRight",t[t.RayLeft=5]="RayLeft",t[t.RayRight=6]="RayRight"})(fn||(fn={}));var gn;(function(t){t[t.Point=1]="Point",t[t.Spot=2]="Spot",t[t.Sun=3]="Sun"})(gn||(gn={}));var vn;(function(t){t[t.Playing=1]="Playing",t[t.Paused=2]="Paused",t[t.Stopped=3]="Stopped"})(vn||(vn={}));var dt;(function(t){t[t.Force=0]="Force",t[t.Impulse=1]="Impulse",t[t.VelocityChange=2]="VelocityChange",t[t.Acceleration=3]="Acceleration"})(dt||(dt={}));var bn;(function(t){t[t.Touch=0]="Touch",t[t.TouchLost=1]="TouchLost",t[t.TriggerTouch=2]="TriggerTouch",t[t.TriggerTouchLost=3]="TriggerTouchLost"})(bn||(bn={}));var ue;(function(t){t[t.None=0]="None",t[t.Sphere=1]="Sphere",t[t.Capsule=2]="Capsule",t[t.Box=3]="Box",t[t.Plane=4]="Plane",t[t.ConvexMesh=5]="ConvexMesh",t[t.TriangleMesh=6]="TriangleMesh"})(ue||(ue={}));var z;(function(t){t[t.Position=0]="Position",t[t.Tangent=1]="Tangent",t[t.Normal=2]="Normal",t[t.TextureCoordinate=3]="TextureCoordinate",t[t.Color=4]="Color",t[t.JointId=5]="JointId",t[t.JointWeight=6]="JointWeight",t[t.SecondaryJointId=7]="SecondaryJointId",t[t.SecondaryJointWeight=8]="SecondaryJointWeight"})(z||(z={}));var wn;(function(t){t[t.UnsignedInt=0]="UnsignedInt",t[t.Int=1]="Int",t[t.Float=2]="Float",t[t.Sampler=3]="Sampler",t[t.Font=4]="Font"})(wn||(wn={}));var x=class{_manager;_id;_object;_type;_engine;constructor(e,n=-1,i=-1){this._engine=e,this._manager=n,this._id=i,this._object=null,this._type=null}get engine(){return this._engine}get type(){return this._type||this._engine.wasm._typeNameFor(this._manager)}get object(){if(!this._object){let e=this._engine.wasm._wl_component_get_object(this._manager,this._id);this._object=this._engine.wrapObject(e)}return this._object}set active(e){this._engine.wasm._wl_component_setActive(this._manager,this._id,e)}get active(){return this._engine.wasm._wl_component_isActive(this._manager,this._id)!=0}destroy(){this._engine.wasm._wl_component_remove(this._manager,this._id),this._manager=void 0,this._id=void 0}equals(e){return e?this._manager==e._manager&&this._id==e._id:!1}};M(x,"TypeName"),M(x,"Properties");var xn;(function(t){t[t.None=0]="None",t[t.X=1]="X",t[t.Y=2]="Y",t[t.Z=4]="Z"})(xn||(xn={}));var et=class extends x{set static(e){this._engine.wasm._wl_physx_component_set_static(this._id,e)}get static(){return!!this._engine.wasm._wl_physx_component_get_static(this._id)}set kinematic(e){this._engine.wasm._wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!this._engine.wasm._wl_physx_component_get_kinematic(this._id)}set gravity(e){this._engine.wasm._wl_physx_component_set_gravity(this._id,e)}get gravity(){return!!this._engine.wasm._wl_physx_component_get_gravity(this._id)}set simulate(e){this._engine.wasm._wl_physx_component_set_simulate(this._id,e)}get simulate(){return!!this._engine.wasm._wl_physx_component_get_simulate(this._id)}set allowSimulation(e){this._engine.wasm._wl_physx_component_set_allowSimulation(this._id,e)}get allowSimulation(){return!!this._engine.wasm._wl_physx_component_get_allowSimulation(this._id)}set allowQuery(e){this._engine.wasm._wl_physx_component_set_allowQuery(this._id,e)}get allowQuery(){return!!this._engine.wasm._wl_physx_component_get_allowQuery(this._id)}set trigger(e){this._engine.wasm._wl_physx_component_set_trigger(this._id,e)}get trigger(){return!!this._engine.wasm._wl_physx_component_get_trigger(this._id)}set shape(e){this._engine.wasm._wl_physx_component_set_shape(this._id,e)}get shape(){return this._engine.wasm._wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||![ue.TriangleMesh,ue.ConvexMesh].includes(this.shape)||this._engine.wasm._wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return[ue.TriangleMesh,ue.ConvexMesh].includes(this.shape)?{index:this._engine.wasm._wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=this._engine.wasm,n=e._wl_physx_component_get_extents(this._id);return new Float32Array(e.HEAPF32.buffer,n,3)}get staticFriction(){return this._engine.wasm._wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){this._engine.wasm._wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return this._engine.wasm._wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){this._engine.wasm._wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return this._engine.wasm._wl_physx_component_get_bounciness(this._id)}set bounciness(e){this._engine.wasm._wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return this._engine.wasm._wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){this._engine.wasm._wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return this._engine.wasm._wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){this._engine.wasm._wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){this._engine.wasm._wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_linearVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set angularVelocity(e){this._engine.wasm._wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_angularVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set groupsMask(e){this._engine.wasm._wl_physx_component_set_groupsMask(this._id,e)}get groupsMask(){return this._engine.wasm._wl_physx_component_get_groupsMask(this._id)}set blocksMask(e){this._engine.wasm._wl_physx_component_set_blocksMask(this._id,e)}get blocksMask(){return this._engine.wasm._wl_physx_component_get_blocksMask(this._id)}set linearLockAxis(e){this._engine.wasm._wl_physx_component_set_linearLockAxis(this._id,e)}get linearLockAxis(){return this._engine.wasm._wl_physx_component_get_linearLockAxis(this._id)}set angularLockAxis(e){this._engine.wasm._wl_physx_component_set_angularLockAxis(this._id,e)}get angularLockAxis(){return this._engine.wasm._wl_physx_component_get_angularLockAxis(this._id)}set mass(e){this._engine.wasm._wl_physx_component_set_mass(this._id,e)}get mass(){return this._engine.wasm._wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){this._engine.wasm._wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}addForce(e,n,i,s,o){n=n||dt.Force,s?this._engine.wasm._wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],n,!!i,s[0],s[1],s[2],!!o):this._engine.wasm._wl_physx_component_addForce(this._id,e[0],e[1],e[2],n,!!i)}addTorque(e,n=dt.Force){this._engine.wasm._wl_physx_component_addTorque(this._id,e[0],e[1],e[2],n)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,n){let i=this._engine.physics;return i._callbacks[this._id]=i._callbacks[this._id]||[],i._callbacks[this._id].push(n),this._engine.wasm._wl_physx_component_addCallback(this._id,e._id||this._id)}removeCollisionCallback(e){let n=this._engine.physics,i=this._engine.wasm._wl_physx_component_removeCallback(this._id,e);i&&n._callbacks[this._id].splice(-i)}};M(et,"TypeName","physx");for(let t of["static","extents","staticFriction","dynamicFriction","bounciness","linearDamping","angularDamping","shape","shapeData","kinematic","linearVelocity","angularVelocity","mass"])Object.defineProperty(et.prototype,t,{enumerable:!0});var $;(function(t){t[t.UnsignedByte=1]="UnsignedByte",t[t.UnsignedShort=2]="UnsignedShort",t[t.UnsignedInt=4]="UnsignedInt"})($||($={}));var te=class{static get VERTEX_FLOAT_SIZE(){return 3+3+2}static get VERTEX_SIZE(){return this.VERTEX_FLOAT_SIZE*4}static get POS(){return{X:0,Y:1,Z:2}}static get TEXCOORD(){return{U:3,V:4}}static get NORMAL(){return{X:5,Y:6,Z:7}}_index;_engine;constructor(e,n){if(this._engine=e??WL,typeof n=="object"){if(!n.vertexCount&&n.vertexData&&(n.vertexCount=n.vertexData.length/te.VERTEX_FLOAT_SIZE),!n.vertexCount)throw new Error("Missing parameter 'vertexCount'");let i=this._engine.wasm,s=0,o=0,l=0;if(n.indexData)switch(o=n.indexType||$.UnsignedShort,l=n.indexData.length*o,s=i._malloc(l),o){case $.UnsignedByte:i.HEAPU8.set(n.indexData,s);break;case $.UnsignedShort:i.HEAPU16.set(n.indexData,s>>1);break;case $.UnsignedInt:i.HEAPU32.set(n.indexData,s>>2);break}let{skinned:c=!1}=n;if(this._index=i._wl_mesh_create(s,l,o,n.vertexCount,c),n.vertexData){let h=this.attribute(z.Position),p=this.attribute(z.Normal),r=this.attribute(z.TextureCoordinate);for(let a=0;a<n.vertexCount;++a){let _=a*te.VERTEX_FLOAT_SIZE;h.set(a,n.vertexData.subarray(_,_+3)),r?.set(a,n.vertexData.subarray(_+3,_+5)),p?.set(a,n.vertexData.subarray(_+5,_+8))}}}else this._index=n}get vertexData(){let e=this._engine.wasm,n=e._wl_mesh_get_vertexData(this._index,this._engine.wasm._tempMem);return new Float32Array(e.HEAPF32.buffer,n,te.VERTEX_FLOAT_SIZE*e.HEAPU32[this._engine.wasm._tempMem/4])}get vertexCount(){return this._engine.wasm._wl_mesh_get_vertexCount(this._index)}get indexData(){let e=this._engine.wasm,n=e._tempMem,i=e._wl_mesh_get_indexData(this._index,n,n+4);if(i===null)return null;let s=e.HEAPU32[n/4];switch(e.HEAPU32[n/4+1]){case $.UnsignedByte:return new Uint8Array(e.HEAPU8.buffer,i,s);case $.UnsignedShort:return new Uint16Array(e.HEAPU16.buffer,i,s);case $.UnsignedInt:return new Uint32Array(e.HEAPU32.buffer,i,s)}return null}update(){this._engine.wasm._wl_mesh_update(this._index)}getBoundingSphere(e=new Float32Array(4)){let n=this._engine.wasm._tempMemFloat;return this._engine.wasm._wl_mesh_get_boundingSphere(this._index,this._engine.wasm._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}attribute(e){if(typeof e!="number")throw new TypeError("Expected number, but got "+typeof e);let n=this._engine.wasm._tempMemUint32;if(this._engine.wasm._wl_mesh_get_attribute(this._index,e,this._engine.wasm._tempMem),n[0]==255)return null;let i=new Ot(this._engine,e);i._attribute=n[0],i._offset=n[1],i._stride=n[2],i._formatSize=n[3],i._componentCount=n[4];let s=n[5];return i._arraySize=s||1,i.length=this.vertexCount,i}destroy(){this._engine.wasm._wl_mesh_destroy(this._index)}},Ot=class{_attribute=-1;_offset=0;_stride=0;_formatSize=0;_componentCount=0;_arraySize=1;length=0;_engine;_bufferType;_tempBufferGetter;constructor(e,n=z.Position){this._engine=e;let i=this._engine.wasm;switch(n){case z.Position:case z.Normal:case z.TextureCoordinate:case z.Tangent:case z.Color:case z.JointWeight:this._bufferType=Float32Array,this._tempBufferGetter=i.getTempBufferF32.bind(i);break;case z.JointId:this._bufferType=Uint16Array,this._tempBufferGetter=i.getTempBufferU16.bind(i);break;case z.SecondaryJointWeight:case z.SecondaryJointId:console.error(`Deprecated attribute accessor type: ${n}`);default:throw new Error(`Invalid attribute accessor type: ${n}`)}}createArray(e=1){return e=e>this.length?this.length:e,new this._bufferType(e*this._componentCount*this._arraySize)}get(e,n=this.createArray()){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let i=this._tempBufferGetter(n.length),s=this._bufferType.BYTES_PER_ELEMENT,o=s*n.length,l=this._formatSize*this._arraySize,c=this._componentCount*s*this._arraySize;this._engine.wasm._wl_mesh_get_attribute_values(this._attribute,l,this._offset+e*this._stride,this._stride,c,i.byteOffset,o);for(let h=0;h<n.length;++h)n[h]=i[h];return n}set(e,n){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let i=this._bufferType.BYTES_PER_ELEMENT,s=i*n.length,o=this._componentCount*i*this._arraySize,l=this._formatSize*this._arraySize,c=this._engine.wasm;if(n.buffer!=c.HEAPU8.buffer){let h=this._tempBufferGetter(n.length);h.set(n),n=h}return c._wl_mesh_set_attribute_values(this._attribute,o,n.byteOffset,s,l,this._offset+e*this._stride,this._stride),this}};var de=null,fe=class{_engine;_id=0;_imageIndex=void 0;constructor(e,n){this._engine=e??WL;let i=e.wasm;if(n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof HTMLCanvasElement){let s=i._images.length;i._images.push(n),this._imageIndex=s,this._id=this._engine.wasm._wl_renderer_addImage(s)}else this._id=n;this._engine.textures[this._id]=this}get valid(){return this._id>=0}get id(){return this._id}update(){this.valid&&this._engine.wasm._wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return this._engine.wasm._wl_texture_width(this._id)}get height(){return this._engine.wasm._wl_texture_height(this._id)}updateSubImage(e,n,i,s){if(!this.valid)return;de||(de=document.createElement("canvas"));let o=this._engine.wasm,l=o._images[this._imageIndex];if(l){de.width=i,de.height=s,de.getContext("2d")?.drawImage(l,e,n,i,s,0,0,i,s),o._images[this._imageIndex]=de;try{o._wl_renderer_updateImage(this._id,this._imageIndex,e,(l.videoHeight||l.height)-n-s)}finally{o._images[this._imageIndex]=l}}}destroy(){this._engine.wasm._wl_texture_destroy(this._id),this._imageIndex&&(this._engine.wasm._images[this._imageIndex]=null,this._imageIndex=void 0)}};var ko=new Map([[g.Bool,!1],[g.Int,0],[g.Float,0],[g.String,""],[g.Enum,void 0],[g.Object,null],[g.Mesh,null],[g.Texture,null],[g.Material,null],[g.Animation,null],[g.Skin,null],[g.Color,[0,0,0,1]]]);var ge=class extends x{name="wonderland-engine-8thwall-camera";started=!1;view=null;position=[0,0,0];rotation=[0,0,0,-1];glTextureRenderer=null;promptForDeviceMotion(){return new Promise(async(e,n)=>{window.dispatchEvent(new Event("8thwall-request-user-interaction")),window.addEventListener("8thwall-safe-to-request-permissions",async()=>{try{let i=await DeviceMotionEvent.requestPermission();e(i)}catch(i){n(i)}})})}async getPermissions(){if(DeviceMotionEvent&&DeviceMotionEvent.requestPermission)try{if(await DeviceMotionEvent.requestPermission()!=="granted")throw new Error("MotionEvent")}catch(e){if(e.name==="NotAllowedError"){if(await this.promptForDeviceMotion()!=="granted")throw new Error("MotionEvent")}else throw new Error("MotionEvent")}try{(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(n=>{n.stop()})}catch{throw new Error("Camera")}}init(){this.view=this.object.getComponent("view"),this.onUpdate=this.onUpdate.bind(this),this.onAttach=this.onAttach.bind(this),this.onException=this.onException.bind(this),this.onCameraStatusChange=this.onCameraStatusChange.bind(this)}async start(){this.view=this.object.getComponent("view"),this.useCustomUIOverlays||mi.init();try{await this.getPermissions()}catch(n){window.dispatchEvent(new CustomEvent("8thwall-permission-fail",{detail:n}));return}await this.waitForXR8(),XR8.XrController.configure({disableWorldTracking:!1}),this.glTextureRenderer=XR8.GlTextureRenderer.pipelineModule(),XR8.addCameraPipelineModules([this.glTextureRenderer,XR8.XrController.pipelineModule(),this]);let e={cameraConfig:{direction:XR8.XrConfig.camera().BACK},canvas:Module.canvas,allowedDevices:XR8.XrConfig.device().ANY,ownRunLoop:!1};XR8.run(e)}onAttach(e){this.started=!0,this.engine.scene.colorClearEnabled=!1;let n=Module.ctx,i=this.object.rotationWorld,s=this.object.getTranslationWorld([]);this.position=Array.from(s),this.rotation=Array.from(i),XR8.XrController.updateCameraProjectionMatrix({origin:{x:s[0],y:s[1],z:s[2]},facing:{x:i[0],y:i[1],z:i[2],w:i[3]},cam:{pixelRectWidth:Module.canvas.width,pixelRectHeight:Module.canvas.height,nearClipPlane:this.view.near,farClipPlane:this.view.far}}),this.engine.scene.onPreRender.push(()=>{n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),XR8.runPreRender(Date.now()),XR8.runRender()}),this.engine.scene.onPostRender.push(()=>{XR8.runPostRender(Date.now())})}onCameraStatusChange(e){e&&e.status==="failed"&&this.onException(new Error(`Camera failed with status: ${e.status}`))}onUpdate(e){if(!e.processCpuResult.reality)return;let{rotation:n,position:i,intrinsics:s}=e.processCpuResult.reality;if(this.rotation[0]=n.x,this.rotation[1]=n.y,this.rotation[2]=n.z,this.rotation[3]=n.w,this.position[0]=i.x,this.position[1]=i.y,this.position[2]=i.z,s){let o=this.view.projectionMatrix;for(let l=0;l<16;l++)Number.isFinite(s[l])&&(o[l]=s[l])}i&&n&&(this.object.rotationWorld=this.rotation,this.object.setTranslationWorld(this.position))}onException(e){console.error("8thwall exception:",e),window.dispatchEvent(new CustomEvent("8thwall-error",{detail:e}))}waitForXR8(){return new Promise((e,n)=>{window.XR8?e():window.addEventListener("xrloaded",()=>e())})}};M(ge,"TypeName","8thwall-camera"),M(ge,"Properties",{useCustomUIOverlays:{type:g.Bool,default:!1}});var mi={init:function(){this.handleRequestUserInteraction=this.handleRequestUserInteraction.bind(this),this.handlePermissionFail=this.handlePermissionFail.bind(this),this.handleError=this.handleError.bind(this),window.addEventListener("8thwall-request-user-interaction",this.handleRequestUserInteraction),window.addEventListener("8thwall-permission-fail",this.handlePermissionFail),window.addEventListener("8thwall-error",this.handleError)},handleRequestUserInteraction:function(){let t=this.showOverlay(di);window.addEventListener("8thwall-safe-to-request-permissions",()=>{t.remove()})},handlePermissionFail:function(t){this.showOverlay(ui)},handleError:function(t){this.showOverlay(fi)},showOverlay:function(t){let e=document.createElement("div");return e.innerHTML=t,document.body.appendChild(e),e}},di=`
<style>
  #request-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .request-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .request-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="request-permission-overlay">
  <div class="request-permission-overlay_title">This app requires to use your camera and motion sensors</div>

  <button class="request-permission-overlay_button" onclick="window.dispatchEvent(new Event('8thwall-safe-to-request-permissions'))">OK</button>
</div>`,ui=`
<style>
  #failed-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .failed-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .failed-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="failed-permission-overlay">
  <div class="failed-permission-overlay_title">Failed to grant permissions. Reset the the permissions and refresh the page.</div>

  <button class="failed-permission-overlay_button" onclick="window.location.reload()">Refresh the page</button>
</div>`,fi=`
<style>
  #wall-error-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .wall-error-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .wall-error-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="wall-error-overlay">
  <div class="wall-error-overlay_title">Error has occurred. Please reload the page</div>

  <button class="wall-error-overlay_button" onclick="window.location.reload()">Reload</button>
</div>`;var ve=class extends x{init(){this.hoverFunctions=[],this.unHoverFunctions=[],this.clickFunctions=[],this.moveFunctions=[],this.downFunctions=[],this.upFunctions=[]}onHover(e,n){for(let i of this.hoverFunctions)i(e,n)}onUnhover(e,n){for(let i of this.unHoverFunctions)i(e,n)}onClick(e,n){for(let i of this.clickFunctions)i(e,n)}onMove(e,n){for(let i of this.moveFunctions)i(e,n)}onDown(e,n){for(let i of this.downFunctions)i(e,n)}onUp(e,n){for(let i of this.upFunctions)i(e,n)}addHoverFunction(e){this._validateCallback(e),this.hoverFunctions.push(e)}removeHoverFunction(e){this._validateCallback(e),this._removeItemOnce(this.hoverFunctions,e)}addUnHoverFunction(e){this._validateCallback(e),this.unHoverFunctions.push(e)}removeUnHoverFunction(e){this._validateCallback(e),this._removeItemOnce(this.unHoverFunctions,e)}addClickFunction(e){this._validateCallback(e),this.clickFunctions.push(e)}removeClickFunction(e){this._validateCallback(e),this._removeItemOnce(this.clickFunctions,e)}addMoveFunction(e){this._validateCallback(e),this.moveFunctions.push(e)}removeMoveFunction(e){this._validateCallback(e),this._removeItemOnce(this.moveFunctions,e)}addDownFunction(e){this._validateCallback(e),this.downFunctions.push(e)}removeDownFunction(e){this._validateCallback(e),this._removeItemOnce(this.downFunctions,e)}addUpFunction(e){this._validateCallback(e),this.upFunctions.push(e)}removeUpFunction(e){this._validateCallback(e),this._removeItemOnce(this.upFunctions,e)}_removeItemOnce(e,n){var i=e.indexOf(n);return i>-1&&e.splice(i,1),e}_validateCallback(e){if(typeof e!="function")throw new TypeError(this.object.name+".cursor-target: Argument needs to be a function")}};M(ve,"TypeName","cursor-target"),M(ve,"Properties",{});var P=1e-6,E=typeof Float32Array<"u"?Float32Array:Array,X=Math.random;var ra=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function yn(){var t=new E(9);return E!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var re={};Je(re,{add:()=>Ji,adjoint:()=>Ai,clone:()=>bi,copy:()=>wi,create:()=>vi,determinant:()=>ji,equals:()=>ir,exactEquals:()=>nr,frob:()=>Ki,fromQuat:()=>Vi,fromQuat2:()=>Ni,fromRotation:()=>Fi,fromRotationTranslation:()=>An,fromRotationTranslationScale:()=>zi,fromRotationTranslationScaleOrigin:()=>Ui,fromScaling:()=>ki,fromTranslation:()=>Ri,fromValues:()=>xi,fromXRotation:()=>Bi,fromYRotation:()=>Li,fromZRotation:()=>Di,frustum:()=>Hi,getRotation:()=>Et,getScaling:()=>jn,getTranslation:()=>It,identity:()=>Mn,invert:()=>Ti,lookAt:()=>Qi,mul:()=>rr,multiply:()=>Tn,multiplyScalar:()=>er,multiplyScalarAndAdd:()=>tr,ortho:()=>Yi,orthoNO:()=>Cn,orthoZO:()=>Gi,perspective:()=>Wi,perspectiveFromFieldOfView:()=>qi,perspectiveNO:()=>Sn,perspectiveZO:()=>Xi,rotate:()=>Pi,rotateX:()=>Oi,rotateY:()=>Ii,rotateZ:()=>Ei,scale:()=>Ci,set:()=>yi,str:()=>Zi,sub:()=>sr,subtract:()=>Pn,targetTo:()=>$i,translate:()=>Si,transpose:()=>Mi});function vi(){var t=new E(16);return E!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function bi(t){var e=new E(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function wi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function xi(t,e,n,i,s,o,l,c,h,p,r,a,_,m,u,f){var d=new E(16);return d[0]=t,d[1]=e,d[2]=n,d[3]=i,d[4]=s,d[5]=o,d[6]=l,d[7]=c,d[8]=h,d[9]=p,d[10]=r,d[11]=a,d[12]=_,d[13]=m,d[14]=u,d[15]=f,d}function yi(t,e,n,i,s,o,l,c,h,p,r,a,_,m,u,f,d){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t[4]=o,t[5]=l,t[6]=c,t[7]=h,t[8]=p,t[9]=r,t[10]=a,t[11]=_,t[12]=m,t[13]=u,t[14]=f,t[15]=d,t}function Mn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Mi(t,e){if(t===e){var n=e[1],i=e[2],s=e[3],o=e[6],l=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=s,t[13]=l,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Ti(t,e){var n=e[0],i=e[1],s=e[2],o=e[3],l=e[4],c=e[5],h=e[6],p=e[7],r=e[8],a=e[9],_=e[10],m=e[11],u=e[12],f=e[13],d=e[14],b=e[15],w=n*c-i*l,y=n*h-s*l,A=n*p-o*l,T=i*h-s*c,j=i*p-o*c,I=s*p-o*h,C=r*f-a*u,k=r*d-_*u,F=r*b-m*u,L=a*d-_*f,B=a*b-m*f,R=_*b-m*d,O=w*R-y*B+A*L+T*F-j*k+I*C;return O?(O=1/O,t[0]=(c*R-h*B+p*L)*O,t[1]=(s*B-i*R-o*L)*O,t[2]=(f*I-d*j+b*T)*O,t[3]=(_*j-a*I-m*T)*O,t[4]=(h*F-l*R-p*k)*O,t[5]=(n*R-s*F+o*k)*O,t[6]=(d*A-u*I-b*y)*O,t[7]=(r*I-_*A+m*y)*O,t[8]=(l*B-c*F+p*C)*O,t[9]=(i*F-n*B-o*C)*O,t[10]=(u*j-f*A+b*w)*O,t[11]=(a*A-r*j-m*w)*O,t[12]=(c*k-l*L-h*C)*O,t[13]=(n*L-i*k+s*C)*O,t[14]=(f*y-u*T-d*w)*O,t[15]=(r*T-a*y+_*w)*O,t):null}function Ai(t,e){var n=e[0],i=e[1],s=e[2],o=e[3],l=e[4],c=e[5],h=e[6],p=e[7],r=e[8],a=e[9],_=e[10],m=e[11],u=e[12],f=e[13],d=e[14],b=e[15];return t[0]=c*(_*b-m*d)-a*(h*b-p*d)+f*(h*m-p*_),t[1]=-(i*(_*b-m*d)-a*(s*b-o*d)+f*(s*m-o*_)),t[2]=i*(h*b-p*d)-c*(s*b-o*d)+f*(s*p-o*h),t[3]=-(i*(h*m-p*_)-c*(s*m-o*_)+a*(s*p-o*h)),t[4]=-(l*(_*b-m*d)-r*(h*b-p*d)+u*(h*m-p*_)),t[5]=n*(_*b-m*d)-r*(s*b-o*d)+u*(s*m-o*_),t[6]=-(n*(h*b-p*d)-l*(s*b-o*d)+u*(s*p-o*h)),t[7]=n*(h*m-p*_)-l*(s*m-o*_)+r*(s*p-o*h),t[8]=l*(a*b-m*f)-r*(c*b-p*f)+u*(c*m-p*a),t[9]=-(n*(a*b-m*f)-r*(i*b-o*f)+u*(i*m-o*a)),t[10]=n*(c*b-p*f)-l*(i*b-o*f)+u*(i*p-o*c),t[11]=-(n*(c*m-p*a)-l*(i*m-o*a)+r*(i*p-o*c)),t[12]=-(l*(a*d-_*f)-r*(c*d-h*f)+u*(c*_-h*a)),t[13]=n*(a*d-_*f)-r*(i*d-s*f)+u*(i*_-s*a),t[14]=-(n*(c*d-h*f)-l*(i*d-s*f)+u*(i*h-s*c)),t[15]=n*(c*_-h*a)-l*(i*_-s*a)+r*(i*h-s*c),t}function ji(t){var e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],l=t[5],c=t[6],h=t[7],p=t[8],r=t[9],a=t[10],_=t[11],m=t[12],u=t[13],f=t[14],d=t[15],b=e*l-n*o,w=e*c-i*o,y=e*h-s*o,A=n*c-i*l,T=n*h-s*l,j=i*h-s*c,I=p*u-r*m,C=p*f-a*m,k=p*d-_*m,F=r*f-a*u,L=r*d-_*u,B=a*d-_*f;return b*B-w*L+y*F+A*k-T*C+j*I}function Tn(t,e,n){var i=e[0],s=e[1],o=e[2],l=e[3],c=e[4],h=e[5],p=e[6],r=e[7],a=e[8],_=e[9],m=e[10],u=e[11],f=e[12],d=e[13],b=e[14],w=e[15],y=n[0],A=n[1],T=n[2],j=n[3];return t[0]=y*i+A*c+T*a+j*f,t[1]=y*s+A*h+T*_+j*d,t[2]=y*o+A*p+T*m+j*b,t[3]=y*l+A*r+T*u+j*w,y=n[4],A=n[5],T=n[6],j=n[7],t[4]=y*i+A*c+T*a+j*f,t[5]=y*s+A*h+T*_+j*d,t[6]=y*o+A*p+T*m+j*b,t[7]=y*l+A*r+T*u+j*w,y=n[8],A=n[9],T=n[10],j=n[11],t[8]=y*i+A*c+T*a+j*f,t[9]=y*s+A*h+T*_+j*d,t[10]=y*o+A*p+T*m+j*b,t[11]=y*l+A*r+T*u+j*w,y=n[12],A=n[13],T=n[14],j=n[15],t[12]=y*i+A*c+T*a+j*f,t[13]=y*s+A*h+T*_+j*d,t[14]=y*o+A*p+T*m+j*b,t[15]=y*l+A*r+T*u+j*w,t}function Si(t,e,n){var i=n[0],s=n[1],o=n[2],l,c,h,p,r,a,_,m,u,f,d,b;return e===t?(t[12]=e[0]*i+e[4]*s+e[8]*o+e[12],t[13]=e[1]*i+e[5]*s+e[9]*o+e[13],t[14]=e[2]*i+e[6]*s+e[10]*o+e[14],t[15]=e[3]*i+e[7]*s+e[11]*o+e[15]):(l=e[0],c=e[1],h=e[2],p=e[3],r=e[4],a=e[5],_=e[6],m=e[7],u=e[8],f=e[9],d=e[10],b=e[11],t[0]=l,t[1]=c,t[2]=h,t[3]=p,t[4]=r,t[5]=a,t[6]=_,t[7]=m,t[8]=u,t[9]=f,t[10]=d,t[11]=b,t[12]=l*i+r*s+u*o+e[12],t[13]=c*i+a*s+f*o+e[13],t[14]=h*i+_*s+d*o+e[14],t[15]=p*i+m*s+b*o+e[15]),t}function Ci(t,e,n){var i=n[0],s=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Pi(t,e,n,i){var s=i[0],o=i[1],l=i[2],c=Math.hypot(s,o,l),h,p,r,a,_,m,u,f,d,b,w,y,A,T,j,I,C,k,F,L,B,R,O,Q;return c<P?null:(c=1/c,s*=c,o*=c,l*=c,h=Math.sin(n),p=Math.cos(n),r=1-p,a=e[0],_=e[1],m=e[2],u=e[3],f=e[4],d=e[5],b=e[6],w=e[7],y=e[8],A=e[9],T=e[10],j=e[11],I=s*s*r+p,C=o*s*r+l*h,k=l*s*r-o*h,F=s*o*r-l*h,L=o*o*r+p,B=l*o*r+s*h,R=s*l*r+o*h,O=o*l*r-s*h,Q=l*l*r+p,t[0]=a*I+f*C+y*k,t[1]=_*I+d*C+A*k,t[2]=m*I+b*C+T*k,t[3]=u*I+w*C+j*k,t[4]=a*F+f*L+y*B,t[5]=_*F+d*L+A*B,t[6]=m*F+b*L+T*B,t[7]=u*F+w*L+j*B,t[8]=a*R+f*O+y*Q,t[9]=_*R+d*O+A*Q,t[10]=m*R+b*O+T*Q,t[11]=u*R+w*O+j*Q,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Oi(t,e,n){var i=Math.sin(n),s=Math.cos(n),o=e[4],l=e[5],c=e[6],h=e[7],p=e[8],r=e[9],a=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*s+p*i,t[5]=l*s+r*i,t[6]=c*s+a*i,t[7]=h*s+_*i,t[8]=p*s-o*i,t[9]=r*s-l*i,t[10]=a*s-c*i,t[11]=_*s-h*i,t}function Ii(t,e,n){var i=Math.sin(n),s=Math.cos(n),o=e[0],l=e[1],c=e[2],h=e[3],p=e[8],r=e[9],a=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*s-p*i,t[1]=l*s-r*i,t[2]=c*s-a*i,t[3]=h*s-_*i,t[8]=o*i+p*s,t[9]=l*i+r*s,t[10]=c*i+a*s,t[11]=h*i+_*s,t}function Ei(t,e,n){var i=Math.sin(n),s=Math.cos(n),o=e[0],l=e[1],c=e[2],h=e[3],p=e[4],r=e[5],a=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*s+p*i,t[1]=l*s+r*i,t[2]=c*s+a*i,t[3]=h*s+_*i,t[4]=p*s-o*i,t[5]=r*s-l*i,t[6]=a*s-c*i,t[7]=_*s-h*i,t}function Ri(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function ki(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Fi(t,e,n){var i=n[0],s=n[1],o=n[2],l=Math.hypot(i,s,o),c,h,p;return l<P?null:(l=1/l,i*=l,s*=l,o*=l,c=Math.sin(e),h=Math.cos(e),p=1-h,t[0]=i*i*p+h,t[1]=s*i*p+o*c,t[2]=o*i*p-s*c,t[3]=0,t[4]=i*s*p-o*c,t[5]=s*s*p+h,t[6]=o*s*p+i*c,t[7]=0,t[8]=i*o*p+s*c,t[9]=s*o*p-i*c,t[10]=o*o*p+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Bi(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Li(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Di(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function An(t,e,n){var i=e[0],s=e[1],o=e[2],l=e[3],c=i+i,h=s+s,p=o+o,r=i*c,a=i*h,_=i*p,m=s*h,u=s*p,f=o*p,d=l*c,b=l*h,w=l*p;return t[0]=1-(m+f),t[1]=a+w,t[2]=_-b,t[3]=0,t[4]=a-w,t[5]=1-(r+f),t[6]=u+d,t[7]=0,t[8]=_+b,t[9]=u-d,t[10]=1-(r+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ni(t,e){var n=new E(3),i=-e[0],s=-e[1],o=-e[2],l=e[3],c=e[4],h=e[5],p=e[6],r=e[7],a=i*i+s*s+o*o+l*l;return a>0?(n[0]=(c*l+r*i+h*o-p*s)*2/a,n[1]=(h*l+r*s+p*i-c*o)*2/a,n[2]=(p*l+r*o+c*s-h*i)*2/a):(n[0]=(c*l+r*i+h*o-p*s)*2,n[1]=(h*l+r*s+p*i-c*o)*2,n[2]=(p*l+r*o+c*s-h*i)*2),An(t,e,n),t}function It(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function jn(t,e){var n=e[0],i=e[1],s=e[2],o=e[4],l=e[5],c=e[6],h=e[8],p=e[9],r=e[10];return t[0]=Math.hypot(n,i,s),t[1]=Math.hypot(o,l,c),t[2]=Math.hypot(h,p,r),t}function Et(t,e){var n=new E(3);jn(n,e);var i=1/n[0],s=1/n[1],o=1/n[2],l=e[0]*i,c=e[1]*s,h=e[2]*o,p=e[4]*i,r=e[5]*s,a=e[6]*o,_=e[8]*i,m=e[9]*s,u=e[10]*o,f=l+r+u,d=0;return f>0?(d=Math.sqrt(f+1)*2,t[3]=.25*d,t[0]=(a-m)/d,t[1]=(_-h)/d,t[2]=(c-p)/d):l>r&&l>u?(d=Math.sqrt(1+l-r-u)*2,t[3]=(a-m)/d,t[0]=.25*d,t[1]=(c+p)/d,t[2]=(_+h)/d):r>u?(d=Math.sqrt(1+r-l-u)*2,t[3]=(_-h)/d,t[0]=(c+p)/d,t[1]=.25*d,t[2]=(a+m)/d):(d=Math.sqrt(1+u-l-r)*2,t[3]=(c-p)/d,t[0]=(_+h)/d,t[1]=(a+m)/d,t[2]=.25*d),t}function zi(t,e,n,i){var s=e[0],o=e[1],l=e[2],c=e[3],h=s+s,p=o+o,r=l+l,a=s*h,_=s*p,m=s*r,u=o*p,f=o*r,d=l*r,b=c*h,w=c*p,y=c*r,A=i[0],T=i[1],j=i[2];return t[0]=(1-(u+d))*A,t[1]=(_+y)*A,t[2]=(m-w)*A,t[3]=0,t[4]=(_-y)*T,t[5]=(1-(a+d))*T,t[6]=(f+b)*T,t[7]=0,t[8]=(m+w)*j,t[9]=(f-b)*j,t[10]=(1-(a+u))*j,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ui(t,e,n,i,s){var o=e[0],l=e[1],c=e[2],h=e[3],p=o+o,r=l+l,a=c+c,_=o*p,m=o*r,u=o*a,f=l*r,d=l*a,b=c*a,w=h*p,y=h*r,A=h*a,T=i[0],j=i[1],I=i[2],C=s[0],k=s[1],F=s[2],L=(1-(f+b))*T,B=(m+A)*T,R=(u-y)*T,O=(m-A)*j,Q=(1-(_+b))*j,Ze=(d+w)*j,Ke=(u+y)*I,cn=(d-w)*I,_n=(1-(_+f))*I;return t[0]=L,t[1]=B,t[2]=R,t[3]=0,t[4]=O,t[5]=Q,t[6]=Ze,t[7]=0,t[8]=Ke,t[9]=cn,t[10]=_n,t[11]=0,t[12]=n[0]+C-(L*C+O*k+Ke*F),t[13]=n[1]+k-(B*C+Q*k+cn*F),t[14]=n[2]+F-(R*C+Ze*k+_n*F),t[15]=1,t}function Vi(t,e){var n=e[0],i=e[1],s=e[2],o=e[3],l=n+n,c=i+i,h=s+s,p=n*l,r=i*l,a=i*c,_=s*l,m=s*c,u=s*h,f=o*l,d=o*c,b=o*h;return t[0]=1-a-u,t[1]=r+b,t[2]=_-d,t[3]=0,t[4]=r-b,t[5]=1-p-u,t[6]=m+f,t[7]=0,t[8]=_+d,t[9]=m-f,t[10]=1-p-a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hi(t,e,n,i,s,o,l){var c=1/(n-e),h=1/(s-i),p=1/(o-l);return t[0]=o*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*h,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+i)*h,t[10]=(l+o)*p,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*o*2*p,t[15]=0,t}function Sn(t,e,n,i,s){var o=1/Math.tan(e/2),l;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(i-s),t[10]=(s+i)*l,t[14]=2*s*i*l):(t[10]=-1,t[14]=-2*i),t}var Wi=Sn;function Xi(t,e,n,i,s){var o=1/Math.tan(e/2),l;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(i-s),t[10]=s*l,t[14]=s*i*l):(t[10]=-1,t[14]=-i),t}function qi(t,e,n,i){var s=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),l=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),h=2/(l+c),p=2/(s+o);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=-((l-c)*h*.5),t[9]=(s-o)*p*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}function Cn(t,e,n,i,s,o,l){var c=1/(e-n),h=1/(i-s),p=1/(o-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*p,t[11]=0,t[12]=(e+n)*c,t[13]=(s+i)*h,t[14]=(l+o)*p,t[15]=1,t}var Yi=Cn;function Gi(t,e,n,i,s,o,l){var c=1/(e-n),h=1/(i-s),p=1/(o-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=p,t[11]=0,t[12]=(e+n)*c,t[13]=(s+i)*h,t[14]=o*p,t[15]=1,t}function Qi(t,e,n,i){var s,o,l,c,h,p,r,a,_,m,u=e[0],f=e[1],d=e[2],b=i[0],w=i[1],y=i[2],A=n[0],T=n[1],j=n[2];return Math.abs(u-A)<P&&Math.abs(f-T)<P&&Math.abs(d-j)<P?Mn(t):(r=u-A,a=f-T,_=d-j,m=1/Math.hypot(r,a,_),r*=m,a*=m,_*=m,s=w*_-y*a,o=y*r-b*_,l=b*a-w*r,m=Math.hypot(s,o,l),m?(m=1/m,s*=m,o*=m,l*=m):(s=0,o=0,l=0),c=a*l-_*o,h=_*s-r*l,p=r*o-a*s,m=Math.hypot(c,h,p),m?(m=1/m,c*=m,h*=m,p*=m):(c=0,h=0,p=0),t[0]=s,t[1]=c,t[2]=r,t[3]=0,t[4]=o,t[5]=h,t[6]=a,t[7]=0,t[8]=l,t[9]=p,t[10]=_,t[11]=0,t[12]=-(s*u+o*f+l*d),t[13]=-(c*u+h*f+p*d),t[14]=-(r*u+a*f+_*d),t[15]=1,t)}function $i(t,e,n,i){var s=e[0],o=e[1],l=e[2],c=i[0],h=i[1],p=i[2],r=s-n[0],a=o-n[1],_=l-n[2],m=r*r+a*a+_*_;m>0&&(m=1/Math.sqrt(m),r*=m,a*=m,_*=m);var u=h*_-p*a,f=p*r-c*_,d=c*a-h*r;return m=u*u+f*f+d*d,m>0&&(m=1/Math.sqrt(m),u*=m,f*=m,d*=m),t[0]=u,t[1]=f,t[2]=d,t[3]=0,t[4]=a*d-_*f,t[5]=_*u-r*d,t[6]=r*f-a*u,t[7]=0,t[8]=r,t[9]=a,t[10]=_,t[11]=0,t[12]=s,t[13]=o,t[14]=l,t[15]=1,t}function Zi(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ki(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ji(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Pn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function er(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function tr(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t}function nr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ir(t,e){var n=t[0],i=t[1],s=t[2],o=t[3],l=t[4],c=t[5],h=t[6],p=t[7],r=t[8],a=t[9],_=t[10],m=t[11],u=t[12],f=t[13],d=t[14],b=t[15],w=e[0],y=e[1],A=e[2],T=e[3],j=e[4],I=e[5],C=e[6],k=e[7],F=e[8],L=e[9],B=e[10],R=e[11],O=e[12],Q=e[13],Ze=e[14],Ke=e[15];return Math.abs(n-w)<=P*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-y)<=P*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(s-A)<=P*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(o-T)<=P*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(l-j)<=P*Math.max(1,Math.abs(l),Math.abs(j))&&Math.abs(c-I)<=P*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-C)<=P*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(p-k)<=P*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(r-F)<=P*Math.max(1,Math.abs(r),Math.abs(F))&&Math.abs(a-L)<=P*Math.max(1,Math.abs(a),Math.abs(L))&&Math.abs(_-B)<=P*Math.max(1,Math.abs(_),Math.abs(B))&&Math.abs(m-R)<=P*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(u-O)<=P*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(f-Q)<=P*Math.max(1,Math.abs(f),Math.abs(Q))&&Math.abs(d-Ze)<=P*Math.max(1,Math.abs(d),Math.abs(Ze))&&Math.abs(b-Ke)<=P*Math.max(1,Math.abs(b),Math.abs(Ke))}var rr=Tn,sr=Pn;var S={};Je(S,{add:()=>ys,calculateW:()=>ps,clone:()=>bs,conjugate:()=>fs,copy:()=>xt,create:()=>nt,dot:()=>yt,equals:()=>Cs,exactEquals:()=>Ss,exp:()=>Xn,fromEuler:()=>gs,fromMat3:()=>Yn,fromValues:()=>ws,getAngle:()=>hs,getAxisAngle:()=>_s,identity:()=>cs,invert:()=>us,len:()=>As,length:()=>Mt,lerp:()=>Ts,ln:()=>qn,mul:()=>Ms,multiply:()=>Wn,normalize:()=>Qt,pow:()=>ms,random:()=>ds,rotateX:()=>qt,rotateY:()=>Yt,rotateZ:()=>Gt,rotationTo:()=>Ps,scale:()=>Gn,set:()=>xs,setAxes:()=>Is,setAxisAngle:()=>Hn,slerp:()=>wt,sqlerp:()=>Os,sqrLen:()=>js,squaredLength:()=>Tt,str:()=>vs});var v={};Je(v,{add:()=>cr,angle:()=>Pr,bezier:()=>xr,ceil:()=>_r,clone:()=>or,copy:()=>ar,create:()=>ut,cross:()=>tt,dist:()=>Lr,distance:()=>kn,div:()=>Br,divide:()=>Rn,dot:()=>gt,equals:()=>Rr,exactEquals:()=>Er,floor:()=>hr,forEach:()=>zr,fromValues:()=>ft,hermite:()=>wr,inverse:()=>vr,len:()=>kt,length:()=>On,lerp:()=>br,max:()=>mr,min:()=>pr,mul:()=>Fr,multiply:()=>En,negate:()=>gr,normalize:()=>Rt,random:()=>yr,rotateX:()=>jr,rotateY:()=>Sr,rotateZ:()=>Cr,round:()=>dr,scale:()=>ur,scaleAndAdd:()=>fr,set:()=>lr,sqrDist:()=>Dr,sqrLen:()=>Nr,squaredDistance:()=>Fn,squaredLength:()=>Bn,str:()=>Ir,sub:()=>kr,subtract:()=>In,transformMat3:()=>Tr,transformMat4:()=>Mr,transformQuat:()=>Ar,zero:()=>Or});function ut(){var t=new E(3);return E!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function or(t){var e=new E(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function On(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function ft(t,e,n){var i=new E(3);return i[0]=t,i[1]=e,i[2]=n,i}function ar(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function lr(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function cr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function In(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function En(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Rn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function _r(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function hr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function pr(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function mr(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function dr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function ur(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function fr(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function kn(t,e){var n=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return Math.hypot(n,i,s)}function Fn(t,e){var n=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return n*n+i*i+s*s}function Bn(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function gr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function vr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Rt(t,e){var n=e[0],i=e[1],s=e[2],o=n*n+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function gt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function tt(t,e,n){var i=e[0],s=e[1],o=e[2],l=n[0],c=n[1],h=n[2];return t[0]=s*h-o*c,t[1]=o*l-i*h,t[2]=i*c-s*l,t}function br(t,e,n,i){var s=e[0],o=e[1],l=e[2];return t[0]=s+i*(n[0]-s),t[1]=o+i*(n[1]-o),t[2]=l+i*(n[2]-l),t}function wr(t,e,n,i,s,o){var l=o*o,c=l*(2*o-3)+1,h=l*(o-2)+o,p=l*(o-1),r=l*(3-2*o);return t[0]=e[0]*c+n[0]*h+i[0]*p+s[0]*r,t[1]=e[1]*c+n[1]*h+i[1]*p+s[1]*r,t[2]=e[2]*c+n[2]*h+i[2]*p+s[2]*r,t}function xr(t,e,n,i,s,o){var l=1-o,c=l*l,h=o*o,p=c*l,r=3*o*c,a=3*h*l,_=h*o;return t[0]=e[0]*p+n[0]*r+i[0]*a+s[0]*_,t[1]=e[1]*p+n[1]*r+i[1]*a+s[1]*_,t[2]=e[2]*p+n[2]*r+i[2]*a+s[2]*_,t}function yr(t,e){e=e||1;var n=X()*2*Math.PI,i=X()*2-1,s=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=i*e,t}function Mr(t,e,n){var i=e[0],s=e[1],o=e[2],l=n[3]*i+n[7]*s+n[11]*o+n[15];return l=l||1,t[0]=(n[0]*i+n[4]*s+n[8]*o+n[12])/l,t[1]=(n[1]*i+n[5]*s+n[9]*o+n[13])/l,t[2]=(n[2]*i+n[6]*s+n[10]*o+n[14])/l,t}function Tr(t,e,n){var i=e[0],s=e[1],o=e[2];return t[0]=i*n[0]+s*n[3]+o*n[6],t[1]=i*n[1]+s*n[4]+o*n[7],t[2]=i*n[2]+s*n[5]+o*n[8],t}function Ar(t,e,n){var i=n[0],s=n[1],o=n[2],l=n[3],c=e[0],h=e[1],p=e[2],r=s*p-o*h,a=o*c-i*p,_=i*h-s*c,m=s*_-o*a,u=o*r-i*_,f=i*a-s*r,d=l*2;return r*=d,a*=d,_*=d,m*=2,u*=2,f*=2,t[0]=c+r+m,t[1]=h+a+u,t[2]=p+_+f,t}function jr(t,e,n,i){var s=[],o=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],o[0]=s[0],o[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),o[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Sr(t,e,n,i){var s=[],o=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],o[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),o[1]=s[1],o[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Cr(t,e,n,i){var s=[],o=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],o[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),o[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),o[2]=s[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Pr(t,e){var n=t[0],i=t[1],s=t[2],o=e[0],l=e[1],c=e[2],h=Math.sqrt(n*n+i*i+s*s),p=Math.sqrt(o*o+l*l+c*c),r=h*p,a=r&&gt(t,e)/r;return Math.acos(Math.min(Math.max(a,-1),1))}function Or(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ir(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Er(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Rr(t,e){var n=t[0],i=t[1],s=t[2],o=e[0],l=e[1],c=e[2];return Math.abs(n-o)<=P*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-l)<=P*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-c)<=P*Math.max(1,Math.abs(s),Math.abs(c))}var kr=In,Fr=En,Br=Rn,Lr=kn,Dr=Fn,kt=On,Nr=Bn,zr=function(){var t=ut();return function(e,n,i,s,o,l){var c,h;for(n||(n=3),i||(i=0),s?h=Math.min(s*n+i,e.length):h=e.length,c=i;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],o(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}}();var q={};Je(q,{add:()=>Nt,ceil:()=>Ur,clone:()=>Ft,copy:()=>Lt,create:()=>Ln,cross:()=>Qr,dist:()=>rs,distance:()=>Un,div:()=>is,divide:()=>zn,dot:()=>Vt,equals:()=>Xt,exactEquals:()=>Wt,floor:()=>Vr,forEach:()=>ls,fromValues:()=>Bt,inverse:()=>Gr,len:()=>os,length:()=>vt,lerp:()=>Ht,max:()=>Wr,min:()=>Hr,mul:()=>ns,multiply:()=>Nn,negate:()=>Yr,normalize:()=>Ut,random:()=>$r,round:()=>Xr,scale:()=>zt,scaleAndAdd:()=>qr,set:()=>Dt,sqrDist:()=>ss,sqrLen:()=>as,squaredDistance:()=>Vn,squaredLength:()=>bt,str:()=>es,sub:()=>ts,subtract:()=>Dn,transformMat4:()=>Zr,transformQuat:()=>Kr,zero:()=>Jr});function Ln(){var t=new E(4);return E!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ft(t){var e=new E(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Bt(t,e,n,i){var s=new E(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s}function Lt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Dt(t,e,n,i,s){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t}function Nt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Dn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Nn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function zn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Ur(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Vr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Hr(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Wr(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Xr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function zt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function qr(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t}function Un(t,e){var n=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,i,s,o)}function Vn(t,e){var n=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],o=e[3]-t[3];return n*n+i*i+s*s+o*o}function vt(t){var e=t[0],n=t[1],i=t[2],s=t[3];return Math.hypot(e,n,i,s)}function bt(t){var e=t[0],n=t[1],i=t[2],s=t[3];return e*e+n*n+i*i+s*s}function Yr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Gr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Ut(t,e){var n=e[0],i=e[1],s=e[2],o=e[3],l=n*n+i*i+s*s+o*o;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=i*l,t[2]=s*l,t[3]=o*l,t}function Vt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Qr(t,e,n,i){var s=n[0]*i[1]-n[1]*i[0],o=n[0]*i[2]-n[2]*i[0],l=n[0]*i[3]-n[3]*i[0],c=n[1]*i[2]-n[2]*i[1],h=n[1]*i[3]-n[3]*i[1],p=n[2]*i[3]-n[3]*i[2],r=e[0],a=e[1],_=e[2],m=e[3];return t[0]=a*p-_*h+m*c,t[1]=-(r*p)+_*l-m*o,t[2]=r*h-a*l+m*s,t[3]=-(r*c)+a*o-_*s,t}function Ht(t,e,n,i){var s=e[0],o=e[1],l=e[2],c=e[3];return t[0]=s+i*(n[0]-s),t[1]=o+i*(n[1]-o),t[2]=l+i*(n[2]-l),t[3]=c+i*(n[3]-c),t}function $r(t,e){e=e||1;var n,i,s,o,l,c;do n=X()*2-1,i=X()*2-1,l=n*n+i*i;while(l>=1);do s=X()*2-1,o=X()*2-1,c=s*s+o*o;while(c>=1);var h=Math.sqrt((1-l)/c);return t[0]=e*n,t[1]=e*i,t[2]=e*s*h,t[3]=e*o*h,t}function Zr(t,e,n){var i=e[0],s=e[1],o=e[2],l=e[3];return t[0]=n[0]*i+n[4]*s+n[8]*o+n[12]*l,t[1]=n[1]*i+n[5]*s+n[9]*o+n[13]*l,t[2]=n[2]*i+n[6]*s+n[10]*o+n[14]*l,t[3]=n[3]*i+n[7]*s+n[11]*o+n[15]*l,t}function Kr(t,e,n){var i=e[0],s=e[1],o=e[2],l=n[0],c=n[1],h=n[2],p=n[3],r=p*i+c*o-h*s,a=p*s+h*i-l*o,_=p*o+l*s-c*i,m=-l*i-c*s-h*o;return t[0]=r*p+m*-l+a*-h-_*-c,t[1]=a*p+m*-c+_*-l-r*-h,t[2]=_*p+m*-h+r*-c-a*-l,t[3]=e[3],t}function Jr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function es(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Wt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Xt(t,e){var n=t[0],i=t[1],s=t[2],o=t[3],l=e[0],c=e[1],h=e[2],p=e[3];return Math.abs(n-l)<=P*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-c)<=P*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(s-h)<=P*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-p)<=P*Math.max(1,Math.abs(o),Math.abs(p))}var ts=Dn,ns=Nn,is=zn,rs=Un,ss=Vn,os=vt,as=bt,ls=function(){var t=Ln();return function(e,n,i,s,o,l){var c,h;for(n||(n=4),i||(i=0),s?h=Math.min(s*n+i,e.length):h=e.length,c=i;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],o(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}}();function nt(){var t=new E(4);return E!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function cs(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Hn(t,e,n){n=n*.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function _s(t,e){var n=Math.acos(e[3])*2,i=Math.sin(n/2);return i>P?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function hs(t,e){var n=yt(t,e);return Math.acos(2*n*n-1)}function Wn(t,e,n){var i=e[0],s=e[1],o=e[2],l=e[3],c=n[0],h=n[1],p=n[2],r=n[3];return t[0]=i*r+l*c+s*p-o*h,t[1]=s*r+l*h+o*c-i*p,t[2]=o*r+l*p+i*h-s*c,t[3]=l*r-i*c-s*h-o*p,t}function qt(t,e,n){n*=.5;var i=e[0],s=e[1],o=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=i*h+l*c,t[1]=s*h+o*c,t[2]=o*h-s*c,t[3]=l*h-i*c,t}function Yt(t,e,n){n*=.5;var i=e[0],s=e[1],o=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=i*h-o*c,t[1]=s*h+l*c,t[2]=o*h+i*c,t[3]=l*h-s*c,t}function Gt(t,e,n){n*=.5;var i=e[0],s=e[1],o=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=i*h+s*c,t[1]=s*h-i*c,t[2]=o*h+l*c,t[3]=l*h-o*c,t}function ps(t,e){var n=e[0],i=e[1],s=e[2];return t[0]=n,t[1]=i,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-s*s)),t}function Xn(t,e){var n=e[0],i=e[1],s=e[2],o=e[3],l=Math.sqrt(n*n+i*i+s*s),c=Math.exp(o),h=l>0?c*Math.sin(l)/l:0;return t[0]=n*h,t[1]=i*h,t[2]=s*h,t[3]=c*Math.cos(l),t}function qn(t,e){var n=e[0],i=e[1],s=e[2],o=e[3],l=Math.sqrt(n*n+i*i+s*s),c=l>0?Math.atan2(l,o)/l:0;return t[0]=n*c,t[1]=i*c,t[2]=s*c,t[3]=.5*Math.log(n*n+i*i+s*s+o*o),t}function ms(t,e,n){return qn(t,e),Gn(t,t,n),Xn(t,t),t}function wt(t,e,n,i){var s=e[0],o=e[1],l=e[2],c=e[3],h=n[0],p=n[1],r=n[2],a=n[3],_,m,u,f,d;return m=s*h+o*p+l*r+c*a,m<0&&(m=-m,h=-h,p=-p,r=-r,a=-a),1-m>P?(_=Math.acos(m),u=Math.sin(_),f=Math.sin((1-i)*_)/u,d=Math.sin(i*_)/u):(f=1-i,d=i),t[0]=f*s+d*h,t[1]=f*o+d*p,t[2]=f*l+d*r,t[3]=f*c+d*a,t}function ds(t){var e=X(),n=X(),i=X(),s=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*i),t[3]=o*Math.cos(2*Math.PI*i),t}function us(t,e){var n=e[0],i=e[1],s=e[2],o=e[3],l=n*n+i*i+s*s+o*o,c=l?1/l:0;return t[0]=-n*c,t[1]=-i*c,t[2]=-s*c,t[3]=o*c,t}function fs(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Yn(t,e){var n=e[0]+e[4]+e[8],i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var o=(s+1)%3,l=(s+2)%3;i=Math.sqrt(e[s*3+s]-e[o*3+o]-e[l*3+l]+1),t[s]=.5*i,i=.5/i,t[3]=(e[o*3+l]-e[l*3+o])*i,t[o]=(e[o*3+s]+e[s*3+o])*i,t[l]=(e[l*3+s]+e[s*3+l])*i}return t}function gs(t,e,n,i){var s=.5*Math.PI/180;e*=s,n*=s,i*=s;var o=Math.sin(e),l=Math.cos(e),c=Math.sin(n),h=Math.cos(n),p=Math.sin(i),r=Math.cos(i);return t[0]=o*h*r-l*c*p,t[1]=l*c*r+o*h*p,t[2]=l*h*p-o*c*r,t[3]=l*h*r+o*c*p,t}function vs(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var bs=Ft,ws=Bt,xt=Lt,xs=Dt,ys=Nt,Ms=Wn,Gn=zt,yt=Vt,Ts=Ht,Mt=vt,As=Mt,Tt=bt,js=Tt,Qt=Ut,Ss=Wt,Cs=Xt,Ps=function(){var t=ut(),e=ft(1,0,0),n=ft(0,1,0);return function(i,s,o){var l=gt(s,o);return l<-.999999?(tt(t,e,s),kt(t)<1e-6&&tt(t,n,s),Rt(t,t),Hn(i,t,Math.PI),i):l>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(tt(t,s,o),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+l,Qt(i,i))}}(),Os=function(){var t=nt(),e=nt();return function(n,i,s,o,l,c){return wt(t,i,l,c),wt(e,s,o,c),wt(n,t,e,2*c*(1-c)),n}}(),Is=function(){var t=yn();return function(e,n,i,s){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],Qt(e,Yn(e,t))}}();var U={};Je(U,{add:()=>Js,clone:()=>Rs,conjugate:()=>ro,copy:()=>$n,create:()=>Es,dot:()=>Kn,equals:()=>_o,exactEquals:()=>co,fromMat4:()=>Ds,fromRotation:()=>Ls,fromRotationTranslation:()=>Qn,fromRotationTranslationValues:()=>Fs,fromTranslation:()=>Bs,fromValues:()=>ks,getDual:()=>Vs,getReal:()=>Us,getTranslation:()=>Xs,identity:()=>Ns,invert:()=>io,len:()=>so,length:()=>Jn,lerp:()=>no,mul:()=>eo,multiply:()=>Zn,normalize:()=>ao,rotateAroundAxis:()=>Ks,rotateByQuatAppend:()=>$s,rotateByQuatPrepend:()=>Zs,rotateX:()=>Ys,rotateY:()=>Gs,rotateZ:()=>Qs,scale:()=>to,set:()=>zs,setDual:()=>Ws,setReal:()=>Hs,sqrLen:()=>oo,squaredLength:()=>At,str:()=>lo,translate:()=>qs});function Es(){var t=new E(8);return E!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function Rs(t){var e=new E(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function ks(t,e,n,i,s,o,l,c){var h=new E(8);return h[0]=t,h[1]=e,h[2]=n,h[3]=i,h[4]=s,h[5]=o,h[6]=l,h[7]=c,h}function Fs(t,e,n,i,s,o,l){var c=new E(8);c[0]=t,c[1]=e,c[2]=n,c[3]=i;var h=s*.5,p=o*.5,r=l*.5;return c[4]=h*i+p*n-r*e,c[5]=p*i+r*t-h*n,c[6]=r*i+h*e-p*t,c[7]=-h*t-p*e-r*n,c}function Qn(t,e,n){var i=n[0]*.5,s=n[1]*.5,o=n[2]*.5,l=e[0],c=e[1],h=e[2],p=e[3];return t[0]=l,t[1]=c,t[2]=h,t[3]=p,t[4]=i*p+s*h-o*c,t[5]=s*p+o*l-i*h,t[6]=o*p+i*c-s*l,t[7]=-i*l-s*c-o*h,t}function Bs(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0]*.5,t[5]=e[1]*.5,t[6]=e[2]*.5,t[7]=0,t}function Ls(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ds(t,e){var n=nt();Et(n,e);var i=new E(3);return It(i,e),Qn(t,n,i),t}function $n(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ns(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function zs(t,e,n,i,s,o,l,c,h){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t[4]=o,t[5]=l,t[6]=c,t[7]=h,t}var Us=xt;function Vs(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Hs=xt;function Ws(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Xs(t,e){var n=e[4],i=e[5],s=e[6],o=e[7],l=-e[0],c=-e[1],h=-e[2],p=e[3];return t[0]=(n*p+o*l+i*h-s*c)*2,t[1]=(i*p+o*c+s*l-n*h)*2,t[2]=(s*p+o*h+n*c-i*l)*2,t}function qs(t,e,n){var i=e[0],s=e[1],o=e[2],l=e[3],c=n[0]*.5,h=n[1]*.5,p=n[2]*.5,r=e[4],a=e[5],_=e[6],m=e[7];return t[0]=i,t[1]=s,t[2]=o,t[3]=l,t[4]=l*c+s*p-o*h+r,t[5]=l*h+o*c-i*p+a,t[6]=l*p+i*h-s*c+_,t[7]=-i*c-s*h-o*p+m,t}function Ys(t,e,n){var i=-e[0],s=-e[1],o=-e[2],l=e[3],c=e[4],h=e[5],p=e[6],r=e[7],a=c*l+r*i+h*o-p*s,_=h*l+r*s+p*i-c*o,m=p*l+r*o+c*s-h*i,u=r*l-c*i-h*s-p*o;return qt(t,e,n),i=t[0],s=t[1],o=t[2],l=t[3],t[4]=a*l+u*i+_*o-m*s,t[5]=_*l+u*s+m*i-a*o,t[6]=m*l+u*o+a*s-_*i,t[7]=u*l-a*i-_*s-m*o,t}function Gs(t,e,n){var i=-e[0],s=-e[1],o=-e[2],l=e[3],c=e[4],h=e[5],p=e[6],r=e[7],a=c*l+r*i+h*o-p*s,_=h*l+r*s+p*i-c*o,m=p*l+r*o+c*s-h*i,u=r*l-c*i-h*s-p*o;return Yt(t,e,n),i=t[0],s=t[1],o=t[2],l=t[3],t[4]=a*l+u*i+_*o-m*s,t[5]=_*l+u*s+m*i-a*o,t[6]=m*l+u*o+a*s-_*i,t[7]=u*l-a*i-_*s-m*o,t}function Qs(t,e,n){var i=-e[0],s=-e[1],o=-e[2],l=e[3],c=e[4],h=e[5],p=e[6],r=e[7],a=c*l+r*i+h*o-p*s,_=h*l+r*s+p*i-c*o,m=p*l+r*o+c*s-h*i,u=r*l-c*i-h*s-p*o;return Gt(t,e,n),i=t[0],s=t[1],o=t[2],l=t[3],t[4]=a*l+u*i+_*o-m*s,t[5]=_*l+u*s+m*i-a*o,t[6]=m*l+u*o+a*s-_*i,t[7]=u*l-a*i-_*s-m*o,t}function $s(t,e,n){var i=n[0],s=n[1],o=n[2],l=n[3],c=e[0],h=e[1],p=e[2],r=e[3];return t[0]=c*l+r*i+h*o-p*s,t[1]=h*l+r*s+p*i-c*o,t[2]=p*l+r*o+c*s-h*i,t[3]=r*l-c*i-h*s-p*o,c=e[4],h=e[5],p=e[6],r=e[7],t[4]=c*l+r*i+h*o-p*s,t[5]=h*l+r*s+p*i-c*o,t[6]=p*l+r*o+c*s-h*i,t[7]=r*l-c*i-h*s-p*o,t}function Zs(t,e,n){var i=e[0],s=e[1],o=e[2],l=e[3],c=n[0],h=n[1],p=n[2],r=n[3];return t[0]=i*r+l*c+s*p-o*h,t[1]=s*r+l*h+o*c-i*p,t[2]=o*r+l*p+i*h-s*c,t[3]=l*r-i*c-s*h-o*p,c=n[4],h=n[5],p=n[6],r=n[7],t[4]=i*r+l*c+s*p-o*h,t[5]=s*r+l*h+o*c-i*p,t[6]=o*r+l*p+i*h-s*c,t[7]=l*r-i*c-s*h-o*p,t}function Ks(t,e,n,i){if(Math.abs(i)<P)return $n(t,e);var s=Math.hypot(n[0],n[1],n[2]);i=i*.5;var o=Math.sin(i),l=o*n[0]/s,c=o*n[1]/s,h=o*n[2]/s,p=Math.cos(i),r=e[0],a=e[1],_=e[2],m=e[3];t[0]=r*p+m*l+a*h-_*c,t[1]=a*p+m*c+_*l-r*h,t[2]=_*p+m*h+r*c-a*l,t[3]=m*p-r*l-a*c-_*h;var u=e[4],f=e[5],d=e[6],b=e[7];return t[4]=u*p+b*l+f*h-d*c,t[5]=f*p+b*c+d*l-u*h,t[6]=d*p+b*h+u*c-f*l,t[7]=b*p-u*l-f*c-d*h,t}function Js(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Zn(t,e,n){var i=e[0],s=e[1],o=e[2],l=e[3],c=n[4],h=n[5],p=n[6],r=n[7],a=e[4],_=e[5],m=e[6],u=e[7],f=n[0],d=n[1],b=n[2],w=n[3];return t[0]=i*w+l*f+s*b-o*d,t[1]=s*w+l*d+o*f-i*b,t[2]=o*w+l*b+i*d-s*f,t[3]=l*w-i*f-s*d-o*b,t[4]=i*r+l*c+s*p-o*h+a*w+u*f+_*b-m*d,t[5]=s*r+l*h+o*c-i*p+_*w+u*d+m*f-a*b,t[6]=o*r+l*p+i*h-s*c+m*w+u*b+a*d-_*f,t[7]=l*r-i*c-s*h-o*p+u*w-a*f-_*d-m*b,t}var eo=Zn;function to(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Kn=yt;function no(t,e,n,i){var s=1-i;return Kn(e,n)<0&&(i=-i),t[0]=e[0]*s+n[0]*i,t[1]=e[1]*s+n[1]*i,t[2]=e[2]*s+n[2]*i,t[3]=e[3]*s+n[3]*i,t[4]=e[4]*s+n[4]*i,t[5]=e[5]*s+n[5]*i,t[6]=e[6]*s+n[6]*i,t[7]=e[7]*s+n[7]*i,t}function io(t,e){var n=At(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function ro(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Jn=Mt,so=Jn,At=Tt,oo=At;function ao(t,e){var n=At(e);if(n>0){n=Math.sqrt(n);var i=e[0]/n,s=e[1]/n,o=e[2]/n,l=e[3]/n,c=e[4],h=e[5],p=e[6],r=e[7],a=i*c+s*h+o*p+l*r;t[0]=i,t[1]=s,t[2]=o,t[3]=l,t[4]=(c-i*a)/n,t[5]=(h-s*a)/n,t[6]=(p-o*a)/n,t[7]=(r-l*a)/n}return t}function lo(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function co(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function _o(t,e){var n=t[0],i=t[1],s=t[2],o=t[3],l=t[4],c=t[5],h=t[6],p=t[7],r=e[0],a=e[1],_=e[2],m=e[3],u=e[4],f=e[5],d=e[6],b=e[7];return Math.abs(n-r)<=P*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-a)<=P*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(s-_)<=P*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(o-m)<=P*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-u)<=P*Math.max(1,Math.abs(l),Math.abs(u))&&Math.abs(c-f)<=P*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(h-d)<=P*Math.max(1,Math.abs(h),Math.abs(d))&&Math.abs(p-b)<=P*Math.max(1,Math.abs(p),Math.abs(b))}var we=class extends x{init(){this.session=null,this.collisionMask=1<<this.collisionGroup,this.maxDistance=100;let e=this.onDestroy.bind(this);this.engine.onSceneLoaded.push(e),this.onDestroyCallbacks=[()=>{let n=this.engine.onSceneLoaded.indexOf(e);n>=0&&this.engine.onSceneLoaded.splice(n,1)}]}start(){if(this.handedness==0){let n=this.object.getComponent("input");n?(this.handedness=n.handedness,this.input=n):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];if(this.globalTarget=this.object.addComponent("cursor-target"),this.origin=new Float32Array(3),this.cursorObjScale=new Float32Array(3),this.direction=[0,0,0],this.tempQuat=new Float32Array(4),this.viewComponent=this.object.getComponent("view"),this.viewComponent!=null){let n=this.onClick.bind(this);this.engine.canvas.addEventListener("click",n);let i=this.onPointerMove.bind(this);this.engine.canvas.addEventListener("pointermove",i);let s=this.onPointerDown.bind(this);this.engine.canvas.addEventListener("pointerdown",s);let o=this.onPointerUp.bind(this);this.engine.canvas.addEventListener("pointerup",o),this.projectionMatrix=new Float32Array(16),re.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let l=this.onViewportResize.bind(this);window.addEventListener("resize",l),this.onDestroyCallbacks.push(()=>{this.engine.canvas.removeEventListener("click",n),this.engine.canvas.removeEventListener("pointermove",i),this.engine.canvas.removeEventListener("pointerdown",s),this.engine.canvas.removeEventListener("pointerup",o),window.removeEventListener("resize",l)})}this.isHovering=!1,this.visible=!0,this.isDown=!1,this.lastIsDown=!1,this.cursorPos=new Float32Array(3),this.hoveringObject=null;let e=this.setupVREvents.bind(this);this.engine.onXRSessionStart.push(e),this.onDestroyCallbacks.push(()=>{let n=this.engine.onXRSessionStart.indexOf(e);n>=0&&this.engine.onXRSessionStart.splice(n,1)}),this.cursorRayObject&&(this.cursorRayScale=new Float32Array(3),this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction),this._setCursorRayTransform([this.origin[0]+this.direction[0],this.origin[1]+this.direction[1],this.origin[2]+this.direction[2]]))}onViewportResize(){this.viewComponent&&re.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)}_setCursorRayTransform(e){if(!this.cursorRayObject)return;let n=v.dist(this.origin,e);this.cursorRayObject.setTranslationLocal([0,0,-n/2]),this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),this.cursorRayScale[this.cursorRayScalingAxis]=n/2,this.cursorRayObject.scale(this.cursorRayScale))}_setCursorVisibility(e){this.visible!=e&&(this.visible=e,this.cursorObject&&(e?(this.cursorObject.resetScaling(),this.cursorObject.scale(this.cursorObjScale)):(this.cursorObjScale.set(this.cursorObject.scalingLocal),this.cursorObject.scale([0,0,0]))))}update(){this.doUpdate(!1)}doUpdate(e){if(this.session){if(this.arTouchDown&&this.input&&this.engine.xrSession.inputSources[0].handedness==="none"&&this.engine.xrSession.inputSources[0].gamepad){let i=this.engine.xrSession.inputSources[0].gamepad.axes;this.direction=[i[0],-i[1],-1],this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let n=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);n.hitCount>0?this.cursorPos.set(n.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(n,e)}this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):this._setCursorVisibility(!1))}hoverBehaviour(e,n){if(e.hitCount>0){if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let o=this.hoveringObject.getComponent("cursor-target");o&&o.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.hoveringObject=e.objects[0],this.styleCursor&&(this.engine.canvas.style.cursor="pointer");let s=this.hoveringObject.getComponent("cursor-target");s&&(this.hoveringObjectTarget=s,s.onHover(this.hoveringObject,this)),this.globalTarget.onHover(this.hoveringObject,this)}this.hoveringObjectTarget&&this.hoveringObjectTarget.onMove(this.hoveringObject,this);let i=this.hoveringObject.getComponent("cursor-target");this.isDown!==this.lastIsDown&&(this.isDown?(i&&i.onDown(this.hoveringObject,this),this.globalTarget.onDown(this.hoveringObject,this)):(i&&i.onUp(this.hoveringObject,this),this.globalTarget.onUp(this.hoveringObject,this))),n&&(i&&i.onClick(this.hoveringObject,this),this.globalTarget.onClick(this.hoveringObject,this))}else if(this.hoveringObject&&e.hitCount==0){let i=this.hoveringObject.getComponent("cursor-target");i&&i.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(this.engine.canvas.style.cursor="default")}this.lastIsDown=this.isDown}setupVREvents(e){this.session=e;let n=function(l){this.session=null}.bind(this);e.addEventListener("end",n);let i=this.onSelect.bind(this);e.addEventListener("select",i);let s=this.onSelectStart.bind(this);e.addEventListener("selectstart",s);let o=this.onSelectEnd.bind(this);e.addEventListener("selectend",o),this.onDestroyCallbacks.push(()=>{this.session&&(e.removeEventListener("end",n),e.removeEventListener("select",i),e.removeEventListener("selectstart",s),e.removeEventListener("selectend",o))}),this.onViewportResize()}onSelect(e){e.inputSource.handedness==this.handedness&&this.doUpdate(!0)}onSelectStart(e){this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)}onSelectEnd(e){this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown=!1)}onPointerMove(e){if(!e.isPrimary)return;let n=e.target.getBoundingClientRect(),i=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(i,!1)}onClick(e){let n=e.target.getBoundingClientRect(),i=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(i,!0)}onPointerDown(e){if(!e.isPrimary||e.button!==0)return;let n=e.target.getBoundingClientRect(),i=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!0,this.hoverBehaviour(i,!1)}onPointerUp(e){if(!e.isPrimary||e.button!==0)return;let n=e.target.getBoundingClientRect(),i=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!1,this.hoverBehaviour(i,!1)}updateMousePos(e,n,i,s){let o=e/i,l=n/s;return this.direction=[o*2-1,-l*2+1,-1],this.updateDirection()}updateDirection(){this.object.getTranslationWorld(this.origin),v.transformMat4(this.direction,this.direction,this.projectionMatrix),v.normalize(this.direction,this.direction),v.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e}onDeactivate(){if(this._setCursorVisibility(!1),this.hoveringObject){let e=this.hoveringObject.getComponent("cursor-target");e&&e.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.cursorRayObject&&this.cursorRayObject.scale([0,0,0])}onActivate(){this._setCursorVisibility(!0)}onDestroy(){for(let e of this.onDestroyCallbacks)e()}};M(we,"TypeName","cursor"),M(we,"Properties",{collisionGroup:{type:g.Int,default:1},cursorRayObject:{type:g.Object},cursorRayScalingAxis:{type:g.Enum,values:["x","y","z","none"],default:"z"},cursorObject:{type:g.Object},handedness:{type:g.Enum,values:["input component","left","right","none"],default:"input component"},rayCastMode:{type:g.Enum,values:["collision","physx"],default:"collision"},styleCursor:{type:g.Bool,default:!0}});var xe=class extends x{start(){}init(){let e=[0,0,0];U.getTranslation(e,this.object.transformWorld),console.log("Debug Object:",this.object.name),console.log("Other object:",this.obj.name),console.log("	translation",e),console.log("	transformWorld",this.object.transformWorld),console.log("	transformLocal",this.object.transformLocal)}update(){}};M(xe,"TypeName","debug-object"),M(xe,"Properties",{obj:{type:g.Object}});function ho(t,e,n,i){let s=Math.cos(e/2),o=Math.cos(n/2),l=Math.cos(i/2),c=Math.sin(e/2),h=Math.sin(n/2),p=Math.sin(i/2);t[0]=c*o*l+s*h*p,t[1]=s*h*l-c*o*p,t[2]=s*o*p-c*h*l,t[3]=s*o*l+c*h*p}var ye=class extends x{start(){this.rotationX=0,this.rotationY=0,this.lastClientX=-1,this.lastClientY=-1}init(){this.deviceOrientation=[0,0,0,1],this.screenOrientation=window.innerHeight>window.innerWidth?0:90,this._origin=[0,0,0],window.addEventListener("deviceorientation",function(e){let n=e.alpha||0,i=e.beta||0,s=e.gamma||0,o=Math.PI/180;ho(this.deviceOrientation,i*o,n*o,-s*o)}.bind(this)),window.addEventListener("orientationchange",function(e){this.screenOrientation=window.orientation||0}.bind(this),!1)}update(){Module.webxr_session==null&&(this.object.getTranslationLocal(this._origin),this.object.resetTransform(),this.screenOrientation!=0&&this.object.rotateAxisAngleDeg([0,0,-1],this.screenOrientation),this.object.rotate([-Math.sqrt(.5),0,0,Math.sqrt(.5)]),this.object.rotate(this.deviceOrientation),this.object.translate(this._origin))}};M(ye,"TypeName","device-orientation-look"),M(ye,"Properties",{});var Me=class extends x{init(){this.lastTarget=null}start(){this.tip=this.object.getComponent("collision")}update(){let e=this.tip.queryOverlaps(),n=null;for(let i=0;i<e.length;++i){let s=e[i].object,o=s.getComponent("cursor-target");if(o){o.equals(this.lastTarget)||(o.onHover(s,this),o.onClick(s,this)),n=o;break}}if(n)this.lastTarget=n;else{this.lastTarget&&this.lastTarget.onUnhover(this.lastTarget.object,this),this.lastTarget=null;return}}};M(Me,"TypeName","finger-cursor"),M(Me,"Properties",{});var Te=class extends x{start(){this.engine.xrSession?this.setFixedFoveation():this.engine.onXRSessionStart.push(this.setFixedFoveation.bind(this))}setFixedFoveation(){this.engine.xrBaseLayer.fixedFoveation=this.fixedFoveation}};M(Te,"TypeName","fixed-foveation"),M(Te,"Properties",{fixedFoveation:{type:g.Float,default:.5}});var it=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],Ae=class extends x{init(){this.handedness=["left","right"][this.handedness]}start(){if(this.joints=[],this.session=null,this.hasPose=!1,this._childrenActive=!0,!("XRHand"in window)){console.warn("WebXR Hand Tracking not supported by this browser."),this.active=!1;return}if(this.handSkin){let n=this.handSkin.jointIds;this.joints[it[0]]=this.engine.wrapObject(n[0]);for(let i=0;i<n.length;++i){let s=this.engine.wrapObject(n[i]);this.joints[s.name]=s}return}for(let e=0;e<=it.length;++e){let n=this.engine.scene.addObject(this.object.parent),i=n.addComponent("mesh");i.mesh=this.jointMesh,i.material=this.jointMaterial,this.joints[it[e]]=n}}update(e){if(this.session||this.engine.xrSession&&this.setupVREvents(this.engine.xrSession),!!this.session){if(this.hasPose=!1,this.session&&this.session.inputSources)for(let n=0;n<=this.session.inputSources.length;++n){let i=this.session.inputSources[n];if(!i||!i.hand||i.handedness!=this.handedness)continue;if(this.hasPose=!0,i.hand.get("wrist")!==null){let l=this.engine.wasm.WebXR,c=Module.webxr_frame.getJointPose(i.hand.get("wrist"),l.refSpaces[l.refSpace]);c&&(this.object.resetTranslationRotation(),this.object.transformLocal.set([c.transform.orientation.x,c.transform.orientation.y,c.transform.orientation.z,c.transform.orientation.w]),this.object.translate([c.transform.position.x,c.transform.position.y,c.transform.position.z]))}let s=new Float32Array(3),o=new Float32Array(4);S.invert(o,this.object.transformLocal),this.object.getTranslationLocal(s);for(let l=0;l<it.length;++l){let c=it[l],h=this.joints[c];if(h==null)continue;let p=null;if(i.hand.get(c)!==null){let r=this.engine.wasm.WebXR;p=Module.webxr_frame.getJointPose(i.hand.get(c),r.refSpaces[r.refSpace])}if(p!==null)if(this.handSkin)h.resetTranslationRotation(),h.translate([p.transform.position.x-s[0],p.transform.position.y-s[1],p.transform.position.z-s[2]]),h.rotate(o),h.rotateObject([p.transform.orientation.x,p.transform.orientation.y,p.transform.orientation.z,p.transform.orientation.w]);else{h.resetTransform(),h.transformLocal.set([p.transform.orientation.x,p.transform.orientation.y,p.transform.orientation.z,p.transform.orientation.w]),h.translate([p.transform.position.x,p.transform.position.y,p.transform.position.z]);let r=p.radius||.007;h.scale([r,r,r])}else this.handSkin||h.scale([0,0,0])}}!this.hasPose&&this._childrenActive?(this._childrenActive=!1,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!1),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!0,this.setChildrenActive(!0,this.controllerToDeactivate))):this.hasPose&&!this._childrenActive&&(this._childrenActive=!0,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!0),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!1,this.setChildrenActive(!1,this.controllerToDeactivate)))}}setChildrenActive(e,n){n=n||this.object;let i=n.children;for(let s of i)s.active=e,this.setChildrenActive(e,s)}isGrabbing(){let e=[0,0,0];U.getTranslation(e,this.joints["index-finger-tip"].transformLocal);let n=[0,0,0];return U.getTranslation(n,this.joints["thumb-tip"].transformLocal),v.sqrDist(n,e)<.001}setupVREvents(e){this.session=e}};M(Ae,"TypeName","hand-tracking"),M(Ae,"Properties",{handedness:{type:g.Enum,default:"left",values:["left","right"]},jointMesh:{type:g.Mesh,default:null},jointMaterial:{type:g.Material,default:null},handSkin:{type:g.Skin,default:null},deactivateChildrenWithoutPose:{type:g.Bool,default:!0},controllerToDeactivate:{type:g.Object}});var je=class extends x{init(){this.engine.onXRSessionStart.push(this.xrSessionStart.bind(this)),this.engine.onXRSessionEnd.push(this.xrSessionEnd.bind(this)),this.tempScaling=new Float32Array(3),this.tempScaling.set(this.object.scalingLocal),this.visible=!1,this.object.scale([0,0,0])}update(e){let n=this.visible;if(this.xrHitTestSource){let i=this.engine.xrFrame;if(!i)return;let s=i.getHitTestResults(this.xrHitTestSource);if(s.length>0){let o=s[0].getPose(this.xrViewerSpace);this.visible=!0,U.fromMat4(this.object.transformLocal,o.transform.matrix),this.object.setDirty()}else this.visible=!1}this.visible!=n&&(this.visible?(this.object.scalingLocal.set(this.tempScaling),this.object.setDirty()):(this.tempScaling.set(this.object.scalingLocal),this.object.scale([0,0,0])))}xrSessionStart(e){e.requestReferenceSpace("viewer").then(function(n){this.xrViewerSpace=n,e.requestHitTestSource({space:this.xrViewerSpace}).then(function(i){this.xrHitTestSource=i}.bind(this)).catch(console.error)}.bind(this)).catch(console.error)}xrSessionEnd(){this.xrHitTestSource&&(this.xrHitTestSource.cancel(),this.xrHitTestSource=null)}};M(je,"TypeName","hit-test-location"),M(je,"Properties",{});var Ra=hn($t());var Se=class extends x{init(){this.origin=new Float32Array(3),this.fwd=new Float32Array(3),this.up=new Float32Array(3)}update(){this.spatial&&(this.object.getTranslationWorld(this.origin),this.object.getForward(this.fwd),this.object.getUp(this.up),Howler.pos(this.origin[0],this.origin[1],this.origin[2]),Howler.orientation(this.fwd[0],this.fwd[1],this.fwd[2],this.up[0],this.up[1],this.up[2]))}};M(Se,"TypeName","howler-audio-listener"),M(Se,"Properties",{spatial:{type:g.Bool,default:!0}});var ei=hn($t());var Ce=class extends x{start(){this.audio=new ei.Howl({src:[this.src],loop:this.loop,volume:this.volume,autoplay:this.autoplay}),this.lastPlayedAudioId=null,this.origin=new Float32Array(3),this.lastOrigin=new Float32Array(3),this.spatial&&this.autoplay&&(this.updatePosition(),this.play());let e=()=>{this.stop();let n=this.engine.onSceneLoaded.indexOf(e);n>=0&&this.engine.onSceneLoaded.splice(n,1)};this.engine.onSceneLoaded.push(e)}update(){!this.spatial||!this.lastPlayedAudioId||(this.object.getTranslationWorld(this.origin),(Math.abs(this.lastOrigin[0]-this.origin[0])>.005||Math.abs(this.lastOrigin[1]-this.origin[1])>.005||Math.abs(this.lastOrigin[2]-this.origin[2])>.005)&&this.updatePosition())}updatePosition(){this.audio.pos(this.origin[0],this.origin[1],this.origin[2],this.lastPlayedAudioId),this.lastOrigin.set(this.origin)}play(){this.lastPlayedAudioId&&this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=this.audio.play(),this.spatial&&this.updatePosition()}stop(){this.lastPlayedAudioId&&(this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=null)}};M(Ce,"TypeName","howler-audio-source"),M(Ce,"Properties",{volume:{type:g.Float,default:1},spatial:{type:g.Bool,default:!0},loop:{type:g.Bool,default:!1},autoplay:{type:g.Bool,default:!1},src:{type:g.String,default:""}});var Pe=class extends x{start(){if(!this.material)throw Error("image-texture: material property not set");this.engine.textures.load(this.url,"anonymous").then(e=>{let n=this.material,i=n.shader;i==="Flat Opaque Textured"?n.flatTexture=e:i==="Phong Opaque Textured"||i==="Foliage"?n.diffuseTexture=e:i==="Background"?n.texture=e:i==="Physical Opaque Textured"?n.albedoTexture=e:console.error("Shader",i,"not supported by image-texture")}).catch(console.err)}};M(Pe,"TypeName","image-texture"),M(Pe,"Properties",{url:{type:g.String},material:{type:g.Material}});var Oe=class extends x{init(){this.currentRotationY=0,this.currentRotationX=0,this.origin=new Float32Array(3),this.parentOrigin=new Float32Array(3),this.rotationX=0,this.rotationY=0}start(){document.addEventListener("mousemove",n=>{if(this.active&&(this.mouseDown||!this.requireMouseDown)){this.rotationY=-this.sensitity*n.movementX/100,this.rotationX=-this.sensitity*n.movementY/100,this.currentRotationX+=this.rotationX,this.currentRotationY+=this.rotationY,this.currentRotationX=Math.min(1.507,this.currentRotationX),this.currentRotationX=Math.max(-1.507,this.currentRotationX),this.object.getTranslationWorld(this.origin);let i=this.object.parent;i!==null&&(i.getTranslationWorld(this.parentOrigin),v.sub(this.origin,this.origin,this.parentOrigin)),this.object.resetTranslationRotation(),this.object.rotateAxisAngleRad([1,0,0],this.currentRotationX),this.object.rotateAxisAngleRad([0,1,0],this.currentRotationY),this.object.translate(this.origin)}});let e=this.engine.canvas;this.pointerLockOnClick&&e.addEventListener("mousedown",()=>{e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock()}),this.requireMouseDown&&(this.mouseButtonIndex==2&&e.addEventListener("contextmenu",n=>{n.preventDefault()},!1),e.addEventListener("mousedown",n=>{if(n.button==this.mouseButtonIndex&&(this.mouseDown=!0,document.body.style.cursor="grabbing",n.button==1))return n.preventDefault(),!1}),e.addEventListener("mouseup",n=>{n.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}))}};M(Oe,"TypeName","mouse-look"),M(Oe,"Properties",{sensitity:{type:g.Float,default:.25},requireMouseDown:{type:g.Bool,default:!0},mouseButtonIndex:{type:g.Int},pointerLockOnClick:{type:g.Bool,default:!1}});var Ie=class extends x{init(){this.engine.onXRSessionStart.push(this.onXRSessionStart.bind(this)),this.engine.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))}start(){this.object.resetTranslationRotation(),this.object.translate([0,this.height,0])}onXRSessionStart(){let e=this.engine.wasm.WebXR;["local","viewer"].includes(e.refSpace)||this.object.resetTranslationRotation()}onXRSessionEnd(){let e=this.engine.wasm.WebXR;["local","viewer"].includes(e.refSpace)||(this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]))}};M(Ie,"TypeName","player-height"),M(Ie,"Properties",{height:{type:g.Float,default:1.75}});var Ee=class extends x{start(){this.engine.xrSession?this.setTargetFramerate(this.engine.xrSession):this.engine.onXRSessionStart.push(this.setTargetFramerate.bind(this))}setTargetFramerate(e){if(e.supportedFrameRates&&e.updateTargetFrameRate){let n=this.engine.xrSession.supportedFrameRates;n.sort((i,s)=>Math.abs(i-this.framerate)-Math.abs(s-this.framerate)),this.engine.xrSession.updateTargetFrameRate(n[0])}}};M(Ee,"TypeName","target-framerate"),M(Ee,"Properties",{framerate:{type:g.Float,default:90}});var Re=class extends x{init(){if(this._prevThumbstickAxis=new Float32Array(2),this._tempVec=new Float32Array(3),this._tempVec0=new Float32Array(3),this._currentIndicatorRotation=0,this.input=this.object.getComponent("input"),!this.input){console.error(this.object.name,"generic-teleport-component.js: input component is required on the object");return}if(!this.teleportIndicatorMeshObject){console.error(this.object.name,"generic-teleport-component.js: Teleport indicator mesh is missing");return}if(!this.camRoot){console.error(this.object.name,"generic-teleport-component.js: camRoot not set");return}this.isIndicating=!1,this.indicatorHidden=!0,this.hitSpot=new Float32Array(3),this._hasHit=!1,this._extraRotation=0,this._currentStickAxes=new Float32Array(2)}start(){if(this.cam&&(this.isMouseIndicating=!1,canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),canvas.addEventListener("mouseup",this.onMouseUp.bind(this))),this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("teleport component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.engine.onXRSessionStart.push(this.setupVREvents.bind(this)),this.teleportIndicatorMeshObject.active=!1}_getCamRotation(){return this.eyeLeft.getForward(this._tempVec),this._tempVec[1]=0,v.normalize(this._tempVec,this._tempVec),Math.atan2(this._tempVec[0],this._tempVec[2])}update(){let e=0;if(this.gamepad&&this.gamepad.axes&&(this._currentStickAxes[0]=this.gamepad.axes[2],this._currentStickAxes[1]=this.gamepad.axes[3],e=Math.abs(this._currentStickAxes[0])+Math.abs(this._currentStickAxes[1])),!this.isIndicating&&this._prevThumbstickAxis[1]>=this.thumbstickActivationThreshhold&&this._currentStickAxes[1]<this.thumbstickActivationThreshhold?this.isIndicating=!0:this.isIndicating&&e<this.thumbstickDeactivationThreshhold&&(this.isIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,this._extraRotation)),this.isIndicating&&this.teleportIndicatorMeshObject&&this.input){let n=this._tempVec0;U.getTranslation(n,this.object.transformWorld);let i=this.object.getForward(this._tempVec),s=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(n,i,1<<this.floorGroup):this.engine.physics.rayCast(n,i,1<<this.floorGroup,this.maxDistance);s.hitCount>0?(this.indicatorHidden=!1,this._extraRotation=Math.PI+Math.atan2(this._currentStickAxes[0],this._currentStickAxes[1]),this._currentIndicatorRotation=this._getCamRotation()+(this._extraRotation-Math.PI),this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(s.locations[0]),this.teleportIndicatorMeshObject.translate([0,this.indicatorYOffset,0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot.set(s.locations[0]),this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}else this.teleportIndicatorMeshObject&&this.isMouseIndicating&&this.onMousePressed();this._prevThumbstickAxis.set(this._currentStickAxes)}setupVREvents(e){if(this.session=e,e.addEventListener("end",function(){this.gamepad=null,this.session=null}.bind(this)),e.inputSources&&e.inputSources.length)for(let n=0;n<e.inputSources.length;n++){let i=e.inputSources[n];i.handedness==this.handedness&&(this.gamepad=i.gamepad)}e.addEventListener("inputsourceschange",function(n){if(n.added&&n.added.length)for(let i=0;i<n.added.length;i++){let s=n.added[i];s.handedness==this.handedness&&(this.gamepad=s.gamepad)}}.bind(this))}onMouseDown(){this.isMouseIndicating=!0}onMouseUp(){this.isMouseIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,0)}onMousePressed(){let e=[0,0,0];U.getTranslation(e,this.cam.transformWorld);let n=this.cam.getForward(this._tempVec),i=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(e,n,1<<this.floorGroup):this.engine.physics.rayCast(e,n,1<<this.floorGroup,this.maxDistance);i.hitCount>0?(this.indicatorHidden=!1,n[1]=0,v.normalize(n,n),this._currentIndicatorRotation=-Math.sign(n[2])*Math.acos(n[0])-Math.PI*.5,this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(i.locations[0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot=i.locations[0],this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}_teleportPlayer(e,n){this.camRoot.rotateAxisAngleRad([0,1,0],n);let i=this._tempVec,s=this._tempVec0;this.session?(this.eyeLeft.getTranslationWorld(i),this.eyeRight.getTranslationWorld(s),v.add(i,i,s),v.scale(i,i,.5)):this.cam.getTranslationWorld(i),this.camRoot.getTranslationWorld(s),v.sub(i,s,i),i[0]+=e[0],i[1]=e[1],i[2]+=e[2],this.camRoot.setTranslationWorld(i)}};M(Re,"TypeName","teleport"),M(Re,"Properties",{teleportIndicatorMeshObject:{type:g.Object},camRoot:{type:g.Object},cam:{type:g.Object},eyeLeft:{type:g.Object},eyeRight:{type:g.Object},handedness:{type:g.Enum,values:["input component","left","right","none"],default:"input component"},floorGroup:{type:g.Int,default:1},thumbstickActivationThreshhold:{type:g.Float,default:-.7},thumbstickDeactivationThreshhold:{type:g.Float,default:.3},indicatorYOffset:{type:g.Float,default:.01},rayCastMode:{type:g.Enum,values:["collision","physx"],default:"collision"},maxDistance:{type:g.Float,default:100}});var St=v.create(),Y=v.create(),rt=v.create(),ke=class extends x{init(){this.points=new Array(this.segments+1);for(let e=0;e<this.points.length;++e)this.points[e]=v.create();this.currentPointOffset=0,this.up=[0,1,0],this.timeTillNext=this.interval}start(){this.trailContainer=this.engine.scene.addObject(),this.meshComp=this.trailContainer.addComponent("mesh"),this.meshComp.material=this.material;let e=2*this.points.length;this.indexData=new Uint32Array(6*this.segments);for(let n=0,i=0;n<e-2;n+=2,i+=6)this.indexData.subarray(i,i+6).set([n+1,n+0,n+2,n+2,n+3,n+1]);this.mesh=new te({vertexCount:e,indexData:this.indexData,indexType:$.UnsignedInt}),this.meshComp.mesh=this.mesh}updateVertices(){let e=this.mesh.attribute(z.Position),n=this.mesh.attribute(z.TextureCoordinate),i=this.mesh.attribute(z.Normal);v.set(St,0,0,0);for(let s=0;s<this.points.length;++s){let o=this.points[(this.currentPointIndex+s+1)%this.points.length],l=this.points[(this.currentPointIndex+s+2)%this.points.length];s!==this.points.length-1&&v.sub(St,l,o),v.cross(Y,this.up,St),v.normalize(Y,Y);let c=1-this.timeTillNext/this.interval,h=(s-c)/this.segments;v.scale(Y,Y,(this.taper?h:1)*this.width/2),e.set(s*2,[o[0]-Y[0],o[1]-Y[1],o[2]-Y[2]]),e.set(s*2+1,[o[0]+Y[0],o[1]+Y[1],o[2]+Y[2]]),i&&(v.cross(rt,St,Y),v.normalize(rt,rt),i.set(s*2,rt),i.set(s*2+1,rt)),n&&(n.set(s*2,[0,h]),n.set(s*2+1,[1,h]))}this.mesh.update()}resetTrail(){this.object.getTranslationWorld(this.points[0]);for(let e=1;e<this.points.length;++e)v.copy(this.points[e],this.points[0]);this.currentPointIndex=0,this.timeTillNext=this.interval}update(e){this.timeTillNext-=e,e>this.resetThreshold&&this.resetTrail(),this.timeTillNext<0&&(this.currentPointIndex=(this.currentPointIndex+1)%this.points.length,this.timeTillNext=this.timeTillNext%this.interval+this.interval),this.object.getTranslationWorld(this.points[this.currentPointIndex]),this.updateVertices()}onActivate(){this.resetTrail()}onDestroy(){this.trailContainer.destroy(),this.mesh.destroy()}};M(ke,"TypeName","trail"),M(ke,"Properties",{material:{type:g.Material},segments:{type:g.Int,default:50},interval:{type:g.Float,default:.1},width:{type:g.Float,default:1},taper:{type:g.Bool,default:!0},resetThreshold:{type:g.Float,default:.5}});Math.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))};var po=function(){let t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),i=new Float32Array(3),s=new Float32Array(3),o=new Float32Array(3),l=new Float32Array(3),c=new Float32Array(4),h=new Float32Array(4),p=new Float32Array(4),r=new Float32Array(4);return function(a,_,m,u,f,d,b,w,y,A){v.sub(n,u,m);let T=v.length(n);v.sub(t,u,f);let j=v.length(t);v.sub(t,d,m);let I=Math.clamp(v.length(t),b,T+j-b);v.sub(e,f,m),v.sub(i,m,u),v.sub(s,f,u),v.normalize(e,e),v.normalize(n,n),v.normalize(i,i),v.normalize(s,s),v.normalize(t,t);let C=Math.acos(Math.clamp(v.dot(e,n),-1,1)),k=Math.acos(Math.clamp(v.dot(i,s),-1,1)),F=Math.acos(Math.clamp(v.dot(e,t),-1,1)),L=Math.acos(Math.clamp((j*j-T*T-I*I)/(-2*T*I),-1,1)),B=Math.acos(Math.clamp((I*I-T*T-j*j)/(-2*T*j),-1,1));v.sub(e,f,m),v.sub(n,u,m),v.sub(t,d,m),v.cross(o,e,n),v.cross(l,e,t),A?(v.sub(n,A,u),v.transformQuat(n,[0,0,-1],y)):v.sub(n,u,m);let R=v.length(o);R==0?o.set([1,0,0]):v.scale(o,o,1/R),v.normalize(l,l),S.conjugate(w,w),S.setAxisAngle(h,v.transformQuat(c,o,w),L-C),S.setAxisAngle(r,v.transformQuat(c,l,w),F),S.mul(a,a,S.mul(c,h,r)),S.normalize(a,a),S.conjugate(y,y),S.setAxisAngle(p,v.transformQuat(c,o,y),B-k),S.mul(_,_,p),S.normalize(_,_)}}(),Fe=class extends x{init(){this.pos=new Float32Array(3*7),this.p=[this.pos.subarray(0,3),this.pos.subarray(3,6),this.pos.subarray(6,9),this.pos.subarray(9,12),this.pos.subarray(12,15),this.pos.subarray(15,18),this.pos.subarray(18,21)]}update(){let e=this.p;this.root.getTranslationWorld(e[0]),this.middle.getTranslationWorld(e[1]),this.end.getTranslationWorld(e[2]),this.target.getTranslationWorld(e[3]);let n=e[4],i=e[5];this.root.getTranslationLocal(n),this.middle.getTranslationLocal(i),this.helper&&this.helper.getTranslationWorld(e[6]),po(this.root.transformLocal,this.middle.transformLocal,e[0],e[1],e[2],e[3],.01,this.root.transformWorld.subarray(0,4),this.middle.transformWorld.subarray(0,4),this.helper?e[6]:null),this.root.setTranslationLocal(n),this.middle.setTranslationLocal(i),this.root.setDirty(),this.middle.setDirty()}};M(Fe,"TypeName","two-joint-ik-solver"),M(Fe,"Properties",{root:{type:g.Object},middle:{type:g.Object},end:{type:g.Object},target:{type:g.Object},helper:{type:g.Object}});var Be=class extends x{init(){if(!this.material)throw Error("video-texture: material property not set");this.loaded=!1,this.frameUpdateRequested=!0}start(){if(this.video=document.createElement("video"),this.video.src=this.url,this.video.crossOrigin="anonymous",this.video.playsInline=!0,this.video.loop=this.loop,this.video.muted=this.muted,this.video.addEventListener("playing",()=>{this.loaded=!0}),this.autoplay){let e=()=>{this.video.play(),window.removeEventListener("click",e),window.removeEventListener("touchstart",e)};window.addEventListener("click",e),window.addEventListener("touchstart",e)}}applyTexture(){let e=this.material,n=e.shader,i=this.texture=new fe(this.engine,this.video);n==="Flat Opaque Textured"?e.flatTexture=i:n==="Phong Opaque Textured"||n==="Foliage"?e.diffuseTexture=i:n==="Background"?e.texture=i:n==="Physical Opaque Textured"?e.albedoTexture=i:console.error("Shader",n,"not supported by video-texture"),"requestVideoFrameCallback"in this.video?this.video.requestVideoFrameCallback(this.updateVideo.bind(this)):this.video.addEventListener("timeupdate",()=>{this.frameUpdateRequested=!0})}update(e){this.loaded&&this.frameUpdateRequested&&(this.texture?this.texture.update():this.applyTexture(),this.frameUpdateRequested=!1)}updateVideo(){this.frameUpdateRequested=!0,this.video.requestVideoFrameCallback(this.updateVideo.bind(this))}};M(Be,"TypeName","video-texture"),M(Be,"Properties",{url:{type:g.String},material:{type:g.Material},loop:{type:g.Bool,default:!0},autoplay:{type:g.Bool,default:!0},muted:{type:g.Bool,default:!0}});var Le=class extends x{start(){this.components=[],this.getComponents(this.object),this.onXRSessionEnd(),this.engine.onXRSessionStart.push(this.onXRSessionStart.bind(this)),this.engine.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))}getComponents(e){let n=e.getComponents().filter(i=>i.type!=="vr-mode-active-switch");if(this.components=this.components.concat(n),this.affectChildren){let i=e.children;for(let s=0;s<i.length;++s)this.getComponents(i[s])}}setComponentsActive(e){let n=this.components;for(let i=0;i<n.length;++i)n[i].active=e}onXRSessionStart(){this.active&&this.setComponentsActive(this.activateComponents==0)}onXRSessionEnd(){this.active&&this.setComponentsActive(this.activateComponents!=0)}};M(Le,"TypeName","vr-mode-active-switch"),M(Le,"Properties",{activateComponents:{type:g.Enum,values:["in VR","in non-VR"],default:"in VR"},affectChildren:{type:g.Bool,default:!0}});var mo={X:[1,0,0],Y:[0,1,0],Z:[0,0,1]},uo={PositiveX:[1,0,0],NegativeX:[-1,0,0],PositiveY:[0,1,0],NegativeY:[0,-1,0],PositiveZ:[0,0,1],NegativeZ:[0,0,-1]},De=class extends x{meta=null;bones={hips:null,spine:null,chest:null,upperChest:null,neck:null,head:null,leftEye:null,rightEye:null,jaw:null,leftUpperLeg:null,leftLowerLeg:null,leftFoot:null,leftToes:null,rightUpperLeg:null,rightLowerLeg:null,rightFoot:null,rightToes:null,leftShoulder:null,leftUpperArm:null,leftLowerArm:null,leftHand:null,rightShoulder:null,rightUpperArm:null,rightLowerArm:null,rightHand:null,leftThumbMetacarpal:null,leftThumbProximal:null,leftThumbDistal:null,leftIndexProximal:null,leftIndexIntermediate:null,leftIndexDistal:null,leftMiddleProximal:null,leftMiddleIntermediate:null,leftMiddleDistal:null,leftRingProximal:null,leftRingIntermediate:null,leftRingDistal:null,leftLittleProximal:null,leftLittleIntermediate:null,leftLittleDistal:null,rightThumbMetacarpal:null,rightThumbProximal:null,rightThumbDistal:null,rightIndexProximal:null,rightIndexIntermediate:null,rightIndexDistal:null,rightMiddleProximal:null,rightMiddleIntermediate:null,rightMiddleDistal:null,rightRingProximal:null,rightRingIntermediate:null,rightRingDistal:null,rightLittleProximal:null,rightLittleIntermediate:null,rightLittleDistal:null};restPose={};_nodeConstraints=[];_springChains=[];_sphereColliders=[];_capsuleColliders=[];_firstPersonAnnotations=[];_lookAt=null;_initialized=!1;init(){this._tempV3=v.create(),this._tempV3A=v.create(),this._tempV3B=v.create(),this._tempQuat=S.create(),this._tempQuatA=S.create(),this._tempQuatB=S.create(),this._tempMat4A=re.create(),this._tempQuat2=U.create(),this._tailToShape=v.create(),this._headToTail=v.create(),this._inertia=v.create(),this._stiffness=v.create(),this._external=v.create(),this._rightVector=v.set(v.create(),1,0,0),this._upVector=v.set(v.create(),0,1,0),this._forwardVector=v.set(v.create(),0,0,1),this._identityQuat=S.identity(S.create()),this._rad2deg=180/Math.PI}start(){if(!this.src){console.error("vrm: src property not set");return}this.engine.scene.append(this.src,{loadGltfExtensions:!0}).then(({root:e,extensions:n})=>{e.children.forEach(i=>i.parent=this.object),this._initializeVrm(n),e.destroy()})}_initializeVrm(e){if(this._initialized)throw Error("VRM component has already been initialized");let n=e.root.VRMC_vrm;if(!n)throw Error("Missing VRM extensions");if(n.specVersion!=="1.0")throw Error(`Unsupported VRM version, only 1.0 is supported, but encountered '${n.specVersion}'`);this.meta=n.meta,this._parseHumanoid(n.humanoid,e),n.firstPerson&&this._parseFirstPerson(n.firstPerson,e),n.lookAt&&this._parseLookAt(n.lookAt),this._findAndParseNodeConstraints(e);let i=e.root.VRMC_springBone;i&&this._parseAndInitializeSpringBones(i,e),this._initialized=!0}_parseHumanoid(e,n){for(let i in e.humanBones){if(!(i in this.bones)){console.warn(`Unrecognized bone '${i}'`);continue}let s=e.humanBones[i].node,o=n.idMapping[s];this.bones[i]=this.engine.wrapObject(o),this.restPose[i]=S.copy(S.create(),this.bones[i].rotationLocal)}}_parseFirstPerson(e,n){for(let i of e.meshAnnotations){let s={node:this.engine.wrapObject(n.idMapping[i.node]),firstPerson:!0,thirdPerson:!0};switch(i.type){case"firstPersonOnly":s.thirdPerson=!1;break;case"thirdPersonOnly":s.firstPerson=!1;break;case"both":break;case"auto":console.warn("First person mesh annotation type 'auto' is not supported, treating as 'both'!");break;default:console.error(`Invalid mesh annotation type '${i.type}'`);break}this._firstPersonAnnotations.push(s)}}_parseLookAt(e){if(e.type!=="bone"){console.warn(`Unsupported lookAt type '${e.type}', only 'bone' is supported`);return}let n=i=>({inputMaxValue:i.inputMaxValue,outputScale:i.outputScale});this._lookAt={offsetFromHeadBone:e.offsetFromHeadBone||[0,0,0],horizontalInner:n(e.rangeMapHorizontalInner),horizontalOuter:n(e.rangeMapHorizontalOuter),verticalDown:n(e.rangeMapVerticalDown),verticalUp:n(e.rangeMapVerticalUp)}}_findAndParseNodeConstraints(e){let n=i=>{let s=e.node[i.objectId];if(s&&"VRMC_node_constraint"in s){let l=s.VRMC_node_constraint.constraint,c,h;if("roll"in l?(c="roll",h=mo[l.roll.rollAxis]):"aim"in l?(c="aim",h=uo[l.aim.aimAxis]):"rotation"in l&&(c="rotation"),c){let p=this.engine.wrapObject(e.idMapping[l[c].source]);this._nodeConstraints.push({type:c,source:p,destination:i,axis:h,weight:l[c].weight,destinationRestLocalRotation:S.copy(S.create(),i.rotationLocal),sourceRestLocalRotation:S.copy(S.create(),p.rotationLocal),sourceRestLocalRotationInv:S.invert(S.create(),p.rotationLocal)})}else console.warn("Unrecognized or invalid VRMC_node_constraint, ignoring it")}for(let o of i.children)n(o)};n(this.object)}_parseAndInitializeSpringBones(e,n){let i=(e.colliders||[]).map((o,l)=>{let c="capsule"in o.shape?"capsule":"sphere";return{id:l,object:this.engine.wrapObject(n.idMapping[o.node]),shape:{isCapsule:c==="capsule",radius:o.shape[c].radius,offset:o.shape[c].offset,tail:o.shape[c].tail},cache:{head:v.create(),tail:v.create()}}});this._sphereColliders=i.filter(o=>!o.shape.isCapsule),this._capsuleColliders=i.filter(o=>o.shape.isCapsule);let s=(e.colliderGroups||[]).map(o=>({name:o.name,colliders:o.colliders.map(l=>i[l])}));for(let o of e.springs){let l=[];for(let h of o.joints){let p={hitRadius:0,stiffness:1,gravityPower:0,gravityDir:[0,-1,0],dragForce:.5,node:null,state:null};Object.assign(p,h),p.node=this.engine.wrapObject(n.idMapping[p.node]),l.push(p)}let c=(o.colliderGroups||[]).flatMap(h=>s[h].colliders);this._springChains.push({name:o.name,center:o.center?this.engine.wrapObject(n.idMapping[o.center]):null,joints:l,sphereColliders:c.filter(h=>!h.shape.isCapsule),capsuleColliders:c.filter(h=>h.shape.isCapsule)})}for(let o of this._springChains)for(let l=0;l<o.joints.length-1;++l){let c=o.joints[l],h=o.joints[l+1],p=c.node.getTranslationWorld(v.create()),r=h.node.getTranslationWorld(v.create()),a=v.subtract(this._tempV3A,p,r),_={prevTail:r,currentTail:v.copy(v.create(),r),initialLocalRotation:S.copy(S.create(),c.node.rotationLocal),initialLocalTransformInvert:U.invert(U.create(),c.node.transformLocal),boneAxis:v.normalize(v.create(),h.node.getTranslationLocal(this._tempV3)),boneLength:Math.max(.01,v.length(a)),prevTailCenter:null,currentTailCenter:null};o.center&&(_.prevTailCenter=o.center.transformPointInverseWorld(v.create(),r),_.currentTailCenter=v.copy(v.create(),r)),c.state=_}}update(e){this._initialized&&(this._resolveLookAt(),this._resolveConstraints(),this._updateSpringBones(e))}_rangeMap(e,n){let i=e.inputMaxValue,s=e.outputScale;return Math.min(n,i)/i*s}_resolveLookAt(){if(!this._lookAt||!this.lookAtTarget)return;let e=this.bones.head.transformPointWorld(this._tempV3A,this._lookAt.offsetFromHeadBone),n=this.lookAtTarget.getTranslationWorld(this._tempV3B),i=v.sub(this._tempV3A,n,e);v.normalize(i,i),this.bones.head.parent.transformVectorInverseWorld(i);let s=v.dot(i,this._forwardVector),o=v.dot(i,this._rightVector),l=Math.atan2(o,s)*this._rad2deg,c=Math.sqrt(o*o+s*s),h=v.dot(i,this._upVector),p=Math.atan2(-h,c)*this._rad2deg;if(p>0?p=this._rangeMap(this._lookAt.verticalDown,p):p=-this._rangeMap(this._lookAt.verticalUp,-p),this.bones.leftEye){let r=l;r>0?r=this._rangeMap(this._lookAt.horizontalInner,r):r=-this._rangeMap(this._lookAt.horizontalOuter,-r);let a=S.fromEuler(this._tempQuatA,p,r,0);this.bones.leftEye.rotationLocal=S.multiply(a,this.restPose.leftEye,a)}if(this.bones.rightEye){let r=l;r>0?r=this._rangeMap(this._lookAt.horizontalOuter,r):r=-this._rangeMap(this._lookAt.horizontalInner,-r);let a=S.fromEuler(this._tempQuatA,p,r,0);this.bones.rightEye.rotationLocal=S.multiply(a,this.restPose.rightEye,a)}}_resolveConstraints(){for(let e of this._nodeConstraints)this._resolveConstraint(e)}_resolveConstraint(e){let n=e.destinationRestLocalRotation,i=e.sourceRestLocalRotationInv,s=S.identity(this._tempQuatA);switch(e.type){case"roll":{let o=S.multiply(this._tempQuatA,i,e.source.rotationLocal),l=S.multiply(this._tempQuatA,e.sourceRestLocalRotation,o);S.mul(l,l,i);let c=S.invert(this._tempQuatB,n),h=S.multiply(this._tempQuatB,c,l);S.multiply(h,h,n);let p=v.transformQuat(this._tempV3A,e.axis,h),r=S.rotationTo(this._tempQuatA,e.axis,p);S.mul(s,n,S.invert(this._tempQuat,r)),S.mul(s,s,h)}break;case"aim":{let o=e.destination.parent.rotationWorld,l=v.transformQuat(this._tempV3A,e.axis,n);v.transformQuat(l,l,o);let c=e.source.getTranslationWorld(this._tempV3B);v.sub(c,c,e.destination.getTranslationWorld(this._tempV3)),v.normalize(c,c);let h=S.rotationTo(this._tempQuatA,l,c);S.mul(s,S.invert(this._tempQuat,o),h),S.mul(s,s,o),S.mul(s,s,n)}break;case"rotation":{let o=S.mul(s,i,e.source.rotationLocal);S.mul(s,n,o)}break}S.slerp(s,n,s,e.weight),e.destination.rotationLocal=s}_updateSpringBones(e){this._sphereColliders.forEach(({object:n,shape:i,cache:s})=>{let o=v.copy(s.head,i.offset);n.transformVectorWorld(o),v.add(s.head,n.getTranslationWorld(this._tempV3),o)}),this._capsuleColliders.forEach(({object:n,shape:i,cache:s})=>{let o=n.getTranslationWorld(this._tempV3A),l=v.copy(s.head,i.offset);n.transformVectorWorld(l),v.add(s.head,o,l);let c=v.copy(s.tail,i.tail);n.transformVectorWorld(c),v.add(s.tail,o,c)}),this._springChains.forEach(n=>{for(let i=0;i<n.joints.length-1;++i){let s=n.joints[i],o=s.node.parent?s.node.parent.rotationWorld:this._identityQuat,l=this._inertia;n.center?(v.sub(l,s.state.currentTailCenter,s.state.prevTailCenter),n.center.transformVectorWorld(l)):v.sub(l,s.state.currentTail,s.state.prevTail),v.scale(l,l,1-s.dragForce);let c=v.copy(this._stiffness,s.state.boneAxis);v.transformQuat(c,c,s.state.initialLocalRotation),v.transformQuat(c,c,o),v.scale(c,c,e*s.stiffness);let h=v.scale(this._external,s.gravityDir,e*s.gravityPower),p=v.copy(this._tempV3A,s.state.currentTail);v.add(p,p,l),v.add(p,p,c),v.add(p,p,h);let r=s.node.getTranslationWorld(this._tempV3B);v.sub(p,p,r),v.normalize(p,p),v.scaleAndAdd(p,r,p,s.state.boneLength);for(let{shape:m,cache:u}of n.sphereColliders){let f=this._tailToShape,d=u.head;f=v.sub(f,p,d);let b=m.radius+s.hitRadius,w=v.length(f)-b;w<0&&(v.normalize(f,f),v.scaleAndAdd(p,p,f,-w),v.sub(p,p,r),v.normalize(p,p),v.scaleAndAdd(p,r,p,s.state.boneLength))}for(let{shape:m,cache:u}of n.capsuleColliders){let f=this._tailToShape,d=u.head,b=u.tail;f=v.sub(f,p,d);let w=v.sub(this._headToTail,b,d),y=v.dot(w,f);v.squaredLength(w)<=y?v.sub(f,p,b):y>0&&(v.scale(w,w,y/v.squaredLength(w)),v.sub(f,f,w));let A=m.radius+s.hitRadius,T=v.length(f)-A;T<0&&(v.normalize(f,f),v.scaleAndAdd(p,p,f,-T),v.sub(p,p,r),v.normalize(p,p),v.scaleAndAdd(p,r,p,s.state.boneLength))}v.copy(s.state.prevTail,s.state.currentTail),v.copy(s.state.currentTail,p),n.center&&(v.copy(s.state.prevTailCenter,s.state.currentTailCenter),v.copy(s.state.currentTailCenter,p),n.center.transformPointInverseWorld(s.state.currentTailCenter)),s.node.parent.transformPointInverseWorld(p);let a=U.fromTranslation(this._tempQuat2,p);U.multiply(a,s.state.initialLocalTransformInvert,a),U.getTranslation(p,a),v.normalize(p,p);let _=S.rotationTo(this._tempQuatA,s.state.boneAxis,p);s.node.rotationLocal=S.mul(this._tempQuatA,s.state.initialLocalRotation,_)}})}set firstPerson(e){this._firstPersonAnnotations.forEach(n=>{let i=e==n.firstPerson||e!=n.thirdPerson;n.node.getComponents("mesh").forEach(s=>{s.active=i})})}};M(De,"TypeName","vrm"),M(De,"Properties",{src:{type:g.String},lookAtTarget:{type:g.Object}});var Ne=class extends x{init(){this.up=!1,this.right=!1,this.down=!1,this.left=!1,window.addEventListener("keydown",this.press.bind(this)),window.addEventListener("keyup",this.release.bind(this))}start(){this.headObject=this.headObject||this.object}update(){let e=[0,0,0];this.up&&(e[2]-=1),this.down&&(e[2]+=1),this.left&&(e[0]-=1),this.right&&(e[0]+=1),v.normalize(e,e),e[0]*=this.speed,e[2]*=this.speed,v.transformQuat(e,e,this.headObject.transformWorld),this.object.translate(e)}press(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!0:e.keyCode===39||e.keyCode===68?this.right=!0:e.keyCode===40||e.keyCode===83?this.down=!0:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!0)}release(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!1:e.keyCode===39||e.keyCode===68?this.right=!1:e.keyCode===40||e.keyCode===83?this.down=!1:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!1)}};M(Ne,"TypeName","wasd-controls"),M(Ne,"Properties",{speed:{type:g.Float,default:.1},headObject:{type:g.Object}});var Zt=class{constructor(){this.PREFAB_UNAME_KEY="pun";this._prefabs=new Map}registerPrefab(e){let n=e.getPrefabUniqueName();if(this._prefabs.has(n))throw new Error("Can't register the same prefab twice: "+n);this._prefabs.set(n,e),e.object[this.PREFAB_UNAME_KEY]=n}getPrefab(e){return this._prefabs.has(e.TypeName)?this._prefabs.get(e.TypeName):null}getPrefabByName(e){return this._prefabs.has(e)?this._prefabs.get(e):null}removePrefab(e){this._prefabs.has(e.TypeName)&&this._prefabs.delete(e.TypeName)}},V=new Zt;function ze(){return WL.scene}function ti(){return WL.onXRSessionStart}var st=class{constructor(e){this._layerSize=e,this._layerData=new Array(this._layerSize);for(let n=0;n<this._layerSize;++n)this._layerData[n]=new Array(this._layerSize)}};var he=class{get gridSize(){return this._gridSize}get layerCount(){return this._layerCount}get cellSize(){return this._cellSize}constructor(e,n,i){this._gridSize=e,this._layerCount=n,this._cellSize=i,this._gridOffset=this._gridSize*this._cellSize/2,this._gridData=new Array(this._layerCount);for(let s=0;s<this._layerCount;++s)this._gridData[s]=new st(this._gridSize);console.log(this._gridData)}getCellPositionVec3(e){return this.getCellPosition(e[0],e[1],e[2])}getCellPosition(e,n,i){let s=v.create();return s[1]=n*this._cellSize,s[0]=e*this._cellSize-this._gridOffset,s[2]=i*this._cellSize-this._gridOffset,s}getCellIndices(e,n,i){let s=v.create();return s[0]=Math.round((e+this._gridOffset)/this._cellSize),s[1]=Math.floor(n/this._cellSize),s[2]=Math.round((i+this._gridOffset)/this._cellSize),s}};var Kt=class{get grid(){return this._grid}constructor(e,n,i){this._grid=new he(e,n,i)}},pe=new Kt(30,10,.25);var K=class{static setTag(e,n){e[this.tagKey]=n}static hasTag(e,n){return!(!e[this.tagKey]&&e[this.tagKey]!==n)}static getTag(e){return e[this.tagKey]}};K.tagKey="TAG";var J=class extends x{start(){K.setTag(this.object,parseInt(this.tag))}};J.TypeName="tag-component",J.Properties={tag:{type:g.Enum,values:[0 .toString(),2 .toString()]}};var Z=class extends x{start(){this._scene=ze(),this._cellSize=pe.grid.cellSize}createPrevisObject(){this._previsObject=this._scene.addObject(null),this._previsObject.translateWorld([0,-5,0]);let n=this._scene.addObject(this._previsObject);n.translateObject([0,this._cellSize/2,0]),n.addComponent("mesh",{mesh:this.previsMesh,material:this.previsMat})}createBlock(n,i,s){let o=this._scene.addObject(s);o[V.PREFAB_UNAME_KEY]=this.getPrefabUniqueName(),o.translateWorld(n);let l=this._scene.addObject(o);l.resetRotation(),l.translateObject([0,this._cellSize/2,0]),l.rotate(this._previsObject.rotationWorld);let c=this.finalMat.clone();c.albedoTexture=i.albedoTexture,c.normalTexture=i.normalTexture,l.addComponent("mesh",{mesh:this.finalMesh,material:c}),l.addComponent(J,{tag:1});let h=this._cellSize/2+.001;return l.addComponent("collision",{collider:mt.AxisAlignedBox,extents:[h,h,h],group:1}),o}updatePrevisPosition(n){this._previsObject.setTranslationWorld(n);let i=v.create();this._previsObject.getTranslationWorld(i)}updatePrevisRotation(n,i){this._previsObject.rotateAxisAngleDeg([1,0,0],n),this._previsObject.rotateAxisAngleDeg([0,1,0],i)}setPrevisRotation(n){this._previsObject.resetRotation(),this._previsObject.rotationWorld=n}updatePrevisColor(n){this.previsMat.diffuseColor=n}};Z.TypeName="",Z.Properties={finalMesh:{type:g.Mesh},previsMesh:{type:g.Mesh},finalMat:{type:g.Material},previsMat:{type:g.Material}};var en=class extends Z{getPrefabUniqueName(){return en.TypeName}start(){super.start(),V.registerPrefab(this),this.createPrevisObject()}},se=en;se.TypeName="block-slope-prefab",se.Properties={finalMesh:{type:g.Mesh},previsMesh:{type:g.Mesh},finalMat:{type:g.Material},previsMat:{type:g.Material}};var tn=class{constructor(){this._currentPrefab=null,this._currentColor=[1,1,1,1],this.test()}test(){return pn(this,null,function*(){yield new Promise(e=>setTimeout(e,1e3)),this._currentPrefab=V.getPrefab(se),this._currentPrefab.updatePrevisColor(this._currentColor)})}setBuildContainer(e){this._buildContainer=e}setCurrentPrevizPosition(e){this._currentPrefab.updatePrevisPosition(e)}setPrefab(e){this._currentPrefab=e}setColor(e){this._currentColor=e,this._currentPrefab.updatePrevisColor(this._currentColor)}setTexture(e){this._currentTexture=e}addCurrentPrevizRotation(e,n){this._currentPrefab.updatePrevisRotation(e,n)}instanciatePrefabAt(e){this._currentPrefab.createBlock(e,this._currentTexture,this._buildContainer)}getCurrentBuildData(){return this._buildContainer.getComponent(ne).generateBuildData()}loadBuild(e){this._buildContainer.getComponent(ne).loadBuildData(e)}},D=new tn;var ne=class extends x{init(){D.setBuildContainer(this.object)}generateBuildData(){let e=new Array,n=this.object.children;for(let i of n){let s=i.children[0],o=s.getComponent("mesh"),l=v.create();i.getTranslationWorld(l);let c=o.material.diffuseColor,h=q.fromValues(c[0],c[1],c[2],c[3]);e.push({type:i[V.PREFAB_UNAME_KEY],color:h,position:l,rotation:s.rotationWorld})}return e}loadBuildData(e){this.clearBlocksInScene();let n;for(let i of e){n=V.getPrefabByName(i.type),n.setPrevisRotation(i.rotation),D.setPrefab(n);let s=new Float32Array([i.color[0],i.color[1],i.color[2],i.color[3]]);D.setColor(s),D.instanciatePrefabAt(i.position)}}clearBlocksInScene(){for(let e of this.object.children)e.destroy()}};ne.TypeName="build-container",ne.Properties={};var Ue=class extends x{start(){this._grid=new he(2,10,.5);let n=this.debugVisualObject.getComponent("mesh"),i=ze(),s=25/2;for(let o=0;o<this._grid.layerCount;++o)for(let l=0;l<this._grid.gridSize;++l)for(let c=0;c<this._grid.gridSize;++c){let h=i.addObject(this.object);h.addComponent("mesh",{mesh:n.mesh,material:n.material}),h.resetTranslation(),h.translate(this._grid.getCellPosition(l,o,c));let p=this._grid.cellSize;h.scale([p,p,p])}}};Ue.TypeName="grid-debug-component",Ue.Properties={debugVisualObject:{type:g.Object,default:null}};var ot=class{get isPressed(){return this._isPressed}get wasPressed(){return this._wasPressed}constructor(e,n){this._gamepadButton=e,this._index=n,this._isPressed=!1,this._wasPressed=!1,this._onPressedEvent=new Array,this._onReleasedEvent=new Array}update(){if(this._isPressed=this._gamepadButton.pressed,this._isPressed&&!this._wasPressed){for(let e of this._onPressedEvent)e(this);this._wasPressed=!0}if(!this._isPressed&&this._wasPressed){for(let e=0;e<this._onReleasedEvent.length;e++)this._onReleasedEvent[e](this);this._wasPressed=!1}}addPressedListener(e){return this._onPressedEvent.push(e)-1}addReleasedListener(e){return this._onReleasedEvent.push(e)-1}removePressedListener(e){this._onPressedEvent.splice(e,1)}removeReleasedListener(e){this._onReleasedEvent.splice(e,1)}clearPressedListeners(){this._onPressedEvent=new Array}clearReleasedListeners(){this._onReleasedEvent=new Array}};var at=class{constructor(e,n){this._joystickTriggerValue=.5;this.setup(e,n)}get hand(){return this._hand}get joystickXValue(){return this._gamepad.axes[2]}get joystickYValue(){return this._gamepad.axes[3]}get joystickXJustMoved(){return this._joystickXJustMoved}get joystickYJustMoved(){return this._joystickYJustMoved}setup(e,n){this._gamepad=e,this._hand=n,this.initButtons()}update(){for(let e of this._buttons.keys())this._buttons.get(e).update();this._joystickXIsMoving=Math.abs(this._gamepad.axes[2])>this._joystickTriggerValue,this._joystickYIsMoving=Math.abs(this._gamepad.axes[3])>this._joystickTriggerValue,this._joystickXJustMoved=this._joystickXIsMoving&&!this._joystickXWasMoving,this._joystickYJustMoved=this._joystickYIsMoving&&!this._joystickYWasMoving,this._joystickXWasMoving=this._joystickXIsMoving,this._joystickYWasMoving=this._joystickYIsMoving}getButton(e){return this._buttons.get(e)}initButtons(){let e=[0,1,4,5];this._buttons!=null&&(this._buttons.clear(),this._buttons=null),this._buttons=new Map;for(let n=0;n<e.length;++n){let i=e[n],s=this._gamepad.buttons[i],o=new ot(s,i);this._buttons.set(i,o)}}};var oe=class extends x{get isPointing(){return this._isPointing}get currentHitPosition(){return this._currentHitPosition}get currentHitObject(){return this._currentHitObject}start(){this._scene=ze(),this._rayMesh=this.rayVisualObject.getComponent("mesh"),this._rayMesh.material.diffuseColor=q.create(),this.rayVisualObject.translate([0,0,-.5]),this._origin=[0,0,0],this._direction=[0,0,0]}update(n){this.rayOrigin.getTranslationWorld(this._origin),this.rayOrigin.getForward(this._direction);let i=this._scene.rayCast(this._origin,this._direction,1);i.hitCount>0?(this._isPointing=!0,this._currentHitPosition=v.clone(i.locations[0]),this._currentHitObject=i.objects[0],this.processRayStretch(),this.cursorHitVisualObject.setTranslationWorld(this._currentHitPosition)):(this._isPointing=!1,this.rayObject.resetScaling(),this.cursorHitVisualObject.setTranslationWorld([0,-5,0]))}processRayStretch(){let n=v.create();n[0]=this._origin[0],n[1]=this._origin[1],n[2]=this._origin[2];let i=v.distance(n,this._currentHitPosition);this.rayObject.resetScaling(),this.rayObject.scale([1,i-.05,1])}};oe.TypeName="pointer-ray",oe.Properties={rayOrigin:{type:g.Object},rayObject:{type:g.Object},rayVisualObject:{type:g.Object},cursorHitVisualObject:{type:g.Object}};var ae=class extends x{init(){this._interactCallbacks=new Array}addInteractCallback(n){this._interactCallbacks.push(n)}removeInteractCallback(n){let i=this._interactCallbacks.indexOf(n);this._interactCallbacks.splice(i,1)}};ae.TypeName="ui-element-base",ae.Properties={};var N=class extends ae{start(){this._meshComponent=this.object.getComponent("mesh"),this._meshMaterial=this._meshComponent.material.clone(),this._meshComponent.material=this._meshMaterial,this.textObject!=null&&(this._textComponent=this.textObject.getComponent("text")),this.object.addComponent(J,{tag:2})}interact(){console.log("Button clicked: "+this.object.name);for(let n of this._interactCallbacks)n();this.visualFeedbackEnabled&&this.processVisualFeedback()}processVisualFeedback(){this._meshMaterial.color=[.635,.73,1,1],setTimeout(()=>{this._meshMaterial.color=[1,1,1,1]},100)}};N.TypeName="ui-button",N.Properties={textObject:{type:g.Object},visualFeedbackEnabled:{type:g.Bool,default:!0}};var nn=class{constructor(){this._soundEmitters=new Map}registerEmitter(e){if(this._soundEmitters.has(e.emitterType)){console.warn("Only one emitter can be register by type");return}this._soundEmitters.set(e.emitterType,e)}playAt(e,n){if(!this._soundEmitters.has(e)){console.warn(`Can't play sound from emitter ${e}. It doesn't exist`);return}this._soundEmitters.get(e).playAt(n)}},me=new nn;var Ve=class extends x{start(){if(this.inputObject===null)throw new Error("Input Object must be defined");if(this._inputComponent=this.inputObject.getComponent("input"),this._hand=this._inputComponent.handedness,this.pointerRay===null)throw new Error("Pointer Ray Object must be defined");this._pointerRayComponent=this.pointerRay.getComponent(oe),ti().push(this.onXrSessionStart.bind(this))}update(n){if(this._xrGamepad!=null){if(this._xrGamepad.update(),!this._pointerRayComponent.isPointing){D.setCurrentPrevizPosition([0,-5,0]);return}switch(K.getTag(this._pointerRayComponent.currentHitObject)){case 1:case 0:{let i=this._pointerRayComponent.currentHitPosition,s=pe.grid.getCellIndices(i[0],i[1],i[2]),o=pe.grid.getCellPositionVec3(s);this._xrGamepad.joystickXJustMoved&&(D.addCurrentPrevizRotation(0,this._xrGamepad.joystickXValue>0?90:-90),me.playAt(2,this._pointerRayComponent.currentHitPosition)),D.setCurrentPrevizPosition(o);break}case 2:{D.setCurrentPrevizPosition([0,-5,0]);break}}}}onXrSessionStart(n){this.inputSourcesSetup(n)}inputSourcesSetup(n){for(let i=0;i<n.inputSources.length;++i){let s=n.inputSources[i];s.handedness===this._hand&&(console.log("Setup hand : "+s.handedness+" For XR Controller "+this._hand),this.setupXrGamepad(s.gamepad))}n.addEventListener("inputsourceschange",this.onXrInputSourceChangeHandler.bind(this))}setupXrGamepad(n){this._xrGamepad=new at(n,this._hand),this._xrGamepad.getButton(0).addPressedListener(this.onPlacementTriggerPressed.bind(this)),this._xrGamepad.getButton(5).addPressedListener(this.onDeleteButtonPressed.bind(this))}onXrInputSourceChangeHandler(n){for(let i=0;i<n.added.length;++i){let s=n.added[i];s.handedness===this._hand&&(console.log("Setup hand : "+s.handedness+" For XR Controller "+this._hand),this.setupXrGamepad(s.gamepad))}}onPlacementTriggerPressed(){if(this._pointerRayComponent.currentHitObject)switch(K.getTag(this._pointerRayComponent.currentHitObject)){case 1:case 0:{let n=this._pointerRayComponent.currentHitPosition,i=pe.grid.getCellIndices(n[0],n[1],n[2]),s=pe.grid.getCellPositionVec3(i);D.instanciatePrefabAt(s),me.playAt(1,this._pointerRayComponent.currentHitPosition);break}case 2:{let n=this._pointerRayComponent.currentHitObject.getComponent(N);n&&(n.interact(),me.playAt(0,this._pointerRayComponent.currentHitPosition));break}}}onDeleteButtonPressed(){if(this._pointerRayComponent.currentHitObject)switch(K.getTag(this._pointerRayComponent.currentHitObject)){case 1:{this._pointerRayComponent.currentHitObject.parent.destroy(),me.playAt(3,this._pointerRayComponent.currentHitPosition);break}}}};Ve.TypeName="XR-Controller",Ve.Properties={pointerMode:{type:g.Int,default:0},inputObject:{type:g.Object,default:null},pointerRay:{type:g.Object,default:null}};var rn=class extends Z{getPrefabUniqueName(){return rn.TypeName}start(){super.start(),V.registerPrefab(this),this.createPrevisObject()}},He=rn;He.TypeName="block-prefab",He.Properties={finalMesh:{type:g.Mesh},previsMesh:{type:g.Mesh},finalMat:{type:g.Material},previsMat:{type:g.Material}};var sn=class extends Z{getPrefabUniqueName(){return sn.TypeName}start(){super.start(),V.registerPrefab(this),this.createPrevisObject()}},We=sn;We.TypeName="block-stair-prefab",We.Properties={finalMesh:{type:g.Mesh},previsMesh:{type:g.Mesh},finalMat:{type:g.Material},previsMat:{type:g.Material}};var Pt="SAVE_DATA",on=class{constructor(){if(!(typeof window=="undefined"||!window.localStorage)){if(this._localStorage=window.localStorage,this._localStorage.getItem(Pt)!==null){this.processExistingSaveData();return}this.createSaveData()}}processExistingSaveData(){this._saveData=JSON.parse(this._localStorage.getItem(Pt)),console.log(this._saveData)}createSaveData(){this._saveData={saves:new Array},this._localStorage.setItem(Pt,JSON.stringify(this._saveData))}getSavesEntries(){return this._saveData.saves}createNewSaveEntry(e){return{name:e,userPref:{color:[1,1,1],block:""},blocks:new Array}}createOrUpdateSaveEntry(e){let n=this._saveData.saves;for(let i=0;i<n.length;i++)if(n[i].name==e.name){n[i]=e;return}this._saveData.saves.push(e)}removeSaveEntry(e){let n=this._saveData.saves;for(let i=0;i<n.length;i++)if(n[i].name==e.name){n.splice(i,1);return}}flushSaves(){this._localStorage.setItem(Pt,JSON.stringify(this._saveData))}},ie=new on;var H=class extends x{get emitterType(){return this._emitterType}init(){this.onInit(),me.registerEmitter(this)}start(){this._audioSource=this.object.getComponent("howler-audio-source")}playAt(n){this.object.setTranslationWorld(n),this._audioSource.play()}};H.TypeName="sound-emitter-base",H.Properties={};var lt=class extends H{onInit(){this._emitterType=0}};lt.TypeName="sound-emitter-click";var ct=class extends H{onInit(){this._emitterType=3}};ct.TypeName="sound-emitter-destroy";var _t=class extends H{onInit(){this._emitterType=1}};_t.TypeName="sound-emitter-place";var ht=class extends H{onInit(){this._emitterType=2}};ht.TypeName="sound-emitter-rotate";var an=class{constructor(e,n,i,s){this._value=[e,n,i,s]}static createRGB(e,n,i){return new an(e,n,i,1)}asArray(){return this._value}},W=an;W.COLOR_NORMAL=q.fromValues(76/255,106/255,134/255,1),W.COLOR_ACTIVE=q.fromValues(255/255,162/255,56/255,1),W.COLOR_TINT_NORMAL=q.fromValues(1,1,1,1),W.COLOR_TINT_ACTIVE=q.fromValues(.8,.8,.8,1);var le=class extends x{init(){this._buttons=new Map}registerButton(n){this._buttons.set(n.object.name,n)}notifyInteraction(n){let i=this._buttons.keys();for(let s of i)this._buttons.get(s).setVisualColor(W.COLOR_TINT_NORMAL);n.setVisualColor(W.COLOR_TINT_ACTIVE)}};le.TypeName="block-selection-panel",le.Properties={};var Xe=class extends x{start(){this._prefabComponent=V.getPrefabByName(this.prefab[V.PREFAB_UNAME_KEY]),this._buttonComponent=this.object.getComponent(N),this._buttonComponent.addInteractCallback(this.onInteractHandler.bind(this)),this._mesh=this.object.getComponent("mesh");let n=this._mesh.material;this._mesh.material=n.clone(),this._parent=this.object.parent.getComponent(le),this._parent.registerButton(this)}onActivate(){this._prefabComponent=V.getPrefabByName(this.prefab[V.PREFAB_UNAME_KEY])}setVisualColor(n){this._mesh.material.color=n}onInteractHandler(){D.setPrefab(this._prefabComponent),this._parent.notifyInteraction(this)}};Xe.TypeName="block-selector-interactible",Xe.Properties={prefab:{type:g.Object}};var qe=class extends x{start(){this._color=new Float32Array([this.red,this.green,this.blue,1]),this._buttonComponent=this.object.getComponent(N),this._buttonComponent.addInteractCallback(this.onInteractHandler.bind(this))}onInteractHandler(){D.setColor(this._color)}};qe.TypeName="color-selector-interactible",qe.Properties={red:{type:g.Float},green:{type:g.Float},blue:{type:g.Float}};var ln=class{get texturesUniqueID(){return Array.from(this._texturesInformation.keys())}constructor(){this._texturesInformation=new Map}register(e){return this._texturesInformation.has(e.uniqueID)?!1:(this._texturesInformation.set(e.uniqueID,e),console.log("New Texture information registered ",e.uniqueID),!0)}getTextureInformation(e){var n;return(n=this._texturesInformation.get(e))!=null?n:null}},ni=new ln;var ce=class extends x{get uniqueID(){return this.uid}get albedoTexture(){return this.albedo}get normalTexture(){return this.normal}start(){ni.register(this)}};ce.TypeName="texture-information",ce.Properties={uid:{type:g.String},albedo:{type:g.Texture,default:null},normal:{type:g.Texture,default:null}};var Ye=class extends x{start(){if(!this.textureInfoObject){console.error("Object must be set to initialize the button ",this.object.name);return}this._texture=this.textureInfoObject.getComponent(ce),this._buttonComponent=this.object.getComponent(N),this._buttonComponent.addInteractCallback(this.onInteractHandler.bind(this))}onInteractHandler(){D.setTexture(this._texture)}};Ye.TypeName="texture-selector-interactible",Ye.Properties={textureInfoObject:{type:g.Object,default:null}};var Ge=class extends x{start(){this._loadButton=this.loadButtonObj.getComponent(N),this._newButton=this.newButtonObj.getComponent(N),this._nextButton=this.nextButtonObj.getComponent(N),this._saveButton=this.saveButtonObj.getComponent(N),this._removeButton=this.removeButtonObj.getComponent(N),this._loadButton.addInteractCallback(this.onLoadButtonClicked.bind(this)),this._newButton.addInteractCallback(this.onNewButtonPressed.bind(this)),this._nextButton.addInteractCallback(this.onNextButtonPressed.bind(this)),this._saveButton.addInteractCallback(this.onSaveButtonPressed.bind(this)),this._removeButton.addInteractCallback(this.onRemoveButtonPressed.bind(this)),this._saveCount=this.saveCountObj.getComponent("text"),this._saveName=this.saveNameObj.getComponent("text"),this._saveEntries=ie.getSavesEntries(),this._currentSaveIndex=this._saveEntries.length<1?-1:0,this._saveCount.text="Saves: "+this._saveEntries.length,this._saveName.text=this._currentSaveIndex<0?"No save available":this._saveEntries[0].name,this.loadBlankSave()}onLoadButtonClicked(){this._currentSaveIndex<0||(this._currentBuildData=this._saveEntries[this._currentSaveIndex],console.log(this._currentBuildData),D.loadBuild(this._currentBuildData.blocks))}onNewButtonPressed(){this.setCurrentSelectedSave(-1),D.loadBuild(this._currentBuildData.blocks)}onNextButtonPressed(){this._currentSaveIndex++,this._currentSaveIndex>this._saveEntries.length-1&&(this._currentSaveIndex=0),this.setCurrentSelectedSave(this._currentSaveIndex),this._saveName.text=this._currentSaveIndex<0?"No save available":this._currentBuildData.name}onSaveButtonPressed(){this._currentBuildData.blocks=D.getCurrentBuildData(),ie.createOrUpdateSaveEntry(this._currentBuildData),ie.flushSaves(),this._saveEntries=ie.getSavesEntries(),this._currentSaveIndex=this._currentSaveIndex<0?0:this._currentSaveIndex,this._saveCount.text="Saves: "+this._saveEntries.length,this._saveName.text=this._currentSaveIndex<0?"No save available":this._saveEntries[this._currentSaveIndex].name}onRemoveButtonPressed(){if(this._currentSaveIndex<0)return;let n=this._saveEntries[this._currentSaveIndex];if(n.name==this._currentBuildData.name&&(this.setCurrentSelectedSave(-1),D.loadBuild(this._currentBuildData.blocks)),ie.removeSaveEntry(n),ie.flushSaves(),this._saveEntries=ie.getSavesEntries(),this._saveEntries.length<1)this._currentSaveIndex=-1;else{let i=this._currentSaveIndex>this._saveEntries.length-1;this._currentSaveIndex=i?0:this._currentSaveIndex}this._saveCount.text="Saves: "+this._saveEntries.length,this._saveName.text=this._currentSaveIndex<0?"No save available":this._saveEntries[this._currentSaveIndex].name}loadBlankSave(){this.setCurrentSelectedSave(-1),D.loadBuild(this._currentBuildData.blocks)}setCurrentSelectedSave(n){switch(n){case-1:this._currentBuildData=ie.createNewSaveEntry(new Date().toLocaleString());break;default:this._currentBuildData=this._saveEntries[n];break}}};Ge.TypeName="save-panel",Ge.Properties={loadButtonObj:{type:g.Object,default:null},newButtonObj:{type:g.Object,default:null},nextButtonObj:{type:g.Object,default:null},saveButtonObj:{type:g.Object,default:null},removeButtonObj:{type:g.Object,default:null},saveCountObj:{type:g.Object,default:null},saveNameObj:{type:g.Object,default:null}};var G=class extends x{start(){this._objToggler=this.object.addComponent(_e),this._mesh=this.object.getComponent("mesh"),this.object.setTranslationLocal(v.fromValues(0,0,0))}show(){this._objToggler.setActive(!0)}hide(){this._objToggler.setActive(!1)}};G.TypeName="arm-panel",G.Properties={};var _e=class extends x{start(){this._components=new Array,this.fetchAllComponents(this.object)}setActive(n){for(let i=0;i<this._components.length;i++)console.log(`setActive ${n} component ${this._components[i].type}`),this._components[i].active=n}fetchAllComponents(n){let i=n.getComponents(null).filter(o=>o.type!==G.TypeName);console.log(`fetch ${i.length} components for object ${n.name}`),this._components=this._components.concat(i);let s=n.children;for(let o=0;o<s.length;o++){let l=s[o];this.fetchAllComponents(l)}}};_e.TypeName="object-toggler",_e.Properties={};var Qe=class extends x{start(){this._mesh=this.object.getComponent("mesh");let n=this.material.clone();n.occlusionTexture=this.albedoMap,n.normalTexture=this.normalMap,this._mesh.material=n}};Qe.TypeName="simple-preview-block-creator",Qe.Properties={material:{type:g.Material,default:null},albedoMap:{type:g.Texture,default:null},normalMap:{type:g.Texture,default:null}};var ee=class extends x{get isActive(){return this._isActive}get button(){return this._button}init(){this.setup(),this.setupIcon()}setActive(n){this._mesh.material.color=n?W.COLOR_ACTIVE:W.COLOR_NORMAL,this._isActive=n}setup(){var n;this._button=this.object.getComponent(N),this._mesh=this.object.getComponent("mesh"),this._material=(n=this._mesh.material)==null?void 0:n.clone(),this._mesh.material=this._material,this._material.color=W.COLOR_NORMAL,this._isActive=!1}setupIcon(){var i;let n=this.iconObject.getComponent("mesh");this._iconMaterial=(i=n.material)==null?void 0:i.clone(),n.material=this._iconMaterial,this._iconMaterial.flatTexture=this.iconTexture}};ee.TypeName="menu-selection-button",ee.Properties={iconObject:{type:g.Object,default:null},iconTexture:{type:g.Texture,default:null}};var $e=class extends x{start(){this._menuButtonComp=this.menuButton.getComponent(ee),this._blockButtonComp=this.blockButton.getComponent(ee),this._textureButtonComp=this.textureButton.getComponent(ee),this._menuButtonComp.button.addInteractCallback(this.onMenuButtonPressed.bind(this)),this._blockButtonComp.button.addInteractCallback(this.onBlockButtonPressed.bind(this)),this._textureButtonComp.button.addInteractCallback(this.onTextureButtonPressed.bind(this)),this._menuPanelComp=this.menuPanel.getComponent(G),this._blockPanelComp=this.blockPanel.getComponent(G),this._texturePanelComp=this.texturePanel.getComponent(G),console.log(this.engine),this.engine.onXRSessionStart.push(()=>{setTimeout(()=>{this._menuPanelComp.hide(),this._blockPanelComp.hide(),this._texturePanelComp.hide(),console.log("COUCOU scene loaded !")},100)})}onMenuButtonPressed(){this._menuButtonComp.setActive(!0),this._menuPanelComp.show(),this._blockButtonComp.setActive(!1),this._textureButtonComp.setActive(!1),this._blockPanelComp.hide(),this._texturePanelComp.hide()}onBlockButtonPressed(){this._blockButtonComp.setActive(!0),this._blockPanelComp.show(),this._menuButtonComp.setActive(!1),this._textureButtonComp.setActive(!1),this._menuPanelComp.hide(),this._texturePanelComp.hide()}onTextureButtonPressed(){this._textureButtonComp.setActive(!0),this._texturePanelComp.show(),this._menuButtonComp.setActive(!1),this._blockButtonComp.setActive(!1),this._menuPanelComp.hide(),this._blockPanelComp.hide()}};$e.TypeName="menu-controller",$e.Properties={menuButton:{type:g.Object},blockButton:{type:g.Object},textureButton:{type:g.Object},menuPanel:{type:g.Object},blockPanel:{type:g.Object},texturePanel:{type:g.Object}};WL.registerComponent(ge,we,ve,xe,ye,Me,Te,Ae,je,Se,Ce,Pe,Oe,Ie,Ee,Re,ke,Fe,Be,Le,De,Ne);WL.registerComponent(ne);WL.registerComponent(Ue);WL.registerComponent(oe);WL.registerComponent(Ve);WL.registerComponent(He);WL.registerComponent(se);WL.registerComponent(We);WL.registerComponent(H);WL.registerComponent(lt);WL.registerComponent(ct);WL.registerComponent(_t);WL.registerComponent(ht);WL.registerComponent(Xe);WL.registerComponent(qe);WL.registerComponent(Ye);WL.registerComponent(N);WL.registerComponent(ae);WL.registerComponent(Ge);WL.registerComponent(_e);WL.registerComponent(Qe);WL.registerComponent(J);WL.registerComponent(ce);WL.registerComponent(G);WL.registerComponent(le);WL.registerComponent($e);WL.registerComponent(ee);})();
/*! Bundled license information:

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
*/
//# sourceMappingURL=wonderbrick-bundle.js.map
