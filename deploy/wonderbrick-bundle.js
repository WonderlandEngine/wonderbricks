(()=>{var mi=Object.create;var nt=Object.defineProperty;var vi=Object.getOwnPropertyDescriptor;var gi=Object.getOwnPropertyNames;var bi=Object.getPrototypeOf,yi=Object.prototype.hasOwnProperty;var A=(e,t)=>()=>(e&&(t=e(e=0)),t);var We=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),W=(e,t)=>{for(var r in t)nt(e,r,{get:t[r],enumerable:!0})},Sr=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of gi(t))!yi.call(e,s)&&s!==r&&nt(e,s,{get:()=>t[s],enumerable:!(n=vi(t,s))||n.enumerable});return e};var jr=(e,t,r)=>(r=e!=null?mi(bi(e)):{},Sr(t||!e||!e.__esModule?nt(r,"default",{value:e,enumerable:!0}):r,e)),F=e=>Sr(nt({},"__esModule",{value:!0}),e);var Ir=(e,t,r)=>new Promise((n,s)=>{var o=h=>{try{l(r.next(h))}catch(p){s(p)}},c=h=>{try{l(r.throw(h))}catch(p){s(p)}},l=h=>h.done?n(h.value):Promise.resolve(h.value).then(o,c);l((r=r.apply(e,t)).next())});var Cr=We(()=>{WL.registerComponent("finger-cursor",{},{init:function(){this.lastTarget=null},start:function(){this.tip=this.object.getComponent("collision")},update:function(){let e=this.tip.queryOverlaps(),t=null;for(let r=0;r<e.length;++r){let n=e[r].object,s=n.getComponent("cursor-target");if(s){s.equals(this.lastTarget)||(s.onHover(n,this),s.onClick(n,this)),t=s;break}}if(t)this.lastTarget=t;else{this.lastTarget&&this.lastTarget.onUnhover(this.lastTarget.object,this),this.lastTarget=null;return}}})});var Or=We(()=>{WL.registerComponent("cursor-target",{},{init:function(){this.hoverFunctions=[],this.unHoverFunctions=[],this.clickFunctions=[],this.moveFunctions=[],this.downFunctions=[],this.upFunctions=[]},onHover:function(e,t){for(let r of this.hoverFunctions)r(e,t)},onUnhover:function(e,t){for(let r of this.unHoverFunctions)r(e,t)},onClick:function(e,t){for(let r of this.clickFunctions)r(e,t)},onMove:function(e,t){for(let r of this.moveFunctions)r(e,t)},onDown:function(e,t){for(let r of this.downFunctions)r(e,t)},onUp:function(e,t){for(let r of this.upFunctions)r(e,t)},addHoverFunction:function(e){this._validateCallback(e),this.hoverFunctions.push(e)},removeHoverFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.hoverFunctions,e)},addUnHoverFunction:function(e){this._validateCallback(e),this.unHoverFunctions.push(e)},removeUnHoverFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.unHoverFunctions,e)},addClickFunction:function(e){this._validateCallback(e),this.clickFunctions.push(e)},removeClickFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.clickFunctions,e)},addMoveFunction:function(e){this._validateCallback(e),this.moveFunctions.push(e)},removeMoveFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.moveFunctions,e)},addDownFunction:function(e){this._validateCallback(e),this.downFunctions.push(e)},removeDownFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.downFunctions,e)},addUpFunction:function(e){this._validateCallback(e),this.upFunctions.push(e)},removeUpFunction:function(e){this._validateCallback(e),this._removeItemOnce(this.upFunctions,e)},_removeItemOnce:function(e,t){var r=e.indexOf(t);return r>-1&&e.splice(r,1),e},_validateCallback:function(e){if(typeof e!="function")throw new TypeError(this.object.name+".cursor-target: Argument needs to be a function")}})});var j,P,q,Ko,pe=A(()=>{j=1e-6,P=typeof Float32Array<"u"?Float32Array:Array,q=Math.random,Ko=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})});function Pr(){var e=new P(9);return P!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}var Er=A(()=>{pe()});var we={};W(we,{add:()=>ns,adjoint:()=>Ci,clone:()=>Mi,copy:()=>Ai,create:()=>wi,determinant:()=>Oi,equals:()=>os,exactEquals:()=>as,frob:()=>rs,fromQuat:()=>Yi,fromQuat2:()=>Ui,fromRotation:()=>Wi,fromRotationTranslation:()=>kr,fromRotationTranslationScale:()=>Vi,fromRotationTranslationScaleOrigin:()=>Xi,fromScaling:()=>Di,fromTranslation:()=>Fi,fromValues:()=>Ti,fromXRotation:()=>Hi,fromYRotation:()=>Ni,fromZRotation:()=>zi,frustum:()=>qi,getRotation:()=>jt,getScaling:()=>Br,getTranslation:()=>St,identity:()=>Lr,invert:()=>Ii,lookAt:()=>Qi,mul:()=>cs,multiply:()=>Rr,multiplyScalar:()=>is,multiplyScalarAndAdd:()=>ss,ortho:()=>$i,orthoNO:()=>Dr,orthoZO:()=>Ki,perspective:()=>Gi,perspectiveFromFieldOfView:()=>Zi,perspectiveNO:()=>Fr,perspectiveZO:()=>Ji,rotate:()=>Li,rotateX:()=>Ri,rotateY:()=>ki,rotateZ:()=>Bi,scale:()=>Ei,set:()=>Si,str:()=>ts,sub:()=>ls,subtract:()=>Wr,targetTo:()=>es,translate:()=>Pi,transpose:()=>ji});function wi(){var e=new P(16);return P!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Mi(e){var t=new P(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ai(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ti(e,t,r,n,s,o,c,l,h,p,i,a,d,_,u,m){var f=new P(16);return f[0]=e,f[1]=t,f[2]=r,f[3]=n,f[4]=s,f[5]=o,f[6]=c,f[7]=l,f[8]=h,f[9]=p,f[10]=i,f[11]=a,f[12]=d,f[13]=_,f[14]=u,f[15]=m,f}function Si(e,t,r,n,s,o,c,l,h,p,i,a,d,_,u,m,f){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e[4]=o,e[5]=c,e[6]=l,e[7]=h,e[8]=p,e[9]=i,e[10]=a,e[11]=d,e[12]=_,e[13]=u,e[14]=m,e[15]=f,e}function Lr(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ji(e,t){if(e===t){var r=t[1],n=t[2],s=t[3],o=t[6],c=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=s,e[13]=c,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Ii(e,t){var r=t[0],n=t[1],s=t[2],o=t[3],c=t[4],l=t[5],h=t[6],p=t[7],i=t[8],a=t[9],d=t[10],_=t[11],u=t[12],m=t[13],f=t[14],v=t[15],b=r*l-n*c,x=r*h-s*c,w=r*p-o*c,M=n*h-s*l,T=n*p-o*l,L=s*p-o*h,S=i*m-a*u,R=i*f-d*u,k=i*v-_*u,H=a*f-d*m,D=a*v-_*m,B=d*v-_*f,O=b*B-x*D+w*H+M*k-T*R+L*S;return O?(O=1/O,e[0]=(l*B-h*D+p*H)*O,e[1]=(s*D-n*B-o*H)*O,e[2]=(m*L-f*T+v*M)*O,e[3]=(d*T-a*L-_*M)*O,e[4]=(h*k-c*B-p*R)*O,e[5]=(r*B-s*k+o*R)*O,e[6]=(f*w-u*L-v*x)*O,e[7]=(i*L-d*w+_*x)*O,e[8]=(c*D-l*k+p*S)*O,e[9]=(n*k-r*D-o*S)*O,e[10]=(u*T-m*w+v*b)*O,e[11]=(a*w-i*T-_*b)*O,e[12]=(l*R-c*H-h*S)*O,e[13]=(r*H-n*R+s*S)*O,e[14]=(m*x-u*M-f*b)*O,e[15]=(i*M-a*x+d*b)*O,e):null}function Ci(e,t){var r=t[0],n=t[1],s=t[2],o=t[3],c=t[4],l=t[5],h=t[6],p=t[7],i=t[8],a=t[9],d=t[10],_=t[11],u=t[12],m=t[13],f=t[14],v=t[15];return e[0]=l*(d*v-_*f)-a*(h*v-p*f)+m*(h*_-p*d),e[1]=-(n*(d*v-_*f)-a*(s*v-o*f)+m*(s*_-o*d)),e[2]=n*(h*v-p*f)-l*(s*v-o*f)+m*(s*p-o*h),e[3]=-(n*(h*_-p*d)-l*(s*_-o*d)+a*(s*p-o*h)),e[4]=-(c*(d*v-_*f)-i*(h*v-p*f)+u*(h*_-p*d)),e[5]=r*(d*v-_*f)-i*(s*v-o*f)+u*(s*_-o*d),e[6]=-(r*(h*v-p*f)-c*(s*v-o*f)+u*(s*p-o*h)),e[7]=r*(h*_-p*d)-c*(s*_-o*d)+i*(s*p-o*h),e[8]=c*(a*v-_*m)-i*(l*v-p*m)+u*(l*_-p*a),e[9]=-(r*(a*v-_*m)-i*(n*v-o*m)+u*(n*_-o*a)),e[10]=r*(l*v-p*m)-c*(n*v-o*m)+u*(n*p-o*l),e[11]=-(r*(l*_-p*a)-c*(n*_-o*a)+i*(n*p-o*l)),e[12]=-(c*(a*f-d*m)-i*(l*f-h*m)+u*(l*d-h*a)),e[13]=r*(a*f-d*m)-i*(n*f-s*m)+u*(n*d-s*a),e[14]=-(r*(l*f-h*m)-c*(n*f-s*m)+u*(n*h-s*l)),e[15]=r*(l*d-h*a)-c*(n*d-s*a)+i*(n*h-s*l),e}function Oi(e){var t=e[0],r=e[1],n=e[2],s=e[3],o=e[4],c=e[5],l=e[6],h=e[7],p=e[8],i=e[9],a=e[10],d=e[11],_=e[12],u=e[13],m=e[14],f=e[15],v=t*c-r*o,b=t*l-n*o,x=t*h-s*o,w=r*l-n*c,M=r*h-s*c,T=n*h-s*l,L=p*u-i*_,S=p*m-a*_,R=p*f-d*_,k=i*m-a*u,H=i*f-d*u,D=a*f-d*m;return v*D-b*H+x*k+w*R-M*S+T*L}function Rr(e,t,r){var n=t[0],s=t[1],o=t[2],c=t[3],l=t[4],h=t[5],p=t[6],i=t[7],a=t[8],d=t[9],_=t[10],u=t[11],m=t[12],f=t[13],v=t[14],b=t[15],x=r[0],w=r[1],M=r[2],T=r[3];return e[0]=x*n+w*l+M*a+T*m,e[1]=x*s+w*h+M*d+T*f,e[2]=x*o+w*p+M*_+T*v,e[3]=x*c+w*i+M*u+T*b,x=r[4],w=r[5],M=r[6],T=r[7],e[4]=x*n+w*l+M*a+T*m,e[5]=x*s+w*h+M*d+T*f,e[6]=x*o+w*p+M*_+T*v,e[7]=x*c+w*i+M*u+T*b,x=r[8],w=r[9],M=r[10],T=r[11],e[8]=x*n+w*l+M*a+T*m,e[9]=x*s+w*h+M*d+T*f,e[10]=x*o+w*p+M*_+T*v,e[11]=x*c+w*i+M*u+T*b,x=r[12],w=r[13],M=r[14],T=r[15],e[12]=x*n+w*l+M*a+T*m,e[13]=x*s+w*h+M*d+T*f,e[14]=x*o+w*p+M*_+T*v,e[15]=x*c+w*i+M*u+T*b,e}function Pi(e,t,r){var n=r[0],s=r[1],o=r[2],c,l,h,p,i,a,d,_,u,m,f,v;return t===e?(e[12]=t[0]*n+t[4]*s+t[8]*o+t[12],e[13]=t[1]*n+t[5]*s+t[9]*o+t[13],e[14]=t[2]*n+t[6]*s+t[10]*o+t[14],e[15]=t[3]*n+t[7]*s+t[11]*o+t[15]):(c=t[0],l=t[1],h=t[2],p=t[3],i=t[4],a=t[5],d=t[6],_=t[7],u=t[8],m=t[9],f=t[10],v=t[11],e[0]=c,e[1]=l,e[2]=h,e[3]=p,e[4]=i,e[5]=a,e[6]=d,e[7]=_,e[8]=u,e[9]=m,e[10]=f,e[11]=v,e[12]=c*n+i*s+u*o+t[12],e[13]=l*n+a*s+m*o+t[13],e[14]=h*n+d*s+f*o+t[14],e[15]=p*n+_*s+v*o+t[15]),e}function Ei(e,t,r){var n=r[0],s=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Li(e,t,r,n){var s=n[0],o=n[1],c=n[2],l=Math.hypot(s,o,c),h,p,i,a,d,_,u,m,f,v,b,x,w,M,T,L,S,R,k,H,D,B,O,G;return l<j?null:(l=1/l,s*=l,o*=l,c*=l,h=Math.sin(r),p=Math.cos(r),i=1-p,a=t[0],d=t[1],_=t[2],u=t[3],m=t[4],f=t[5],v=t[6],b=t[7],x=t[8],w=t[9],M=t[10],T=t[11],L=s*s*i+p,S=o*s*i+c*h,R=c*s*i-o*h,k=s*o*i-c*h,H=o*o*i+p,D=c*o*i+s*h,B=s*c*i+o*h,O=o*c*i-s*h,G=c*c*i+p,e[0]=a*L+m*S+x*R,e[1]=d*L+f*S+w*R,e[2]=_*L+v*S+M*R,e[3]=u*L+b*S+T*R,e[4]=a*k+m*H+x*D,e[5]=d*k+f*H+w*D,e[6]=_*k+v*H+M*D,e[7]=u*k+b*H+T*D,e[8]=a*B+m*O+x*G,e[9]=d*B+f*O+w*G,e[10]=_*B+v*O+M*G,e[11]=u*B+b*O+T*G,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Ri(e,t,r){var n=Math.sin(r),s=Math.cos(r),o=t[4],c=t[5],l=t[6],h=t[7],p=t[8],i=t[9],a=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*s+p*n,e[5]=c*s+i*n,e[6]=l*s+a*n,e[7]=h*s+d*n,e[8]=p*s-o*n,e[9]=i*s-c*n,e[10]=a*s-l*n,e[11]=d*s-h*n,e}function ki(e,t,r){var n=Math.sin(r),s=Math.cos(r),o=t[0],c=t[1],l=t[2],h=t[3],p=t[8],i=t[9],a=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*s-p*n,e[1]=c*s-i*n,e[2]=l*s-a*n,e[3]=h*s-d*n,e[8]=o*n+p*s,e[9]=c*n+i*s,e[10]=l*n+a*s,e[11]=h*n+d*s,e}function Bi(e,t,r){var n=Math.sin(r),s=Math.cos(r),o=t[0],c=t[1],l=t[2],h=t[3],p=t[4],i=t[5],a=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*s+p*n,e[1]=c*s+i*n,e[2]=l*s+a*n,e[3]=h*s+d*n,e[4]=p*s-o*n,e[5]=i*s-c*n,e[6]=a*s-l*n,e[7]=d*s-h*n,e}function Fi(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Di(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Wi(e,t,r){var n=r[0],s=r[1],o=r[2],c=Math.hypot(n,s,o),l,h,p;return c<j?null:(c=1/c,n*=c,s*=c,o*=c,l=Math.sin(t),h=Math.cos(t),p=1-h,e[0]=n*n*p+h,e[1]=s*n*p+o*l,e[2]=o*n*p-s*l,e[3]=0,e[4]=n*s*p-o*l,e[5]=s*s*p+h,e[6]=o*s*p+n*l,e[7]=0,e[8]=n*o*p+s*l,e[9]=s*o*p-n*l,e[10]=o*o*p+h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Hi(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ni(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function zi(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function kr(e,t,r){var n=t[0],s=t[1],o=t[2],c=t[3],l=n+n,h=s+s,p=o+o,i=n*l,a=n*h,d=n*p,_=s*h,u=s*p,m=o*p,f=c*l,v=c*h,b=c*p;return e[0]=1-(_+m),e[1]=a+b,e[2]=d-v,e[3]=0,e[4]=a-b,e[5]=1-(i+m),e[6]=u+f,e[7]=0,e[8]=d+v,e[9]=u-f,e[10]=1-(i+_),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Ui(e,t){var r=new P(3),n=-t[0],s=-t[1],o=-t[2],c=t[3],l=t[4],h=t[5],p=t[6],i=t[7],a=n*n+s*s+o*o+c*c;return a>0?(r[0]=(l*c+i*n+h*o-p*s)*2/a,r[1]=(h*c+i*s+p*n-l*o)*2/a,r[2]=(p*c+i*o+l*s-h*n)*2/a):(r[0]=(l*c+i*n+h*o-p*s)*2,r[1]=(h*c+i*s+p*n-l*o)*2,r[2]=(p*c+i*o+l*s-h*n)*2),kr(e,t,r),e}function St(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Br(e,t){var r=t[0],n=t[1],s=t[2],o=t[4],c=t[5],l=t[6],h=t[8],p=t[9],i=t[10];return e[0]=Math.hypot(r,n,s),e[1]=Math.hypot(o,c,l),e[2]=Math.hypot(h,p,i),e}function jt(e,t){var r=new P(3);Br(r,t);var n=1/r[0],s=1/r[1],o=1/r[2],c=t[0]*n,l=t[1]*s,h=t[2]*o,p=t[4]*n,i=t[5]*s,a=t[6]*o,d=t[8]*n,_=t[9]*s,u=t[10]*o,m=c+i+u,f=0;return m>0?(f=Math.sqrt(m+1)*2,e[3]=.25*f,e[0]=(a-_)/f,e[1]=(d-h)/f,e[2]=(l-p)/f):c>i&&c>u?(f=Math.sqrt(1+c-i-u)*2,e[3]=(a-_)/f,e[0]=.25*f,e[1]=(l+p)/f,e[2]=(d+h)/f):i>u?(f=Math.sqrt(1+i-c-u)*2,e[3]=(d-h)/f,e[0]=(l+p)/f,e[1]=.25*f,e[2]=(a+_)/f):(f=Math.sqrt(1+u-c-i)*2,e[3]=(l-p)/f,e[0]=(d+h)/f,e[1]=(a+_)/f,e[2]=.25*f),e}function Vi(e,t,r,n){var s=t[0],o=t[1],c=t[2],l=t[3],h=s+s,p=o+o,i=c+c,a=s*h,d=s*p,_=s*i,u=o*p,m=o*i,f=c*i,v=l*h,b=l*p,x=l*i,w=n[0],M=n[1],T=n[2];return e[0]=(1-(u+f))*w,e[1]=(d+x)*w,e[2]=(_-b)*w,e[3]=0,e[4]=(d-x)*M,e[5]=(1-(a+f))*M,e[6]=(m+v)*M,e[7]=0,e[8]=(_+b)*T,e[9]=(m-v)*T,e[10]=(1-(a+u))*T,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Xi(e,t,r,n,s){var o=t[0],c=t[1],l=t[2],h=t[3],p=o+o,i=c+c,a=l+l,d=o*p,_=o*i,u=o*a,m=c*i,f=c*a,v=l*a,b=h*p,x=h*i,w=h*a,M=n[0],T=n[1],L=n[2],S=s[0],R=s[1],k=s[2],H=(1-(m+v))*M,D=(_+w)*M,B=(u-x)*M,O=(_-w)*T,G=(1-(d+v))*T,Fe=(f+b)*T,De=(u+x)*L,Ar=(f-b)*L,Tr=(1-(d+m))*L;return e[0]=H,e[1]=D,e[2]=B,e[3]=0,e[4]=O,e[5]=G,e[6]=Fe,e[7]=0,e[8]=De,e[9]=Ar,e[10]=Tr,e[11]=0,e[12]=r[0]+S-(H*S+O*R+De*k),e[13]=r[1]+R-(D*S+G*R+Ar*k),e[14]=r[2]+k-(B*S+Fe*R+Tr*k),e[15]=1,e}function Yi(e,t){var r=t[0],n=t[1],s=t[2],o=t[3],c=r+r,l=n+n,h=s+s,p=r*c,i=n*c,a=n*l,d=s*c,_=s*l,u=s*h,m=o*c,f=o*l,v=o*h;return e[0]=1-a-u,e[1]=i+v,e[2]=d-f,e[3]=0,e[4]=i-v,e[5]=1-p-u,e[6]=_+m,e[7]=0,e[8]=d+f,e[9]=_-m,e[10]=1-p-a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qi(e,t,r,n,s,o,c){var l=1/(r-t),h=1/(s-n),p=1/(o-c);return e[0]=o*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*h,e[6]=0,e[7]=0,e[8]=(r+t)*l,e[9]=(s+n)*h,e[10]=(c+o)*p,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*o*2*p,e[15]=0,e}function Fr(e,t,r,n,s){var o=1/Math.tan(t/2),c;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0?(c=1/(n-s),e[10]=(s+n)*c,e[14]=2*s*n*c):(e[10]=-1,e[14]=-2*n),e}function Ji(e,t,r,n,s){var o=1/Math.tan(t/2),c;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0?(c=1/(n-s),e[10]=s*c,e[14]=s*n*c):(e[10]=-1,e[14]=-n),e}function Zi(e,t,r,n){var s=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),c=Math.tan(t.leftDegrees*Math.PI/180),l=Math.tan(t.rightDegrees*Math.PI/180),h=2/(c+l),p=2/(s+o);return e[0]=h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=p,e[6]=0,e[7]=0,e[8]=-((c-l)*h*.5),e[9]=(s-o)*p*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Dr(e,t,r,n,s,o,c){var l=1/(t-r),h=1/(n-s),p=1/(o-c);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*p,e[11]=0,e[12]=(t+r)*l,e[13]=(s+n)*h,e[14]=(c+o)*p,e[15]=1,e}function Ki(e,t,r,n,s,o,c){var l=1/(t-r),h=1/(n-s),p=1/(o-c);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=p,e[11]=0,e[12]=(t+r)*l,e[13]=(s+n)*h,e[14]=o*p,e[15]=1,e}function Qi(e,t,r,n){var s,o,c,l,h,p,i,a,d,_,u=t[0],m=t[1],f=t[2],v=n[0],b=n[1],x=n[2],w=r[0],M=r[1],T=r[2];return Math.abs(u-w)<j&&Math.abs(m-M)<j&&Math.abs(f-T)<j?Lr(e):(i=u-w,a=m-M,d=f-T,_=1/Math.hypot(i,a,d),i*=_,a*=_,d*=_,s=b*d-x*a,o=x*i-v*d,c=v*a-b*i,_=Math.hypot(s,o,c),_?(_=1/_,s*=_,o*=_,c*=_):(s=0,o=0,c=0),l=a*c-d*o,h=d*s-i*c,p=i*o-a*s,_=Math.hypot(l,h,p),_?(_=1/_,l*=_,h*=_,p*=_):(l=0,h=0,p=0),e[0]=s,e[1]=l,e[2]=i,e[3]=0,e[4]=o,e[5]=h,e[6]=a,e[7]=0,e[8]=c,e[9]=p,e[10]=d,e[11]=0,e[12]=-(s*u+o*m+c*f),e[13]=-(l*u+h*m+p*f),e[14]=-(i*u+a*m+d*f),e[15]=1,e)}function es(e,t,r,n){var s=t[0],o=t[1],c=t[2],l=n[0],h=n[1],p=n[2],i=s-r[0],a=o-r[1],d=c-r[2],_=i*i+a*a+d*d;_>0&&(_=1/Math.sqrt(_),i*=_,a*=_,d*=_);var u=h*d-p*a,m=p*i-l*d,f=l*a-h*i;return _=u*u+m*m+f*f,_>0&&(_=1/Math.sqrt(_),u*=_,m*=_,f*=_),e[0]=u,e[1]=m,e[2]=f,e[3]=0,e[4]=a*f-d*m,e[5]=d*u-i*f,e[6]=i*m-a*u,e[7]=0,e[8]=i,e[9]=a,e[10]=d,e[11]=0,e[12]=s,e[13]=o,e[14]=c,e[15]=1,e}function ts(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function rs(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ns(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Wr(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function is(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function ss(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function as(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function os(e,t){var r=e[0],n=e[1],s=e[2],o=e[3],c=e[4],l=e[5],h=e[6],p=e[7],i=e[8],a=e[9],d=e[10],_=e[11],u=e[12],m=e[13],f=e[14],v=e[15],b=t[0],x=t[1],w=t[2],M=t[3],T=t[4],L=t[5],S=t[6],R=t[7],k=t[8],H=t[9],D=t[10],B=t[11],O=t[12],G=t[13],Fe=t[14],De=t[15];return Math.abs(r-b)<=j*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-x)<=j*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(s-w)<=j*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-M)<=j*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(c-T)<=j*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(l-L)<=j*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(h-S)<=j*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(p-R)<=j*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(i-k)<=j*Math.max(1,Math.abs(i),Math.abs(k))&&Math.abs(a-H)<=j*Math.max(1,Math.abs(a),Math.abs(H))&&Math.abs(d-D)<=j*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(_-B)<=j*Math.max(1,Math.abs(_),Math.abs(B))&&Math.abs(u-O)<=j*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(m-G)<=j*Math.max(1,Math.abs(m),Math.abs(G))&&Math.abs(f-Fe)<=j*Math.max(1,Math.abs(f),Math.abs(Fe))&&Math.abs(v-De)<=j*Math.max(1,Math.abs(v),Math.abs(De))}var Gi,$i,cs,ls,It=A(()=>{pe();Gi=Fr;$i=Dr;cs=Rr,ls=Wr});var E={};W(E,{add:()=>ps,angle:()=>Ls,bezier:()=>Ts,ceil:()=>fs,clone:()=>ds,copy:()=>hs,create:()=>it,cross:()=>He,dist:()=>Ns,distance:()=>Vr,div:()=>Hs,divide:()=>Ur,dot:()=>at,equals:()=>Fs,exactEquals:()=>Bs,floor:()=>us,forEach:()=>Vs,fromValues:()=>st,hermite:()=>As,inverse:()=>ws,len:()=>Ot,length:()=>Hr,lerp:()=>Ms,max:()=>vs,min:()=>ms,mul:()=>Ws,multiply:()=>zr,negate:()=>xs,normalize:()=>Ct,random:()=>Ss,rotateX:()=>Os,rotateY:()=>Ps,rotateZ:()=>Es,round:()=>gs,scale:()=>bs,scaleAndAdd:()=>ys,set:()=>_s,sqrDist:()=>zs,sqrLen:()=>Us,squaredDistance:()=>Xr,squaredLength:()=>Yr,str:()=>ks,sub:()=>Ds,subtract:()=>Nr,transformMat3:()=>Is,transformMat4:()=>js,transformQuat:()=>Cs,zero:()=>Rs});function it(){var e=new P(3);return P!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ds(e){var t=new P(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Hr(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function st(e,t,r){var n=new P(3);return n[0]=e,n[1]=t,n[2]=r,n}function hs(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function _s(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function ps(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Nr(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function zr(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Ur(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function fs(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function us(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function ms(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function vs(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function gs(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function bs(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function ys(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function Vr(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2];return Math.hypot(r,n,s)}function Xr(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2];return r*r+n*n+s*s}function Yr(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function xs(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function ws(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Ct(e,t){var r=t[0],n=t[1],s=t[2],o=r*r+n*n+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function at(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function He(e,t,r){var n=t[0],s=t[1],o=t[2],c=r[0],l=r[1],h=r[2];return e[0]=s*h-o*l,e[1]=o*c-n*h,e[2]=n*l-s*c,e}function Ms(e,t,r,n){var s=t[0],o=t[1],c=t[2];return e[0]=s+n*(r[0]-s),e[1]=o+n*(r[1]-o),e[2]=c+n*(r[2]-c),e}function As(e,t,r,n,s,o){var c=o*o,l=c*(2*o-3)+1,h=c*(o-2)+o,p=c*(o-1),i=c*(3-2*o);return e[0]=t[0]*l+r[0]*h+n[0]*p+s[0]*i,e[1]=t[1]*l+r[1]*h+n[1]*p+s[1]*i,e[2]=t[2]*l+r[2]*h+n[2]*p+s[2]*i,e}function Ts(e,t,r,n,s,o){var c=1-o,l=c*c,h=o*o,p=l*c,i=3*o*l,a=3*h*c,d=h*o;return e[0]=t[0]*p+r[0]*i+n[0]*a+s[0]*d,e[1]=t[1]*p+r[1]*i+n[1]*a+s[1]*d,e[2]=t[2]*p+r[2]*i+n[2]*a+s[2]*d,e}function Ss(e,t){t=t||1;var r=q()*2*Math.PI,n=q()*2-1,s=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*s,e[1]=Math.sin(r)*s,e[2]=n*t,e}function js(e,t,r){var n=t[0],s=t[1],o=t[2],c=r[3]*n+r[7]*s+r[11]*o+r[15];return c=c||1,e[0]=(r[0]*n+r[4]*s+r[8]*o+r[12])/c,e[1]=(r[1]*n+r[5]*s+r[9]*o+r[13])/c,e[2]=(r[2]*n+r[6]*s+r[10]*o+r[14])/c,e}function Is(e,t,r){var n=t[0],s=t[1],o=t[2];return e[0]=n*r[0]+s*r[3]+o*r[6],e[1]=n*r[1]+s*r[4]+o*r[7],e[2]=n*r[2]+s*r[5]+o*r[8],e}function Cs(e,t,r){var n=r[0],s=r[1],o=r[2],c=r[3],l=t[0],h=t[1],p=t[2],i=s*p-o*h,a=o*l-n*p,d=n*h-s*l,_=s*d-o*a,u=o*i-n*d,m=n*a-s*i,f=c*2;return i*=f,a*=f,d*=f,_*=2,u*=2,m*=2,e[0]=l+i+_,e[1]=h+a+u,e[2]=p+d+m,e}function Os(e,t,r,n){var s=[],o=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],o[0]=s[0],o[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),o[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Ps(e,t,r,n){var s=[],o=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],o[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),o[1]=s[1],o[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Es(e,t,r,n){var s=[],o=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],o[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),o[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),o[2]=s[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Ls(e,t){var r=e[0],n=e[1],s=e[2],o=t[0],c=t[1],l=t[2],h=Math.sqrt(r*r+n*n+s*s),p=Math.sqrt(o*o+c*c+l*l),i=h*p,a=i&&at(e,t)/i;return Math.acos(Math.min(Math.max(a,-1),1))}function Rs(e){return e[0]=0,e[1]=0,e[2]=0,e}function ks(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Bs(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Fs(e,t){var r=e[0],n=e[1],s=e[2],o=t[0],c=t[1],l=t[2];return Math.abs(r-o)<=j*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-c)<=j*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(s-l)<=j*Math.max(1,Math.abs(s),Math.abs(l))}var Ds,Ws,Hs,Ns,zs,Ot,Us,Vs,Pt=A(()=>{pe();Ds=Nr,Ws=zr,Hs=Ur,Ns=Vr,zs=Xr,Ot=Hr,Us=Yr,Vs=function(){var e=it();return function(t,r,n,s,o,c){var l,h;for(r||(r=3),n||(n=0),s?h=Math.min(s*r+n,t.length):h=t.length,l=n;l<h;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],o(e,e,c),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}}()});var fe={};W(fe,{add:()=>Bt,ceil:()=>Xs,clone:()=>Et,copy:()=>Rt,create:()=>qr,cross:()=>Qs,dist:()=>ca,distance:()=>$r,div:()=>oa,divide:()=>Zr,dot:()=>Wt,equals:()=>zt,exactEquals:()=>Nt,floor:()=>Ys,forEach:()=>_a,fromValues:()=>Lt,inverse:()=>Ks,len:()=>da,length:()=>ot,lerp:()=>Ht,max:()=>Gs,min:()=>qs,mul:()=>aa,multiply:()=>Jr,negate:()=>$s,normalize:()=>Dt,random:()=>ea,round:()=>Js,scale:()=>Ft,scaleAndAdd:()=>Zs,set:()=>kt,sqrDist:()=>la,sqrLen:()=>ha,squaredDistance:()=>Kr,squaredLength:()=>ct,str:()=>ia,sub:()=>sa,subtract:()=>Gr,transformMat4:()=>ta,transformQuat:()=>ra,zero:()=>na});function qr(){var e=new P(4);return P!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Et(e){var t=new P(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Lt(e,t,r,n){var s=new P(4);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s}function Rt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function kt(e,t,r,n,s){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e}function Bt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Gr(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Jr(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Zr(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Xs(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Ys(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function qs(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Gs(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Js(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Ft(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Zs(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function $r(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2],o=t[3]-e[3];return Math.hypot(r,n,s,o)}function Kr(e,t){var r=t[0]-e[0],n=t[1]-e[1],s=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+s*s+o*o}function ot(e){var t=e[0],r=e[1],n=e[2],s=e[3];return Math.hypot(t,r,n,s)}function ct(e){var t=e[0],r=e[1],n=e[2],s=e[3];return t*t+r*r+n*n+s*s}function $s(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Ks(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Dt(e,t){var r=t[0],n=t[1],s=t[2],o=t[3],c=r*r+n*n+s*s+o*o;return c>0&&(c=1/Math.sqrt(c)),e[0]=r*c,e[1]=n*c,e[2]=s*c,e[3]=o*c,e}function Wt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Qs(e,t,r,n){var s=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],c=r[0]*n[3]-r[3]*n[0],l=r[1]*n[2]-r[2]*n[1],h=r[1]*n[3]-r[3]*n[1],p=r[2]*n[3]-r[3]*n[2],i=t[0],a=t[1],d=t[2],_=t[3];return e[0]=a*p-d*h+_*l,e[1]=-(i*p)+d*c-_*o,e[2]=i*h-a*c+_*s,e[3]=-(i*l)+a*o-d*s,e}function Ht(e,t,r,n){var s=t[0],o=t[1],c=t[2],l=t[3];return e[0]=s+n*(r[0]-s),e[1]=o+n*(r[1]-o),e[2]=c+n*(r[2]-c),e[3]=l+n*(r[3]-l),e}function ea(e,t){t=t||1;var r,n,s,o,c,l;do r=q()*2-1,n=q()*2-1,c=r*r+n*n;while(c>=1);do s=q()*2-1,o=q()*2-1,l=s*s+o*o;while(l>=1);var h=Math.sqrt((1-c)/l);return e[0]=t*r,e[1]=t*n,e[2]=t*s*h,e[3]=t*o*h,e}function ta(e,t,r){var n=t[0],s=t[1],o=t[2],c=t[3];return e[0]=r[0]*n+r[4]*s+r[8]*o+r[12]*c,e[1]=r[1]*n+r[5]*s+r[9]*o+r[13]*c,e[2]=r[2]*n+r[6]*s+r[10]*o+r[14]*c,e[3]=r[3]*n+r[7]*s+r[11]*o+r[15]*c,e}function ra(e,t,r){var n=t[0],s=t[1],o=t[2],c=r[0],l=r[1],h=r[2],p=r[3],i=p*n+l*o-h*s,a=p*s+h*n-c*o,d=p*o+c*s-l*n,_=-c*n-l*s-h*o;return e[0]=i*p+_*-c+a*-h-d*-l,e[1]=a*p+_*-l+d*-c-i*-h,e[2]=d*p+_*-h+i*-l-a*-c,e[3]=t[3],e}function na(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function ia(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Nt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function zt(e,t){var r=e[0],n=e[1],s=e[2],o=e[3],c=t[0],l=t[1],h=t[2],p=t[3];return Math.abs(r-c)<=j*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-l)<=j*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-h)<=j*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-p)<=j*Math.max(1,Math.abs(o),Math.abs(p))}var sa,aa,oa,ca,la,da,ha,_a,Ut=A(()=>{pe();sa=Gr,aa=Jr,oa=Zr,ca=$r,la=Kr,da=ot,ha=ct,_a=function(){var e=qr();return function(t,r,n,s,o,c){var l,h;for(r||(r=4),n||(n=0),s?h=Math.min(s*r+n,t.length):h=t.length,l=n;l<h;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],o(e,e,c),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}}()});var ze={};W(ze,{add:()=>Sa,calculateW:()=>ma,clone:()=>Ma,conjugate:()=>ya,copy:()=>dt,create:()=>Ne,dot:()=>ht,equals:()=>Ea,exactEquals:()=>Pa,exp:()=>tn,fromEuler:()=>xa,fromMat3:()=>nn,fromValues:()=>Aa,getAngle:()=>ua,getAxisAngle:()=>fa,identity:()=>pa,invert:()=>ba,len:()=>Ca,length:()=>_t,lerp:()=>Ia,ln:()=>rn,mul:()=>ja,multiply:()=>en,normalize:()=>qt,pow:()=>va,random:()=>ga,rotateX:()=>Vt,rotateY:()=>Xt,rotateZ:()=>Yt,rotationTo:()=>La,scale:()=>sn,set:()=>Ta,setAxes:()=>ka,setAxisAngle:()=>Qr,slerp:()=>lt,sqlerp:()=>Ra,sqrLen:()=>Oa,squaredLength:()=>pt,str:()=>wa});function Ne(){var e=new P(4);return P!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function pa(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Qr(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function fa(e,t){var r=Math.acos(t[3])*2,n=Math.sin(r/2);return n>j?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function ua(e,t){var r=ht(e,t);return Math.acos(2*r*r-1)}function en(e,t,r){var n=t[0],s=t[1],o=t[2],c=t[3],l=r[0],h=r[1],p=r[2],i=r[3];return e[0]=n*i+c*l+s*p-o*h,e[1]=s*i+c*h+o*l-n*p,e[2]=o*i+c*p+n*h-s*l,e[3]=c*i-n*l-s*h-o*p,e}function Vt(e,t,r){r*=.5;var n=t[0],s=t[1],o=t[2],c=t[3],l=Math.sin(r),h=Math.cos(r);return e[0]=n*h+c*l,e[1]=s*h+o*l,e[2]=o*h-s*l,e[3]=c*h-n*l,e}function Xt(e,t,r){r*=.5;var n=t[0],s=t[1],o=t[2],c=t[3],l=Math.sin(r),h=Math.cos(r);return e[0]=n*h-o*l,e[1]=s*h+c*l,e[2]=o*h+n*l,e[3]=c*h-s*l,e}function Yt(e,t,r){r*=.5;var n=t[0],s=t[1],o=t[2],c=t[3],l=Math.sin(r),h=Math.cos(r);return e[0]=n*h+s*l,e[1]=s*h-n*l,e[2]=o*h+c*l,e[3]=c*h-o*l,e}function ma(e,t){var r=t[0],n=t[1],s=t[2];return e[0]=r,e[1]=n,e[2]=s,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-s*s)),e}function tn(e,t){var r=t[0],n=t[1],s=t[2],o=t[3],c=Math.sqrt(r*r+n*n+s*s),l=Math.exp(o),h=c>0?l*Math.sin(c)/c:0;return e[0]=r*h,e[1]=n*h,e[2]=s*h,e[3]=l*Math.cos(c),e}function rn(e,t){var r=t[0],n=t[1],s=t[2],o=t[3],c=Math.sqrt(r*r+n*n+s*s),l=c>0?Math.atan2(c,o)/c:0;return e[0]=r*l,e[1]=n*l,e[2]=s*l,e[3]=.5*Math.log(r*r+n*n+s*s+o*o),e}function va(e,t,r){return rn(e,t),sn(e,e,r),tn(e,e),e}function lt(e,t,r,n){var s=t[0],o=t[1],c=t[2],l=t[3],h=r[0],p=r[1],i=r[2],a=r[3],d,_,u,m,f;return _=s*h+o*p+c*i+l*a,_<0&&(_=-_,h=-h,p=-p,i=-i,a=-a),1-_>j?(d=Math.acos(_),u=Math.sin(d),m=Math.sin((1-n)*d)/u,f=Math.sin(n*d)/u):(m=1-n,f=n),e[0]=m*s+f*h,e[1]=m*o+f*p,e[2]=m*c+f*i,e[3]=m*l+f*a,e}function ga(e){var t=q(),r=q(),n=q(),s=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=s*Math.sin(2*Math.PI*r),e[1]=s*Math.cos(2*Math.PI*r),e[2]=o*Math.sin(2*Math.PI*n),e[3]=o*Math.cos(2*Math.PI*n),e}function ba(e,t){var r=t[0],n=t[1],s=t[2],o=t[3],c=r*r+n*n+s*s+o*o,l=c?1/c:0;return e[0]=-r*l,e[1]=-n*l,e[2]=-s*l,e[3]=o*l,e}function ya(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function nn(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var s=0;t[4]>t[0]&&(s=1),t[8]>t[s*3+s]&&(s=2);var o=(s+1)%3,c=(s+2)%3;n=Math.sqrt(t[s*3+s]-t[o*3+o]-t[c*3+c]+1),e[s]=.5*n,n=.5/n,e[3]=(t[o*3+c]-t[c*3+o])*n,e[o]=(t[o*3+s]+t[s*3+o])*n,e[c]=(t[c*3+s]+t[s*3+c])*n}return e}function xa(e,t,r,n){var s=.5*Math.PI/180;t*=s,r*=s,n*=s;var o=Math.sin(t),c=Math.cos(t),l=Math.sin(r),h=Math.cos(r),p=Math.sin(n),i=Math.cos(n);return e[0]=o*h*i-c*l*p,e[1]=c*l*i+o*h*p,e[2]=c*h*p-o*l*i,e[3]=c*h*i+o*l*p,e}function wa(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Ma,Aa,dt,Ta,Sa,ja,sn,ht,Ia,_t,Ca,pt,Oa,qt,Pa,Ea,La,Ra,ka,Gt=A(()=>{pe();Er();Pt();Ut();Ma=Et,Aa=Lt,dt=Rt,Ta=kt,Sa=Bt,ja=en,sn=Ft,ht=Wt,Ia=Ht,_t=ot,Ca=_t,pt=ct,Oa=pt,qt=Dt,Pa=Nt,Ea=zt,La=function(){var e=it(),t=st(1,0,0),r=st(0,1,0);return function(n,s,o){var c=at(s,o);return c<-.999999?(He(e,t,s),Ot(e)<1e-6&&He(e,r,s),Ct(e,e),Qr(n,e,Math.PI),n):c>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(He(e,s,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+c,qt(n,n))}}(),Ra=function(){var e=Ne(),t=Ne();return function(r,n,s,o,c,l){return lt(e,n,c,l),lt(t,s,o,l),lt(r,e,t,2*l*(1-l)),r}}(),ka=function(){var e=Pr();return function(t,r,n,s){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=s[0],e[4]=s[1],e[7]=s[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],qt(t,nn(t,e))}}()});var ae={};W(ae,{add:()=>no,clone:()=>Fa,conjugate:()=>co,copy:()=>on,create:()=>Ba,dot:()=>ln,equals:()=>uo,exactEquals:()=>fo,fromMat4:()=>za,fromRotation:()=>Na,fromRotationTranslation:()=>an,fromRotationTranslationValues:()=>Wa,fromTranslation:()=>Ha,fromValues:()=>Da,getDual:()=>Ya,getReal:()=>Xa,getTranslation:()=>Ja,identity:()=>Ua,invert:()=>oo,len:()=>lo,length:()=>dn,lerp:()=>ao,mul:()=>io,multiply:()=>cn,normalize:()=>_o,rotateAroundAxis:()=>ro,rotateByQuatAppend:()=>eo,rotateByQuatPrepend:()=>to,rotateX:()=>$a,rotateY:()=>Ka,rotateZ:()=>Qa,scale:()=>so,set:()=>Va,setDual:()=>Ga,setReal:()=>qa,sqrLen:()=>ho,squaredLength:()=>ft,str:()=>po,translate:()=>Za});function Ba(){var e=new P(8);return P!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function Fa(e){var t=new P(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Da(e,t,r,n,s,o,c,l){var h=new P(8);return h[0]=e,h[1]=t,h[2]=r,h[3]=n,h[4]=s,h[5]=o,h[6]=c,h[7]=l,h}function Wa(e,t,r,n,s,o,c){var l=new P(8);l[0]=e,l[1]=t,l[2]=r,l[3]=n;var h=s*.5,p=o*.5,i=c*.5;return l[4]=h*n+p*r-i*t,l[5]=p*n+i*e-h*r,l[6]=i*n+h*t-p*e,l[7]=-h*e-p*t-i*r,l}function an(e,t,r){var n=r[0]*.5,s=r[1]*.5,o=r[2]*.5,c=t[0],l=t[1],h=t[2],p=t[3];return e[0]=c,e[1]=l,e[2]=h,e[3]=p,e[4]=n*p+s*h-o*l,e[5]=s*p+o*c-n*h,e[6]=o*p+n*l-s*c,e[7]=-n*c-s*l-o*h,e}function Ha(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0]*.5,e[5]=t[1]*.5,e[6]=t[2]*.5,e[7]=0,e}function Na(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function za(e,t){var r=Ne();jt(r,t);var n=new P(3);return St(n,t),an(e,r,n),e}function on(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Ua(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Va(e,t,r,n,s,o,c,l,h){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e[4]=o,e[5]=c,e[6]=l,e[7]=h,e}function Ya(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}function Ga(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function Ja(e,t){var r=t[4],n=t[5],s=t[6],o=t[7],c=-t[0],l=-t[1],h=-t[2],p=t[3];return e[0]=(r*p+o*c+n*h-s*l)*2,e[1]=(n*p+o*l+s*c-r*h)*2,e[2]=(s*p+o*h+r*l-n*c)*2,e}function Za(e,t,r){var n=t[0],s=t[1],o=t[2],c=t[3],l=r[0]*.5,h=r[1]*.5,p=r[2]*.5,i=t[4],a=t[5],d=t[6],_=t[7];return e[0]=n,e[1]=s,e[2]=o,e[3]=c,e[4]=c*l+s*p-o*h+i,e[5]=c*h+o*l-n*p+a,e[6]=c*p+n*h-s*l+d,e[7]=-n*l-s*h-o*p+_,e}function $a(e,t,r){var n=-t[0],s=-t[1],o=-t[2],c=t[3],l=t[4],h=t[5],p=t[6],i=t[7],a=l*c+i*n+h*o-p*s,d=h*c+i*s+p*n-l*o,_=p*c+i*o+l*s-h*n,u=i*c-l*n-h*s-p*o;return Vt(e,t,r),n=e[0],s=e[1],o=e[2],c=e[3],e[4]=a*c+u*n+d*o-_*s,e[5]=d*c+u*s+_*n-a*o,e[6]=_*c+u*o+a*s-d*n,e[7]=u*c-a*n-d*s-_*o,e}function Ka(e,t,r){var n=-t[0],s=-t[1],o=-t[2],c=t[3],l=t[4],h=t[5],p=t[6],i=t[7],a=l*c+i*n+h*o-p*s,d=h*c+i*s+p*n-l*o,_=p*c+i*o+l*s-h*n,u=i*c-l*n-h*s-p*o;return Xt(e,t,r),n=e[0],s=e[1],o=e[2],c=e[3],e[4]=a*c+u*n+d*o-_*s,e[5]=d*c+u*s+_*n-a*o,e[6]=_*c+u*o+a*s-d*n,e[7]=u*c-a*n-d*s-_*o,e}function Qa(e,t,r){var n=-t[0],s=-t[1],o=-t[2],c=t[3],l=t[4],h=t[5],p=t[6],i=t[7],a=l*c+i*n+h*o-p*s,d=h*c+i*s+p*n-l*o,_=p*c+i*o+l*s-h*n,u=i*c-l*n-h*s-p*o;return Yt(e,t,r),n=e[0],s=e[1],o=e[2],c=e[3],e[4]=a*c+u*n+d*o-_*s,e[5]=d*c+u*s+_*n-a*o,e[6]=_*c+u*o+a*s-d*n,e[7]=u*c-a*n-d*s-_*o,e}function eo(e,t,r){var n=r[0],s=r[1],o=r[2],c=r[3],l=t[0],h=t[1],p=t[2],i=t[3];return e[0]=l*c+i*n+h*o-p*s,e[1]=h*c+i*s+p*n-l*o,e[2]=p*c+i*o+l*s-h*n,e[3]=i*c-l*n-h*s-p*o,l=t[4],h=t[5],p=t[6],i=t[7],e[4]=l*c+i*n+h*o-p*s,e[5]=h*c+i*s+p*n-l*o,e[6]=p*c+i*o+l*s-h*n,e[7]=i*c-l*n-h*s-p*o,e}function to(e,t,r){var n=t[0],s=t[1],o=t[2],c=t[3],l=r[0],h=r[1],p=r[2],i=r[3];return e[0]=n*i+c*l+s*p-o*h,e[1]=s*i+c*h+o*l-n*p,e[2]=o*i+c*p+n*h-s*l,e[3]=c*i-n*l-s*h-o*p,l=r[4],h=r[5],p=r[6],i=r[7],e[4]=n*i+c*l+s*p-o*h,e[5]=s*i+c*h+o*l-n*p,e[6]=o*i+c*p+n*h-s*l,e[7]=c*i-n*l-s*h-o*p,e}function ro(e,t,r,n){if(Math.abs(n)<j)return on(e,t);var s=Math.hypot(r[0],r[1],r[2]);n=n*.5;var o=Math.sin(n),c=o*r[0]/s,l=o*r[1]/s,h=o*r[2]/s,p=Math.cos(n),i=t[0],a=t[1],d=t[2],_=t[3];e[0]=i*p+_*c+a*h-d*l,e[1]=a*p+_*l+d*c-i*h,e[2]=d*p+_*h+i*l-a*c,e[3]=_*p-i*c-a*l-d*h;var u=t[4],m=t[5],f=t[6],v=t[7];return e[4]=u*p+v*c+m*h-f*l,e[5]=m*p+v*l+f*c-u*h,e[6]=f*p+v*h+u*l-m*c,e[7]=v*p-u*c-m*l-f*h,e}function no(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e}function cn(e,t,r){var n=t[0],s=t[1],o=t[2],c=t[3],l=r[4],h=r[5],p=r[6],i=r[7],a=t[4],d=t[5],_=t[6],u=t[7],m=r[0],f=r[1],v=r[2],b=r[3];return e[0]=n*b+c*m+s*v-o*f,e[1]=s*b+c*f+o*m-n*v,e[2]=o*b+c*v+n*f-s*m,e[3]=c*b-n*m-s*f-o*v,e[4]=n*i+c*l+s*p-o*h+a*b+u*m+d*v-_*f,e[5]=s*i+c*h+o*l-n*p+d*b+u*f+_*m-a*v,e[6]=o*i+c*p+n*h-s*l+_*b+u*v+a*f-d*m,e[7]=c*i-n*l-s*h-o*p+u*b-a*m-d*f-_*v,e}function so(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e}function ao(e,t,r,n){var s=1-n;return ln(t,r)<0&&(n=-n),e[0]=t[0]*s+r[0]*n,e[1]=t[1]*s+r[1]*n,e[2]=t[2]*s+r[2]*n,e[3]=t[3]*s+r[3]*n,e[4]=t[4]*s+r[4]*n,e[5]=t[5]*s+r[5]*n,e[6]=t[6]*s+r[6]*n,e[7]=t[7]*s+r[7]*n,e}function oo(e,t){var r=ft(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e}function co(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}function _o(e,t){var r=ft(t);if(r>0){r=Math.sqrt(r);var n=t[0]/r,s=t[1]/r,o=t[2]/r,c=t[3]/r,l=t[4],h=t[5],p=t[6],i=t[7],a=n*l+s*h+o*p+c*i;e[0]=n,e[1]=s,e[2]=o,e[3]=c,e[4]=(l-n*a)/r,e[5]=(h-s*a)/r,e[6]=(p-o*a)/r,e[7]=(i-c*a)/r}return e}function po(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function fo(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function uo(e,t){var r=e[0],n=e[1],s=e[2],o=e[3],c=e[4],l=e[5],h=e[6],p=e[7],i=t[0],a=t[1],d=t[2],_=t[3],u=t[4],m=t[5],f=t[6],v=t[7];return Math.abs(r-i)<=j*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=j*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(s-d)<=j*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(o-_)<=j*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(c-u)<=j*Math.max(1,Math.abs(c),Math.abs(u))&&Math.abs(l-m)<=j*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(h-f)<=j*Math.max(1,Math.abs(h),Math.abs(f))&&Math.abs(p-v)<=j*Math.max(1,Math.abs(p),Math.abs(v))}var Xa,qa,io,ln,dn,lo,ft,ho,hn=A(()=>{pe();Gt();It();Xa=dt;qa=dt;io=cn;ln=ht;dn=_t,lo=dn,ft=pt,ho=ft});var te=A(()=>{It();Gt();hn();Pt();Ut()});var mo={};var _n=A(()=>{te();WL.registerComponent("cursor",{collisionGroup:{type:WL.Type.Int,default:1},cursorRayObject:{type:WL.Type.Object},cursorRayScalingAxis:{type:WL.Type.Enum,values:["x","y","z","none"],default:"z"},cursorObject:{type:WL.Type.Object},handedness:{type:WL.Type.Enum,values:["input component","left","right","none"],default:"input component"},rayCastMode:{type:WL.Type.Enum,values:["collision","physx"],default:"collision"},styleCursor:{type:WL.Type.Bool,default:!0}},{init:function(){this.session=null,this.collisionMask=1<<this.collisionGroup,this.maxDistance=100;let e=this.onDestroy.bind(this);WL.onSceneLoaded.push(e),this.onDestroyCallbacks=[()=>{let t=WL.onSceneLoaded.indexOf(e);t>=0&&WL.onSceneLoaded.splice(t,1)}]},start:function(){if(this.handedness==0){let t=this.object.getComponent("input");t?(this.handedness=t.handedness,this.input=t):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];if(this.globalTarget=this.object.addComponent("cursor-target"),this.origin=new Float32Array(3),this.cursorObjScale=new Float32Array(3),this.direction=[0,0,0],this.tempQuat=new Float32Array(4),this.viewComponent=this.object.getComponent("view"),this.viewComponent!=null){let t=this.onClick.bind(this);WL.canvas.addEventListener("click",t);let r=this.onPointerMove.bind(this);WL.canvas.addEventListener("pointermove",r);let n=this.onPointerDown.bind(this);WL.canvas.addEventListener("pointerdown",n);let s=this.onPointerUp.bind(this);WL.canvas.addEventListener("pointerup",s),this.projectionMatrix=new Float32Array(16),we.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let o=this.onViewportResize.bind(this);window.addEventListener("resize",o),this.onDestroyCallbacks.push(()=>{WL.canvas.removeEventListener("click",t),WL.canvas.removeEventListener("pointermove",r),WL.canvas.removeEventListener("pointerdown",n),WL.canvas.removeEventListener("pointerup",s),window.removeEventListener("resize",o)})}this.isHovering=!1,this.visible=!0,this.isDown=!1,this.lastIsDown=!1,this.cursorPos=new Float32Array(3),this.hoveringObject=null;let e=this.setupVREvents.bind(this);WL.onXRSessionStart.push(e),this.onDestroyCallbacks.push(()=>{let t=WL.onXRSessionStart.indexOf(e);t>=0&&WL.onXRSessionStart.splice(t,1)}),this.cursorRayObject&&(this.cursorRayScale=new Float32Array(3),this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction),this._setCursorRayTransform([this.origin[0]+this.direction[0],this.origin[1]+this.direction[1],this.origin[2]+this.direction[2]]))},onViewportResize:function(){this.viewComponent&&we.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)},_setCursorRayTransform:function(e){if(!this.cursorRayObject)return;let t=E.dist(this.origin,e);this.cursorRayObject.setTranslationLocal([0,0,-t/2]),this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),this.cursorRayScale[this.cursorRayScalingAxis]=t/2,this.cursorRayObject.scale(this.cursorRayScale))},_setCursorVisibility:function(e){this.visible!=e&&(this.visible=e,this.cursorObject&&(e?(this.cursorObject.resetScaling(),this.cursorObject.scale(this.cursorObjScale)):(this.cursorObjScale.set(this.cursorObject.scalingLocal),this.cursorObject.scale([0,0,0]))))},update:function(){this.doUpdate(!1)},doUpdate:function(e){if(this.session){if(this.arTouchDown&&this.input&&WL.xrSession.inputSources[0].handedness==="none"&&WL.xrSession.inputSources[0].gamepad){let r=WL.xrSession.inputSources[0].gamepad.axes;this.direction=[r[0],-r[1],-1],this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let t=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);t.hitCount>0?this.cursorPos.set(t.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(t,e)}this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):this._setCursorVisibility(!1))},hoverBehaviour:function(e,t){if(e.hitCount>0){if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let s=this.hoveringObject.getComponent("cursor-target");s&&s.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.hoveringObject=e.objects[0],this.styleCursor&&(WL.canvas.style.cursor="pointer");let n=this.hoveringObject.getComponent("cursor-target");n&&(this.hoveringObjectTarget=n,n.onHover(this.hoveringObject,this)),this.globalTarget.onHover(this.hoveringObject,this)}this.hoveringObjectTarget&&this.hoveringObjectTarget.onMove(this.hoveringObject,this);let r=this.hoveringObject.getComponent("cursor-target");this.isDown!==this.lastIsDown&&(this.isDown?(r&&r.onDown(this.hoveringObject,this),this.globalTarget.onDown(this.hoveringObject,this)):(r&&r.onUp(this.hoveringObject,this),this.globalTarget.onUp(this.hoveringObject,this))),t&&(r&&r.onClick(this.hoveringObject,this),this.globalTarget.onClick(this.hoveringObject,this))}else if(this.hoveringObject&&e.hitCount==0){let r=this.hoveringObject.getComponent("cursor-target");r&&r.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(WL.canvas.style.cursor="default")}this.lastIsDown=this.isDown},setupVREvents:function(e){this.session=e;let t=function(o){this.session=null}.bind(this);e.addEventListener("end",t);let r=this.onSelect.bind(this);e.addEventListener("select",r);let n=this.onSelectStart.bind(this);e.addEventListener("selectstart",n);let s=this.onSelectEnd.bind(this);e.addEventListener("selectend",s),this.onDestroyCallbacks.push(()=>{this.session&&(e.removeEventListener("end",t),e.removeEventListener("select",r),e.removeEventListener("selectstart",n),e.removeEventListener("selectend",s))}),this.onViewportResize()},onSelect:function(e){e.inputSource.handedness==this.handedness&&this.doUpdate(!0)},onSelectStart:function(e){this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)},onSelectEnd:function(e){this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown=!1)},onPointerMove:function(e){if(!e.isPrimary)return;let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.hoverBehaviour(r,!1)},onClick:function(e){let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.hoverBehaviour(r,!0)},onPointerDown:function(e){if(!e.isPrimary||e.button!==0)return;let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown=!0,this.hoverBehaviour(r,!1)},onPointerUp:function(e){if(!e.isPrimary||e.button!==0)return;let t=e.target.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown=!1,this.hoverBehaviour(r,!1)},updateMousePos:function(e,t,r,n){let s=e/r,o=t/n;return this.direction=[s*2-1,-o*2+1,-1],this.updateDirection()},updateDirection:function(){this.object.getTranslationWorld(this.origin),E.transformMat4(this.direction,this.direction,this.projectionMatrix),E.normalize(this.direction,this.direction),E.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e},onDeactivate:function(){if(this._setCursorVisibility(!1),this.hoveringObject){let e=this.hoveringObject.getComponent("cursor-target");e&&e.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.cursorRayObject&&this.cursorRayObject.scale([0,0,0])},onActivate:function(){this._setCursorVisibility(!0)},onDestroy:function(){for(let e of this.onDestroyCallbacks)e()}})});var vo={};var pn=A(()=>{te();WL.registerComponent("mouse-look",{sensitity:{type:WL.Type.Float,default:.25},requireMouseDown:{type:WL.Type.Bool,default:!0},mouseButtonIndex:{type:WL.Type.Int,default:0},pointerLockOnClick:{type:WL.Type.Bool,default:!1}},{init:function(){this.currentRotationY=0,this.currentRotationX=0,this.origin=new Float32Array(3),this.parentOrigin=new Float32Array(3),document.addEventListener("mousemove",function(e){if(this.active&&(this.mouseDown||!this.requireMouseDown)){this.rotationY=-this.sensitity*e.movementX/100,this.rotationX=-this.sensitity*e.movementY/100,this.currentRotationX+=this.rotationX,this.currentRotationY+=this.rotationY,this.currentRotationX=Math.min(1.507,this.currentRotationX),this.currentRotationX=Math.max(-1.507,this.currentRotationX),this.object.getTranslationWorld(this.origin);let t=this.object.parent;t!==null&&(t.getTranslationWorld(this.parentOrigin),E.sub(this.origin,this.origin,this.parentOrigin)),this.object.resetTranslationRotation(),this.object.rotateAxisAngleRad([1,0,0],this.currentRotationX),this.object.rotateAxisAngleRad([0,1,0],this.currentRotationY),this.object.translate(this.origin)}}.bind(this)),this.pointerLockOnClick&&WL.canvas.addEventListener("mousedown",()=>{WL.canvas.requestPointerLock=WL.canvas.requestPointerLock||WL.canvas.mozRequestPointerLock||WL.canvas.webkitRequestPointerLock,WL.canvas.requestPointerLock()}),this.requireMouseDown&&(this.mouseButtonIndex==2&&WL.canvas.addEventListener("contextmenu",function(e){e.preventDefault()},!1),WL.canvas.addEventListener("mousedown",function(e){if(e.button==this.mouseButtonIndex&&(this.mouseDown=!0,document.body.style.cursor="grabbing",e.button==1))return e.preventDefault(),!1}.bind(this)),WL.canvas.addEventListener("mouseup",function(e){e.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}.bind(this)))},start:function(){this.rotationX=0,this.rotationY=0}})});var fn=We(()=>{WL.registerComponent("player-height",{height:{type:WL.Type.Float,default:1.75}},{init:function(){WL.onXRSessionStart.push(this.onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))},start:function(){this.object.resetTranslationRotation(),this.object.translate([0,this.height,0])},onXRSessionStart:function(){["local","viewer"].includes(WebXR.refSpace)||this.object.resetTranslationRotation()},onXRSessionEnd:function(){["local","viewer"].includes(WebXR.refSpace)||(this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]))}})});var go={};var un=A(()=>{te();WL.registerComponent("hand-tracking",{handedness:{type:WL.Type.Enum,default:"left",values:["left","right"]},jointMesh:{type:WL.Type.Mesh,default:null},jointMaterial:{type:WL.Type.Material,default:null},handSkin:{type:WL.Type.Skin,default:null},deactivateChildrenWithoutPose:{type:WL.Type.Bool,default:!0},controllerToDeactivate:{type:WL.Type.Object}},{ORDERED_JOINTS:["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],init:function(){this.handedness=["left","right"][this.handedness]},start:function(){if(this.joints=[],this.session=null,this.hasPose=!1,this._childrenActive=!0,!("XRHand"in window)){console.warn("WebXR Hand Tracking not supported by this browser."),this.active=!1;return}if(this.handSkin){let t=this.handSkin.jointIds;this.joints[this.ORDERED_JOINTS[0]]=new WL.Object(t[0]);for(let r=0;r<t.length;++r){let n=new WL.Object(t[r]);this.joints[n.name]=n}return}for(let e=0;e<=this.ORDERED_JOINTS.length;++e){let t=WL.scene.addObject(this.object.parent),r=t.addComponent("mesh");r.mesh=this.jointMesh,r.material=this.jointMaterial,this.joints[this.ORDERED_JOINTS[e]]=t}},update:function(e){if(this.session||WL.xrSession&&this.setupVREvents(WL.xrSession),!!this.session){if(this.hasPose=!1,this.session&&this.session.inputSources)for(let t=0;t<=this.session.inputSources.length;++t){let r=this.session.inputSources[t];if(!r||!r.hand||r.handedness!=this.handedness)continue;if(this.hasPose=!0,r.hand.get("wrist")!==null){let o=Module.webxr_frame.getJointPose(r.hand.get("wrist"),WebXR.refSpaces[WebXR.refSpace]);o&&(this.object.resetTranslationRotation(),this.object.transformLocal.set([o.transform.orientation.x,o.transform.orientation.y,o.transform.orientation.z,o.transform.orientation.w]),this.object.translate([o.transform.position.x,o.transform.position.y,o.transform.position.z]))}let n=new Float32Array(3),s=new Float32Array(4);ze.invert(s,this.object.transformLocal),this.object.getTranslationLocal(n);for(let o=0;o<this.ORDERED_JOINTS.length;++o){let c=this.ORDERED_JOINTS[o],l=this.joints[c];if(l==null)continue;let h=null;if(r.hand.get(c)!==null&&(h=Module.webxr_frame.getJointPose(r.hand.get(c),WebXR.refSpaces[WebXR.refSpace])),h!==null)if(this.handSkin)l.resetTranslationRotation(),l.translate([h.transform.position.x-n[0],h.transform.position.y-n[1],h.transform.position.z-n[2]]),l.rotate(s),l.rotateObject([h.transform.orientation.x,h.transform.orientation.y,h.transform.orientation.z,h.transform.orientation.w]);else{l.resetTransform(),l.transformLocal.set([h.transform.orientation.x,h.transform.orientation.y,h.transform.orientation.z,h.transform.orientation.w]),l.translate([h.transform.position.x,h.transform.position.y,h.transform.position.z]);let p=h.radius||.007;l.scale([p,p,p])}else this.handSkin||l.scale([0,0,0])}}!this.hasPose&&this._childrenActive?(this._childrenActive=!1,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!1),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!0,this.setChildrenActive(!0,this.controllerToDeactivate))):this.hasPose&&!this._childrenActive&&(this._childrenActive=!0,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!0),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!1,this.setChildrenActive(!1,this.controllerToDeactivate)))}},setChildrenActive:function(e,t){t=t||this.object;let r=t.children;for(let n of r)n.active=e,this.setChildrenActive(e,n)},isGrabbing:function(){let e=[0,0,0];ae.getTranslation(e,this.joints["index-finger-tip"].transformLocal);let t=[0,0,0];return ae.getTranslation(t,this.joints["thumb-tip"].transformLocal),E.sqrDist(t,e)<.001},setupVREvents:function(e){this.session=e}})});var bo={};var mn=A(()=>{te();WL.registerComponent("teleport",{teleportIndicatorMeshObject:{type:WL.Type.Object},camRoot:{type:WL.Type.Object},cam:{type:WL.Type.Object},eyeLeft:{type:WL.Type.Object},eyeRight:{type:WL.Type.Object},handedness:{type:WL.Type.Enum,values:["input component","left","right","none"],default:"input component"},floorGroup:{type:WL.Type.Int,default:1},thumbstickActivationThreshhold:{type:WL.Type.Float,default:-.7},thumbstickDeactivationThreshhold:{type:WL.Type.Float,default:.3},indicatorYOffset:{type:WL.Type.Float,default:.01},rayCastMode:{type:WL.Type.Enum,values:["collision","physx"],default:"collision"},maxDistance:{type:WL.Type.Float,default:100}},{init:function(){if(this._prevThumbstickAxis=new Float32Array(2),this._tempVec=new Float32Array(3),this._tempVec0=new Float32Array(3),this._currentIndicatorRotation=0,this.input=this.object.getComponent("input"),!this.input){console.error(this.object.name,"generic-teleport-component.js: input component is required on the object");return}if(!this.teleportIndicatorMeshObject){console.error(this.object.name,"generic-teleport-component.js: Teleport indicator mesh is missing");return}if(!this.camRoot){console.error(this.object.name,"generic-teleport-component.js: camRoot not set");return}this.isIndicating=!1,this.cam&&(this.isMouseIndicating=!1,WL.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),WL.canvas.addEventListener("mouseup",this.onMouseUp.bind(this))),this.indicatorHidden=!0,this.hitSpot=new Float32Array(3),this._hasHit=!1,this._extraRotation=0,this._currentStickAxes=new Float32Array(2)},start:function(){if(this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("teleport component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];WL.onXRSessionStart.push(this.setupVREvents.bind(this)),this.teleportIndicatorMeshObject.active=!1},_getCamRotation:function(){return this.eyeLeft.getForward(this._tempVec),this._tempVec[1]=0,E.normalize(this._tempVec,this._tempVec),Math.atan2(this._tempVec[0],this._tempVec[2])},update:function(){let e=0;if(this.gamepad&&this.gamepad.axes&&(this._currentStickAxes[0]=this.gamepad.axes[2],this._currentStickAxes[1]=this.gamepad.axes[3],e=Math.abs(this._currentStickAxes[0])+Math.abs(this._currentStickAxes[1])),!this.isIndicating&&this._prevThumbstickAxis[1]>=this.thumbstickActivationThreshhold&&this._currentStickAxes[1]<this.thumbstickActivationThreshhold?this.isIndicating=!0:this.isIndicating&&e<this.thumbstickDeactivationThreshhold&&(this.isIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,this._extraRotation)),this.isIndicating&&this.teleportIndicatorMeshObject&&this.input){let t=this._tempVec0;ae.getTranslation(t,this.object.transformWorld);let r=this.object.getForward(this._tempVec),n=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(t,r,1<<this.floorGroup):WL.physics.rayCast(t,r,1<<this.floorGroup,this.maxDistance);n.hitCount>0?(this.indicatorHidden=!1,this._extraRotation=Math.PI+Math.atan2(this._currentStickAxes[0],this._currentStickAxes[1]),this._currentIndicatorRotation=this._getCamRotation()+(this._extraRotation-Math.PI),this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(n.locations[0]),this.teleportIndicatorMeshObject.translate([0,this.indicatorYOffset,0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot.set(n.locations[0]),this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}else this.teleportIndicatorMeshObject&&this.isMouseIndicating&&this.onMousePressed();this._prevThumbstickAxis.set(this._currentStickAxes)},setupVREvents:function(e){if(this.session=e,e.addEventListener("end",function(){this.gamepad=null,this.session=null}.bind(this)),e.inputSources&&e.inputSources.length)for(let t=0;t<e.inputSources.length;t++){let r=e.inputSources[t];r.handedness==this.handedness&&(this.gamepad=r.gamepad)}e.addEventListener("inputsourceschange",function(t){if(t.added&&t.added.length)for(let r=0;r<t.added.length;r++){let n=t.added[r];n.handedness==this.handedness&&(this.gamepad=n.gamepad)}}.bind(this))},onMouseDown:function(){this.isMouseIndicating=!0},onMouseUp:function(){this.isMouseIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,0)},onMousePressed:function(){let e=[0,0,0];ae.getTranslation(e,this.cam.transformWorld);let t=this.cam.getForward(this._tempVec),r=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(e,t,1<<this.floorGroup):WL.physics.rayCast(e,t,1<<this.floorGroup,this.maxDistance);r.hitCount>0?(this.indicatorHidden=!1,t[1]=0,E.normalize(t,t),this._currentIndicatorRotation=-Math.sign(t[2])*Math.acos(t[0])-Math.PI*.5,this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(r.locations[0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot=r.locations[0],this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)},_teleportPlayer:function(e,t){this.camRoot.rotateAxisAngleRad([0,1,0],t);let r=this._tempVec,n=this._tempVec0;this.session?(this.eyeLeft.getTranslationWorld(r),this.eyeRight.getTranslationWorld(n),E.add(r,r,n),E.scale(r,r,.5)):this.cam.getTranslationWorld(r),this.camRoot.getTranslationWorld(n),E.sub(r,n,r),r[0]+=e[0],r[1]=e[1],r[2]+=e[2],this.camRoot.setTranslationWorld(r)}})});var vn=We(()=>{WL.registerComponent("vr-mode-active-switch",{activateComponents:{type:WL.Type.Enum,values:["in VR","in non-VR"],default:"in VR"},affectChildren:{type:WL.Type.Bool,default:!0}},{start:function(){this.components=[],this.getComponents(this.object),this.onXRSessionEnd(),WL.onXRSessionStart.push(this.onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))},getComponents:function(e){let t=e.getComponents().filter(r=>r.type!="vr-mode-active-switch");if(this.components=this.components.concat(t),this.affectChildren){let r=e.children;for(let n=0;n<r.length;++n)this.getComponents(r[n])}},setComponentsActive:function(e){let t=this.components;for(let r=0;r<t.length;++r)t[r].active=e},onXRSessionStart:function(){this.active&&this.setComponentsActive(this.activateComponents==0)},onXRSessionEnd:function(){this.active&&this.setComponentsActive(this.activateComponents!=0)}})});var Jt=We(ut=>{(function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var i=this||t;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var a=this||t;if(i=parseFloat(i),a.ctx||p(),typeof i<"u"&&i>=0&&i<=1){if(a._volume=i,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i,t.ctx.currentTime);for(var d=0;d<a._howls.length;d++)if(!a._howls[d]._webAudio)for(var _=a._howls[d]._getSoundIds(),u=0;u<_.length;u++){var m=a._howls[d]._soundById(_[u]);m&&m._node&&(m._node.volume=m._volume*i)}return a}return a._volume},mute:function(i){var a=this||t;a.ctx||p(),a._muted=i,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i?0:a._volume,t.ctx.currentTime);for(var d=0;d<a._howls.length;d++)if(!a._howls[d]._webAudio)for(var _=a._howls[d]._getSoundIds(),u=0;u<_.length;u++){var m=a._howls[d]._soundById(_[u]);m&&m._node&&(m._node.muted=i?!0:m._muted)}return a},stop:function(){for(var i=this||t,a=0;a<i._howls.length;a++)i._howls[a].stop();return i},unload:function(){for(var i=this||t,a=i._howls.length-1;a>=0;a--)i._howls[a].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,p()),i},codecs:function(i){return(this||t)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||t;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var a=new Audio;a.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||t,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return i}if(!a||typeof a.canPlayType!="function")return i;var d=a.canPlayType("audio/mpeg;").replace(/^no$/,""),_=i._navigator?i._navigator.userAgent:"",u=_.match(/OPR\/([0-6].)/g),m=u&&parseInt(u[0].split("/")[1],10)<33,f=_.indexOf("Safari")!==-1&&_.indexOf("Chrome")===-1,v=_.match(/Version\/(.*?) /),b=f&&v&&parseInt(v[1],10)<15;return i._codecs={mp3:!!(!m&&(d||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!d,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||t;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var a=function(d){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var _=new Audio;_._unlocked=!0,i._releaseHtml5Audio(_)}catch{i.noAudio=!0;break}for(var u=0;u<i._howls.length;u++)if(!i._howls[u]._webAudio)for(var m=i._howls[u]._getSoundIds(),f=0;f<m.length;f++){var v=i._howls[u]._soundById(m[f]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}i._autoResume();var b=i.ctx.createBufferSource();b.buffer=i._scratchBuffer,b.connect(i.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),b.onended=function(){b.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var x=0;x<i._howls.length;x++)i._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),i}},_obtainHtml5Audio:function(){var i=this||t;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var a=this||t;return i._unlocked&&a._html5AudioPool.push(i),a},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!t.usingWebAudio)){for(var a=0;a<i._howls.length;a++)if(i._howls[a]._webAudio){for(var d=0;d<i._howls[a]._sounds.length;d++)if(!i._howls[a]._sounds[d]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var _=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(_,_)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!t.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var a=0;a<i._howls.length;a++)i._howls[a]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var t=new e,r=function(i){var a=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(i)};r.prototype={init:function(i){var a=this;return t.ctx||p(),a._autoplay=i.autoplay||!1,a._format=typeof i.format!="string"?i.format:[i.format],a._html5=i.html5||!1,a._muted=i.mute||!1,a._loop=i.loop||!1,a._pool=i.pool||5,a._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,a._rate=i.rate||1,a._sprite=i.sprite||{},a._src=typeof i.src!="string"?i.src:[i.src],a._volume=i.volume!==void 0?i.volume:1,a._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=i.onend?[{fn:i.onend}]:[],a._onfade=i.onfade?[{fn:i.onfade}]:[],a._onload=i.onload?[{fn:i.onload}]:[],a._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],a._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],a._onpause=i.onpause?[{fn:i.onpause}]:[],a._onplay=i.onplay?[{fn:i.onplay}]:[],a._onstop=i.onstop?[{fn:i.onstop}]:[],a._onmute=i.onmute?[{fn:i.onmute}]:[],a._onvolume=i.onvolume?[{fn:i.onvolume}]:[],a._onrate=i.onrate?[{fn:i.onrate}]:[],a._onseek=i.onseek?[{fn:i.onseek}]:[],a._onunlock=i.onunlock?[{fn:i.onunlock}]:[],a._onresume=[],a._webAudio=t.usingWebAudio&&!a._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var i=this,a=null;if(t.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var d=0;d<i._src.length;d++){var _,u;if(i._format&&i._format[d])_=i._format[d];else{if(u=i._src[d],typeof u!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}_=/^data:audio\/([^;,]+);/i.exec(u),_||(_=/\.([^.]+)$/.exec(u.split("?",1)[0])),_&&(_=_[1].toLowerCase())}if(_||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),_&&t.codecs(_)){a=i._src[d];break}}if(!a){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=a,i._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new n(i),i._webAudio&&o(i),i},play:function(i,a){var d=this,_=null;if(typeof i=="number")_=i,i=null;else{if(typeof i=="string"&&d._state==="loaded"&&!d._sprite[i])return null;if(typeof i>"u"&&(i="__default",!d._playLock)){for(var u=0,m=0;m<d._sounds.length;m++)d._sounds[m]._paused&&!d._sounds[m]._ended&&(u++,_=d._sounds[m]._id);u===1?i=null:_=null}}var f=_?d._soundById(_):d._inactiveSound();if(!f)return null;if(_&&!i&&(i=f._sprite||"__default"),d._state!=="loaded"){f._sprite=i,f._ended=!1;var v=f._id;return d._queue.push({event:"play",action:function(){d.play(v)}}),v}if(_&&!f._paused)return a||d._loadQueue("play"),f._id;d._webAudio&&t._autoResume();var b=Math.max(0,f._seek>0?f._seek:d._sprite[i][0]/1e3),x=Math.max(0,(d._sprite[i][0]+d._sprite[i][1])/1e3-b),w=x*1e3/Math.abs(f._rate),M=d._sprite[i][0]/1e3,T=(d._sprite[i][0]+d._sprite[i][1])/1e3;f._sprite=i,f._ended=!1;var L=function(){f._paused=!1,f._seek=b,f._start=M,f._stop=T,f._loop=!!(f._loop||d._sprite[i][2])};if(b>=T){d._ended(f);return}var S=f._node;if(d._webAudio){var R=function(){d._playLock=!1,L(),d._refreshBuffer(f);var B=f._muted||d._muted?0:f._volume;S.gain.setValueAtTime(B,t.ctx.currentTime),f._playStart=t.ctx.currentTime,typeof S.bufferSource.start>"u"?f._loop?S.bufferSource.noteGrainOn(0,b,86400):S.bufferSource.noteGrainOn(0,b,x):f._loop?S.bufferSource.start(0,b,86400):S.bufferSource.start(0,b,x),w!==1/0&&(d._endTimers[f._id]=setTimeout(d._ended.bind(d,f),w)),a||setTimeout(function(){d._emit("play",f._id),d._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?R():(d._playLock=!0,d.once("resume",R),d._clearTimer(f._id))}else{var k=function(){S.currentTime=b,S.muted=f._muted||d._muted||t._muted||S.muted,S.volume=f._volume*t.volume(),S.playbackRate=f._rate;try{var B=S.play();if(B&&typeof Promise<"u"&&(B instanceof Promise||typeof B.then=="function")?(d._playLock=!0,L(),B.then(function(){d._playLock=!1,S._unlocked=!0,a?d._loadQueue():d._emit("play",f._id)}).catch(function(){d._playLock=!1,d._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):a||(d._playLock=!1,L(),d._emit("play",f._id)),S.playbackRate=f._rate,S.paused){d._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||f._loop?d._endTimers[f._id]=setTimeout(d._ended.bind(d,f),w):(d._endTimers[f._id]=function(){d._ended(f),S.removeEventListener("ended",d._endTimers[f._id],!1)},S.addEventListener("ended",d._endTimers[f._id],!1))}catch(O){d._emit("playerror",f._id,O)}};S.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(S.src=d._src,S.load());var H=window&&window.ejecta||!S.readyState&&t._navigator.isCocoonJS;if(S.readyState>=3||H)k();else{d._playLock=!0,d._state="loading";var D=function(){d._state="loaded",k(),S.removeEventListener(t._canPlayEvent,D,!1)};S.addEventListener(t._canPlayEvent,D,!1),d._clearTimer(f._id)}}return f._id},pause:function(i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(i)}}),a;for(var d=a._getSoundIds(i),_=0;_<d.length;_++){a._clearTimer(d[_]);var u=a._soundById(d[_]);if(u&&!u._paused&&(u._seek=a.seek(d[_]),u._rateSeek=0,u._paused=!0,a._stopFade(d[_]),u._node))if(a._webAudio){if(!u._node.bufferSource)continue;typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),a._cleanBuffer(u._node)}else(!isNaN(u._node.duration)||u._node.duration===1/0)&&u._node.pause();arguments[1]||a._emit("pause",u?u._id:null)}return a},stop:function(i,a){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(i)}}),d;for(var _=d._getSoundIds(i),u=0;u<_.length;u++){d._clearTimer(_[u]);var m=d._soundById(_[u]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,d._stopFade(_[u]),m._node&&(d._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),d._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&d._clearSound(m._node))),a||d._emit("stop",m._id))}return d},mute:function(i,a){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"mute",action:function(){d.mute(i,a)}}),d;if(typeof a>"u")if(typeof i=="boolean")d._muted=i;else return d._muted;for(var _=d._getSoundIds(a),u=0;u<_.length;u++){var m=d._soundById(_[u]);m&&(m._muted=i,m._interval&&d._stopFade(m._id),d._webAudio&&m._node?m._node.gain.setValueAtTime(i?0:m._volume,t.ctx.currentTime):m._node&&(m._node.muted=t._muted?!0:i),d._emit("mute",m._id))}return d},volume:function(){var i=this,a=arguments,d,_;if(a.length===0)return i._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var u=i._getSoundIds(),m=u.indexOf(a[0]);m>=0?_=parseInt(a[0],10):d=parseFloat(a[0])}else a.length>=2&&(d=parseFloat(a[0]),_=parseInt(a[1],10));var f;if(typeof d<"u"&&d>=0&&d<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,a)}}),i;typeof _>"u"&&(i._volume=d),_=i._getSoundIds(_);for(var v=0;v<_.length;v++)f=i._soundById(_[v]),f&&(f._volume=d,a[2]||i._stopFade(_[v]),i._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(d,t.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=d*t.volume()),i._emit("volume",f._id))}else return f=_?i._soundById(_):i._sounds[0],f?f._volume:0;return i},fade:function(i,a,d,_){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"fade",action:function(){u.fade(i,a,d,_)}}),u;i=Math.min(Math.max(0,parseFloat(i)),1),a=Math.min(Math.max(0,parseFloat(a)),1),d=parseFloat(d),u.volume(i,_);for(var m=u._getSoundIds(_),f=0;f<m.length;f++){var v=u._soundById(m[f]);if(v){if(_||u._stopFade(m[f]),u._webAudio&&!v._muted){var b=t.ctx.currentTime,x=b+d/1e3;v._volume=i,v._node.gain.setValueAtTime(i,b),v._node.gain.linearRampToValueAtTime(a,x)}u._startFadeInterval(v,i,a,d,m[f],typeof _>"u")}}return u},_startFadeInterval:function(i,a,d,_,u,m){var f=this,v=a,b=d-a,x=Math.abs(b/.01),w=Math.max(4,x>0?_/x:_),M=Date.now();i._fadeTo=d,i._interval=setInterval(function(){var T=(Date.now()-M)/_;M=Date.now(),v+=b*T,v=Math.round(v*100)/100,b<0?v=Math.max(d,v):v=Math.min(d,v),f._webAudio?i._volume=v:f.volume(v,i._id,!0),m&&(f._volume=v),(d<a&&v<=d||d>a&&v>=d)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,f.volume(d,i._id),f._emit("fade",i._id))},w)},_stopFade:function(i){var a=this,d=a._soundById(i);return d&&d._interval&&(a._webAudio&&d._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(d._interval),d._interval=null,a.volume(d._fadeTo,i),d._fadeTo=null,a._emit("fade",i)),a},loop:function(){var i=this,a=arguments,d,_,u;if(a.length===0)return i._loop;if(a.length===1)if(typeof a[0]=="boolean")d=a[0],i._loop=d;else return u=i._soundById(parseInt(a[0],10)),u?u._loop:!1;else a.length===2&&(d=a[0],_=parseInt(a[1],10));for(var m=i._getSoundIds(_),f=0;f<m.length;f++)u=i._soundById(m[f]),u&&(u._loop=d,i._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=d,d&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop,i.playing(m[f])&&(i.pause(m[f],!0),i.play(m[f],!0)))));return i},rate:function(){var i=this,a=arguments,d,_;if(a.length===0)_=i._sounds[0]._id;else if(a.length===1){var u=i._getSoundIds(),m=u.indexOf(a[0]);m>=0?_=parseInt(a[0],10):d=parseFloat(a[0])}else a.length===2&&(d=parseFloat(a[0]),_=parseInt(a[1],10));var f;if(typeof d=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,a)}}),i;typeof _>"u"&&(i._rate=d),_=i._getSoundIds(_);for(var v=0;v<_.length;v++)if(f=i._soundById(_[v]),f){i.playing(_[v])&&(f._rateSeek=i.seek(_[v]),f._playStart=i._webAudio?t.ctx.currentTime:f._playStart),f._rate=d,i._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(d,t.ctx.currentTime):f._node&&(f._node.playbackRate=d);var b=i.seek(_[v]),x=(i._sprite[f._sprite][0]+i._sprite[f._sprite][1])/1e3-b,w=x*1e3/Math.abs(f._rate);(i._endTimers[_[v]]||!f._paused)&&(i._clearTimer(_[v]),i._endTimers[_[v]]=setTimeout(i._ended.bind(i,f),w)),i._emit("rate",f._id)}}else return f=i._soundById(_),f?f._rate:i._rate;return i},seek:function(){var i=this,a=arguments,d,_;if(a.length===0)i._sounds.length&&(_=i._sounds[0]._id);else if(a.length===1){var u=i._getSoundIds(),m=u.indexOf(a[0]);m>=0?_=parseInt(a[0],10):i._sounds.length&&(_=i._sounds[0]._id,d=parseFloat(a[0]))}else a.length===2&&(d=parseFloat(a[0]),_=parseInt(a[1],10));if(typeof _>"u")return 0;if(typeof d=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,a)}}),i;var f=i._soundById(_);if(f)if(typeof d=="number"&&d>=0){var v=i.playing(_);v&&i.pause(_,!0),f._seek=d,f._ended=!1,i._clearTimer(_),!i._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=d);var b=function(){v&&i.play(_,!0),i._emit("seek",_)};if(v&&!i._webAudio){var x=function(){i._playLock?setTimeout(x,0):b()};setTimeout(x,0)}else b()}else if(i._webAudio){var w=i.playing(_)?t.ctx.currentTime-f._playStart:0,M=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(M+w*Math.abs(f._rate))}else return f._node.currentTime;return i},playing:function(i){var a=this;if(typeof i=="number"){var d=a._soundById(i);return d?!d._paused:!1}for(var _=0;_<a._sounds.length;_++)if(!a._sounds[_]._paused)return!0;return!1},duration:function(i){var a=this,d=a._duration,_=a._soundById(i);return _&&(d=a._sprite[_._sprite][1]/1e3),d},state:function(){return this._state},unload:function(){for(var i=this,a=i._sounds,d=0;d<a.length;d++)a[d]._paused||i.stop(a[d]._id),i._webAudio||(i._clearSound(a[d]._node),a[d]._node.removeEventListener("error",a[d]._errorFn,!1),a[d]._node.removeEventListener(t._canPlayEvent,a[d]._loadFn,!1),a[d]._node.removeEventListener("ended",a[d]._endFn,!1),t._releaseHtml5Audio(a[d]._node)),delete a[d]._node,i._clearTimer(a[d]._id);var _=t._howls.indexOf(i);_>=0&&t._howls.splice(_,1);var u=!0;for(d=0;d<t._howls.length;d++)if(t._howls[d]._src===i._src||i._src.indexOf(t._howls[d]._src)>=0){u=!1;break}return s&&u&&delete s[i._src],t.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,a,d,_){var u=this,m=u["_on"+i];return typeof a=="function"&&m.push(_?{id:d,fn:a,once:_}:{id:d,fn:a}),u},off:function(i,a,d){var _=this,u=_["_on"+i],m=0;if(typeof a=="number"&&(d=a,a=null),a||d)for(m=0;m<u.length;m++){var f=d===u[m].id;if(a===u[m].fn&&f||!a&&f){u.splice(m,1);break}}else if(i)_["_on"+i]=[];else{var v=Object.keys(_);for(m=0;m<v.length;m++)v[m].indexOf("_on")===0&&Array.isArray(_[v[m]])&&(_[v[m]]=[])}return _},once:function(i,a,d){var _=this;return _.on(i,a,d,1),_},_emit:function(i,a,d){for(var _=this,u=_["_on"+i],m=u.length-1;m>=0;m--)(!u[m].id||u[m].id===a||i==="load")&&(setTimeout(function(f){f.call(this,a,d)}.bind(_,u[m].fn),0),u[m].once&&_.off(i,u[m].fn,u[m].id));return _._loadQueue(i),_},_loadQueue:function(i){var a=this;if(a._queue.length>0){var d=a._queue[0];d.event===i&&(a._queue.shift(),a._loadQueue()),i||d.action()}return a},_ended:function(i){var a=this,d=i._sprite;if(!a._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(a._ended.bind(a,i),100),a;var _=!!(i._loop||a._sprite[d][2]);if(a._emit("end",i._id),!a._webAudio&&_&&a.stop(i._id,!0).play(i._id),a._webAudio&&_){a._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=t.ctx.currentTime;var u=(i._stop-i._start)*1e3/Math.abs(i._rate);a._endTimers[i._id]=setTimeout(a._ended.bind(a,i),u)}return a._webAudio&&!_&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,a._clearTimer(i._id),a._cleanBuffer(i._node),t._autoSuspend()),!a._webAudio&&!_&&a.stop(i._id,!0),a},_clearTimer:function(i){var a=this;if(a._endTimers[i]){if(typeof a._endTimers[i]!="function")clearTimeout(a._endTimers[i]);else{var d=a._soundById(i);d&&d._node&&d._node.removeEventListener("ended",a._endTimers[i],!1)}delete a._endTimers[i]}return a},_soundById:function(i){for(var a=this,d=0;d<a._sounds.length;d++)if(i===a._sounds[d]._id)return a._sounds[d];return null},_inactiveSound:function(){var i=this;i._drain();for(var a=0;a<i._sounds.length;a++)if(i._sounds[a]._ended)return i._sounds[a].reset();return new n(i)},_drain:function(){var i=this,a=i._pool,d=0,_=0;if(!(i._sounds.length<a)){for(_=0;_<i._sounds.length;_++)i._sounds[_]._ended&&d++;for(_=i._sounds.length-1;_>=0;_--){if(d<=a)return;i._sounds[_]._ended&&(i._webAudio&&i._sounds[_]._node&&i._sounds[_]._node.disconnect(0),i._sounds.splice(_,1),d--)}}},_getSoundIds:function(i){var a=this;if(typeof i>"u"){for(var d=[],_=0;_<a._sounds.length;_++)d.push(a._sounds[_]._id);return d}else return[i]},_refreshBuffer:function(i){var a=this;return i._node.bufferSource=t.ctx.createBufferSource(),i._node.bufferSource.buffer=s[a._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,t.ctx.currentTime),a},_cleanBuffer:function(i){var a=this,d=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),d))try{i.bufferSource.buffer=t._scratchBuffer}catch{}return i.bufferSource=null,a},_clearSound:function(i){var a=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);a||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(i){this._parent=i,this.init()};n.prototype={init:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,a._sounds.push(i),i.create(),i},create:function(){var i=this,a=i._parent,d=t._muted||i._muted||i._parent._muted?0:i._volume;return a._webAudio?(i._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),i._node.gain.setValueAtTime(d,t.ctx.currentTime),i._node.paused=!0,i._node.connect(t.masterGain)):t.noAudio||(i._node=t._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(t._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=a._src,i._node.preload=a._preload===!0?"auto":a._preload,i._node.volume=d*t.volume(),i._node.load()),i},reset:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,a=i._parent;a._duration=Math.ceil(i._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),i._node.removeEventListener(t._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,a=i._parent;a._duration===1/0&&(a._duration=Math.ceil(i._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var s={},o=function(i){var a=i._src;if(s[a]){i._duration=s[a].duration,h(i);return}if(/^data:[^;]+;base64,/.test(a)){for(var d=atob(a.split(",")[1]),_=new Uint8Array(d.length),u=0;u<d.length;++u)_[u]=d.charCodeAt(u);l(_.buffer,i)}else{var m=new XMLHttpRequest;m.open(i._xhr.method,a,!0),m.withCredentials=i._xhr.withCredentials,m.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(f){m.setRequestHeader(f,i._xhr.headers[f])}),m.onload=function(){var f=(m.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}l(m.response,i)},m.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete s[a],i.load())},c(m)}},c=function(i){try{i.send()}catch{i.onerror()}},l=function(i,a){var d=function(){a._emit("loaderror",null,"Decoding audio data failed.")},_=function(u){u&&a._sounds.length>0?(s[a._src]=u,h(a,u)):d()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(i).then(_).catch(d):t.ctx.decodeAudioData(i,_,d)},h=function(i,a){a&&!i._duration&&(i._duration=a.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},p=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),a=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=a?parseInt(a[1],10):null;if(i&&d&&d<9){var _=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!_&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:t,Howl:r}}),typeof ut<"u"&&(ut.Howler=t,ut.Howl=r),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=t,global.Howl=r,global.Sound=n):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=r,window.Sound=n)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var n=r._howls.length-1;n>=0;n--)r._howls[n].stereo(t);return r},HowlerGlobal.prototype.pos=function(t,r,n){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(r=typeof r!="number"?s._pos[1]:r,n=typeof n!="number"?s._pos[2]:n,typeof t=="number")s._pos=[t,r,n],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,r,n,s,o,c){var l=this;if(!l.ctx||!l.ctx.listener)return l;var h=l._orientation;if(r=typeof r!="number"?h[1]:r,n=typeof n!="number"?h[2]:n,s=typeof s!="number"?h[3]:s,o=typeof o!="number"?h[4]:o,c=typeof c!="number"?h[5]:c,typeof t=="number")l._orientation=[t,r,n,s,o,c],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(c,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(t,r,n,s,o,c);else return h;return l},Howl.prototype.init=function(t){return function(r){var n=this;return n._orientation=r.orientation||[1,0,0],n._stereo=r.stereo||null,n._pos=r.pos||null,n._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},n._onstereo=r.onstereo?[{fn:r.onstereo}]:[],n._onpos=r.onpos?[{fn:r.onpos}]:[],n._onorientation=r.onorientation?[{fn:r.onorientation}]:[],t.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,r){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(t,r)}}),n;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof t=="number")n._stereo=t,n._pos=[t,0,0];else return n._stereo;for(var o=n._getSoundIds(r),c=0;c<o.length;c++){var l=n._soundById(o[c]);if(l)if(typeof t=="number")l._stereo=t,l._pos=[t,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(t,0,0):l._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),n._emit("stereo",l._id);else return l._stereo}return n},Howl.prototype.pos=function(t,r,n,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(t,r,n,s)}}),o;if(r=typeof r!="number"?0:r,n=typeof n!="number"?-.5:n,typeof s>"u")if(typeof t=="number")o._pos=[t,r,n];else return o._pos;for(var c=o._getSoundIds(s),l=0;l<c.length;l++){var h=o._soundById(c[l]);if(h)if(typeof t=="number")h._pos=[t,r,n],h._node&&((!h._panner||h._panner.pan)&&e(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setPosition(t,r,n)),o._emit("pos",h._id);else return h._pos}return o},Howl.prototype.orientation=function(t,r,n,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(t,r,n,s)}}),o;if(r=typeof r!="number"?o._orientation[1]:r,n=typeof n!="number"?o._orientation[2]:n,typeof s>"u")if(typeof t=="number")o._orientation=[t,r,n];else return o._orientation;for(var c=o._getSoundIds(s),l=0;l<c.length;l++){var h=o._soundById(c[l]);if(h)if(typeof t=="number")h._orientation=[t,r,n],h._node&&(h._panner||(h._pos||(h._pos=o._pos||[0,0,-.5]),e(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setOrientation(t,r,n)),o._emit("orientation",h._id);else return h._orientation}return o},Howl.prototype.pannerAttr=function(){var t=this,r=arguments,n,s,o;if(!t._webAudio)return t;if(r.length===0)return t._pannerAttr;if(r.length===1)if(typeof r[0]=="object")n=r[0],typeof s>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),t._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:t._panningModel});else return o=t._soundById(parseInt(r[0],10)),o?o._pannerAttr:t._pannerAttr;else r.length===2&&(n=r[0],s=parseInt(r[1],10));for(var c=t._getSoundIds(s),l=0;l<c.length;l++)if(o=t._soundById(c[l]),o){var h=o._pannerAttr;h={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:h.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:h.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:h.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:h.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:h.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:h.panningModel};var p=o._panner;p?(p.coneInnerAngle=h.coneInnerAngle,p.coneOuterAngle=h.coneOuterAngle,p.coneOuterGain=h.coneOuterGain,p.distanceModel=h.distanceModel,p.maxDistance=h.maxDistance,p.refDistance=h.refDistance,p.rolloffFactor=h.rolloffFactor,p.panningModel=h.panningModel):(o._pos||(o._pos=t._pos||[0,0,-.5]),e(o,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var r=this,n=r._parent;r._orientation=n._orientation,r._stereo=n._stereo,r._pos=n._pos,r._pannerAttr=n._pannerAttr,t.call(this),r._stereo?n.stereo(r._stereo):r._pos&&n.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var r=this,n=r._parent;return r._orientation=n._orientation,r._stereo=n._stereo,r._pos=n._pos,r._pannerAttr=n._pannerAttr,r._stereo?n.stereo(r._stereo):r._pos?n.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,n._refreshBuffer(r)),t.call(this)}}(Sound.prototype.reset);var e=function(t,r){r=r||"spatial",r==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()});var yo={};var lc,gn=A(()=>{lc=jr(Jt());WL.registerComponent("howler-audio-listener",{spatial:{type:WL.Type.Bool,default:!0}},{init:function(){this.origin=new Float32Array(3),this.fwd=new Float32Array(3),this.up=new Float32Array(3)},update:function(){this.spatial&&(this.object.getTranslationWorld(this.origin),this.object.getForward(this.fwd),this.object.getUp(this.up),Howler.pos(this.origin[0],this.origin[1],this.origin[2]),Howler.orientation(this.fwd[0],this.fwd[1],this.fwd[2],this.up[0],this.up[1],this.up[2]))}})});var xo={};var bn,yn=A(()=>{bn=jr(Jt());WL.registerComponent("howler-audio-source",{volume:{type:WL.Type.Float,default:1},spatial:{type:WL.Type.Bool,default:!0},loop:{type:WL.Type.Bool,default:!1},autoplay:{type:WL.Type.Bool,default:!1},src:{type:WL.Type.String,default:""}},{start:function(){this.audio=new bn.Howl({src:[this.src],loop:this.loop,volume:this.volume,autoplay:this.autoplay}),this.lastPlayedAudioId=null,this.origin=new Float32Array(3),this.lastOrigin=new Float32Array(3),this.spatial&&this.autoplay&&(this.updatePosition(),this.play());let e=()=>{this.stop();let t=WL.onSceneLoaded.indexOf(e);t>=0&&WL.onSceneLoaded.splice(t,1)};WL.onSceneLoaded.push(e)},update:function(){!this.spatial||!this.lastPlayedAudioId||(this.object.getTranslationWorld(this.origin),(Math.abs(this.lastOrigin[0]-this.origin[0])>.005||Math.abs(this.lastOrigin[1]-this.origin[1])>.005||Math.abs(this.lastOrigin[2]-this.origin[2])>.005)&&this.updatePosition())},updatePosition:function(){this.audio.pos(this.origin[0],this.origin[1],this.origin[2],this.lastPlayedAudioId),this.lastOrigin.set(this.origin)},play:function(){this.lastPlayedAudioId&&this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=this.audio.play(),this.spatial&&this.updatePosition()},stop:function(){this.lastPlayedAudioId&&(this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=null)}})});var xn=A(()=>{});function Mo(e){console.log("Allocating temp mem:",e),Z=e,I&&_free(I),I=_malloc(Z),Ao()}function ar(e){Z>=e||Mo(Math.ceil(e/1024)*1024)}function Ao(){g=new Float32Array(HEAP8.buffer,I,Z>>2),$t=new Int32Array(HEAP8.buffer,I,Z>>2),ce=new Uint32Array(HEAP8.buffer,I,Z>>2),Ue=new Uint16Array(HEAP8.buffer,I,Z>>1),Pn=new Uint8Array(HEAP8.buffer,I,Z)}function To(e){return ar(e*2),Ue}function So(e){return ar(e*4),g}function Zt(e){return e&&(typeof e=="string"||e.constructor===String)}function sr(e){let t=Mn[e]||(Mn[e]=new ne(e));return t.objectId=e,t}function vt(e,t,r){if(r<0)return null;let n=wn[t]||(wn[t]=[]);if(n[r])return n[r];let s;if(e=="collision")s=new Ve(t,r);else if(e=="text")s=new Kt(t,r);else if(e=="view")s=new Qt(t,r);else if(e=="mesh")s=new nr(t,r);else if(e=="input")s=new er(t,r);else if(e=="light")s=new tr(t,r);else if(e=="animation")s=new rr(t,r);else if(e=="physx")s=new yt(t,r);else{let o=_WL._componentTypeIndices[e],c=_WL._componentTypes[o];s=new c}return s._manager=t,s._id=r,n[r]=s,s}var wn,Mn,wo,y,$,gt,An,Tn,Sn,oe,jn,In,bt,Cn,Te,X,J,On,mt,Me,I,Z,g,$t,ce,Ue,Pn,jo,C,Ve,Kt,Qt,er,tr,rr,nr,yt,re,ue,ir,me,Ae,Xe,Io,Se,ne,xt,En=A(()=>{wn={},Mn=[],wo=["_id","_manager","type","_type","active"];(function(e){e[e.Bool=2]="Bool",e[e.Int=4]="Int",e[e.Float=8]="Float",e[e.String=16]="String",e[e.Enum=32]="Enum",e[e.Object=64]="Object",e[e.Mesh=128]="Mesh",e[e.Texture=256]="Texture",e[e.Material=512]="Material",e[e.Animation=1024]="Animation",e[e.Skin=2048]="Skin"})(y||(y={}));$=new Array(6);$[y.Bool]=!1;$[y.Int]=0;$[y.Float]=0;$[y.String]="";$[y.Enum]=0;$[y.Object]=null;$[y.Mesh]=null;$[y.Texture]=null;$[y.Material]=null;$[y.Animation]=null;$[y.Skin]=null;(function(e){e[e.Sphere=0]="Sphere",e[e.AxisAlignedBox=1]="AxisAlignedBox",e[e.Box=2]="Box"})(gt||(gt={}));(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(An||(An={}));(function(e){e[e.Line=1]="Line",e[e.Middle=2]="Middle",e[e.Top=3]="Top",e[e.Bottom=4]="Bottom"})(Tn||(Tn={}));(function(e){e[e.None=0]="None",e[e.Outline=1]="Outline"})(Sn||(Sn={}));(function(e){e[e.Head=0]="Head",e[e.EyeLeft=1]="EyeLeft",e[e.EyeRight=2]="EyeRight",e[e.ControllerLeft=3]="ControllerLeft",e[e.ControllerRight=4]="ControllerRight",e[e.RayLeft=5]="RayLeft",e[e.RayRight=6]="RayRight"})(oe||(oe={}));(function(e){e[e.Point=1]="Point",e[e.Spot=2]="Spot",e[e.Sun=3]="Sun"})(jn||(jn={}));(function(e){e[e.Playing=1]="Playing",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped"})(In||(In={}));(function(e){e[e.Force=0]="Force",e[e.Impulse=1]="Impulse",e[e.VelocityChange=2]="VelocityChange",e[e.Acceleration=3]="Acceleration"})(bt||(bt={}));(function(e){e[e.Touch=0]="Touch",e[e.TouchLost=1]="TouchLost",e[e.TriggerTouch=2]="TriggerTouch",e[e.TriggerTouchLost=3]="TriggerTouchLost"})(Cn||(Cn={}));(function(e){e[e.None=0]="None",e[e.Sphere=1]="Sphere",e[e.Capsule=2]="Capsule",e[e.Box=3]="Box",e[e.Plane=4]="Plane",e[e.ConvexMesh=5]="ConvexMesh",e[e.TriangleMesh=6]="TriangleMesh"})(Te||(Te={}));(function(e){e[e.Position=0]="Position",e[e.Tangent=1]="Tangent",e[e.Normal=2]="Normal",e[e.TextureCoordinate=3]="TextureCoordinate",e[e.Color=4]="Color",e[e.JointId=5]="JointId",e[e.JointWeight=6]="JointWeight",e[e.SecondaryJointId=7]="SecondaryJointId",e[e.SecondaryJointWeight=8]="SecondaryJointWeight"})(X||(X={}));(function(e){e[e.UnsignedInt=0]="UnsignedInt",e[e.Int=1]="Int",e[e.Float=2]="Float",e[e.Sampler=3]="Sampler",e[e.Font=4]="Font"})(J||(J={}));On=null,Me=[],I=null,Z=0,g=null,$t=null,ce=null,Ue=null,Pn=null;jo=[0,1,0],C=class{constructor(t=-1,r=-1){this._manager=t,this._id=r,this._object=null,this._type=null}get type(){return this._type||ne._typeNameFor(this._manager)}get object(){if(!this._object){let t=_wl_component_get_object(this._manager,this._id);this._object=sr(t)}return this._object}set active(t){_wl_component_setActive(this._manager,this._id,t)}get active(){return _wl_component_isActive(this._manager,this._id)!=0}destroy(){_wl_component_remove(this._manager,this._id),this._manager=void 0,this._id=void 0}equals(t){return t?this._manager==t._manager&&this._id==t._id:!1}},Ve=class extends C{get collider(){return _wl_collision_component_get_collider(this._id)}set collider(t){_wl_collision_component_set_collider(this._id,t)}get extents(){return new Float32Array(HEAPF32.buffer,_wl_collision_component_get_extents(this._id),3)}set extents(t){this.extents.set(t)}get group(){return _wl_collision_component_get_group(this._id)}set group(t){_wl_collision_component_set_group(this._id,t)}queryOverlaps(){let t=_wl_collision_component_query_overlaps(this._id,I,Z>>1),r=new Array(t);for(let n=0;n<t;++n)r[n]=new Ve(this._manager,Ue[n]);return r}},Kt=class extends C{get alignment(){return _wl_text_component_get_horizontal_alignment(this._id)}set alignment(t){_wl_text_component_set_horizontal_alignment(this._id,t)}get justification(){return _wl_text_component_get_vertical_alignment(this._id)}set justification(t){_wl_text_component_set_vertical_alignment(this._id,t)}get characterSpacing(){return _wl_text_component_get_character_spacing(this._id)}set characterSpacing(t){_wl_text_component_set_character_spacing(this._id,t)}get lineSpacing(){return _wl_text_component_get_line_spacing(this._id)}set lineSpacing(t){_wl_text_component_set_line_spacing(this._id,t)}get effect(){return _wl_text_component_get_effect(this._id)}set effect(t){_wl_text_component_set_effect(this._id,t)}get text(){return UTF8ToString(_wl_text_component_get_text(this._id))}set text(t){let r=lengthBytesUTF8(t)+1,n=_malloc(r);stringToUTF8(t,n,r),_wl_text_component_set_text(this._id,n),_free(n)}set material(t){let r=t?t._index:0;_wl_text_component_set_material(this._id,r)}get material(){let t=_wl_text_component_get_material(this._id);return t>0?new me(t):null}},Qt=class extends C{get projectionMatrix(){return new Float32Array(HEAPF32.buffer,_wl_view_component_get_projection_matrix(this._id),16)}get near(){return _wl_view_component_get_near(this._id)}set near(t){_wl_view_component_set_near(this._id,t)}get far(){return _wl_view_component_get_far(this._id)}set far(t){_wl_view_component_set_far(this._id,t)}get fov(){return _wl_view_component_get_fov(this._id)}set fov(t){_wl_view_component_set_fov(this._id,t)}},er=class extends C{get inputType(){return _wl_input_component_get_type(this._id)}set inputType(t){_wl_input_component_set_type(this._id,t)}get xrInputSource(){if(On){for(let t of On.inputSources)if(t.handedness==this.handedness)return t}return null}get handedness(){let t=this.inputType;return t==oe.ControllerRight||t==oe.RayRight||t==oe.EyeRight?"right":t==oe.ControllerLeft||t==oe.RayLeft||t==oe.EyeLeft?"left":null}},tr=class extends C{get color(){return new Float32Array(HEAPF32.buffer,_wl_light_component_get_color(this._id),4)}get lightType(){return _wl_light_component_get_type(this._id)}set lightType(t){_wl_light_component_set_type(this._id,t)}},rr=class extends C{set animation(t){_wl_animation_component_set_animation(this._id,t._index)}get animation(){return new Se(_wl_animation_component_get_animation(this._id))}set playCount(t){_wl_animation_component_set_playCount(this._id,t)}get playCount(){return _wl_animation_component_get_playCount(this._id)}set speed(t){_wl_animation_component_set_speed(this._id,t)}get speed(){return _wl_animation_component_get_speed(this._id)}get state(){return _wl_animation_component_state(this._id)}play(){_wl_animation_component_play(this._id)}stop(){_wl_animation_component_stop(this._id)}pause(){_wl_animation_component_pause(this._id)}},nr=class extends C{set material(t){_wl_mesh_component_set_material(this._id,t?t._index:0)}get material(){let t=_wl_mesh_component_get_material(this._id);return t>0?new me(t):null}get mesh(){return new ue(_wl_mesh_component_get_mesh(this._id))}set mesh(t){_wl_mesh_component_set_mesh(this._id,t?t._index:0)}get skin(){return new xt(_wl_mesh_component_get_skin(this._id))}set skin(t){_wl_mesh_component_set_skin(this._id,t._index)}},yt=class extends C{set static(t){_wl_physx_component_set_static(this._id,t)}get static(){return!!_wl_physx_component_get_static(this._id)}set kinematic(t){_wl_physx_component_set_kinematic(this._id,t)}get kinematic(){return!!_wl_physx_component_get_kinematic(this._id)}set shape(t){_wl_physx_component_set_shape(this._id,t)}get shape(){return _wl_physx_component_get_shape(this._id)}set shapeData(t){t==null||![Te.TriangleMesh,Te.ConvexMesh].includes(this.shape)||_wl_physx_component_set_shape_data(this._id,t.index)}get shapeData(){return[Te.TriangleMesh,Te.ConvexMesh].includes(this.shape)?{index:_wl_physx_component_get_shape_data(this._id)}:null}set extents(t){this.extents.set(t)}get extents(){let t=_wl_physx_component_get_extents(this._id);return new Float32Array(HEAPF32.buffer,t,3)}get staticFriction(){return _wl_physx_component_get_staticFriction(this._id)}set staticFriction(t){_wl_physx_component_set_staticFriction(this._id,t)}get dynamicFriction(){return _wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(t){_wl_physx_component_set_dynamicFriction(this._id,t)}get bounciness(){return _wl_physx_component_get_bounciness(this._id)}set bounciness(t){_wl_physx_component_set_bounciness(this._id,t)}get linearDamping(){return _wl_physx_component_get_linearDamping(this._id)}set linearDamping(t){_wl_physx_component_set_linearDamping(this._id,t)}get angularDamping(){return _wl_physx_component_get_angularDamping(this._id)}set angularDamping(t){_wl_physx_component_set_angularDamping(this._id,t)}set linearVelocity(t){_wl_physx_component_set_linearVelocity(this._id,t[0],t[1],t[2])}get linearVelocity(){return _wl_physx_component_get_linearVelocity(this._id,I),new Float32Array(HEAPF32.buffer,I,3)}set angularVelocity(t){_wl_physx_component_set_angularVelocity(this._id,t[0],t[1],t[2])}get angularVelocity(){return _wl_physx_component_get_angularVelocity(this._id,I),new Float32Array(HEAPF32.buffer,I,3)}set mass(t){_wl_physx_component_set_mass(this._id,t)}get mass(){return _wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(t){_wl_physx_component_set_massSpaceInertiaTensor(this._id,t[0],t[1],t[2])}addForce(t,r,n,s,o){r=r||bt.Force,s?_wl_physx_component_addForceAt(this._id,t[0],t[1],t[2],r,!!n,s[0],s[1],s[2],!!o):_wl_physx_component_addForce(this._id,t[0],t[1],t[2],r,!!n)}addTorque(t,r=bt.Force){_wl_physx_component_addTorque(this._id,t[0],t[1],t[2],r)}onCollision(t){return this.onCollisionWith(this,t)}onCollisionWith(t,r){return mt._callbacks[this._id]=mt._callbacks[this._id]||[],mt._callbacks[this._id].push(r),_wl_physx_component_addCallback(this._id,t._id||this._id)}removeCollisionCallback(t){let r=_wl_physx_component_removeCallback(this._id,t);r&&mt._callbacks[this._id].splice(-r)}};for(let e of["static","extents","staticFriction","dynamicFriction","bounciness","linearDamping","angularDamping","shape","shapeData","kinematic","linearVelocity","angularVelocity","mass"])Object.defineProperty(yt.prototype,e,{enumerable:!0});(function(e){e[e.UnsignedByte=1]="UnsignedByte",e[e.UnsignedShort=2]="UnsignedShort",e[e.UnsignedInt=4]="UnsignedInt"})(re||(re={}));ue=class{static get VERTEX_FLOAT_SIZE(){return 3+3+2}static get VERTEX_SIZE(){return this.VERTEX_FLOAT_SIZE*4}static get POS(){return{X:0,Y:1,Z:2}}static get TEXCOORD(){return{U:3,V:4}}static get NORMAL(){return{X:5,Y:6,Z:7}}constructor(t){if(typeof t=="object"){if(!t.vertexCount&&t.vertexData&&(t.vertexCount=t.vertexData.length/ue.VERTEX_FLOAT_SIZE),!t.vertexCount)throw new Error("Missing parameter 'vertexCount'");let r=0,n=0,s=0;if(t.indexData)switch(n=t.indexType||re.UnsignedShort,s=t.indexData.length*n,r=_malloc(s),n){case re.UnsignedByte:HEAPU8.set(t.indexData,r);break;case re.UnsignedShort:HEAPU16.set(t.indexData,r>>1);break;case re.UnsignedInt:HEAPU32.set(t.indexData,r>>2);break}let{skinned:o=!1}=t;if(this._index=_wl_mesh_create(r,s,n,t.vertexCount,o),t.vertexData){let c=this.attribute(X.Position),l=this.attribute(X.Normal),h=this.attribute(X.TextureCoordinate);for(let p=0;p<t.vertexCount;++p){let i=p*ue.VERTEX_FLOAT_SIZE;c.set(p,t.vertexData.subarray(i,i+3)),h?.set(p,t.vertexData.subarray(i+3,i+5)),l?.set(p,t.vertexData.subarray(i+5,i+8))}}}else this._index=t}get vertexData(){let t=_wl_mesh_get_vertexData(this._index,I);return new Float32Array(HEAPF32.buffer,t,ue.VERTEX_FLOAT_SIZE*HEAPU32[I/4])}get vertexCount(){return _wl_mesh_get_vertexCount(this._index)}get indexData(){let t=_wl_mesh_get_indexData(this._index,I,I+4);if(t===null)return null;let r=HEAPU32[I/4];switch(HEAPU32[I/4+1]){case re.UnsignedByte:return new Uint8Array(HEAPU8.buffer,t,r);case re.UnsignedShort:return new Uint16Array(HEAPU16.buffer,t,r);case re.UnsignedInt:return new Uint32Array(HEAPU32.buffer,t,r)}return null}update(){_wl_mesh_update(this._index)}getBoundingSphere(t=new Float32Array(4)){return _wl_mesh_get_boundingSphere(this._index,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=g[3],t}attribute(t){if(typeof t!="number")throw new TypeError("Expected number, but got "+typeof t);if(_wl_mesh_get_attribute(this._index,t,I),ce[0]==255)return null;let r=new ir(t);return r._attribute=ce[0],r._offset=ce[1],r._stride=ce[2],r._formatSize=ce[3],r._componentCount=ce[4],r.length=this.vertexCount,r}destroy(){_wl_mesh_destroy(this._index)}},ir=class{constructor(t=X.Position){switch(this._attribute=-1,this._offset=0,this._stride=0,this._formatSize=0,this._componentCount=0,this.length=0,t){case X.Position:case X.Normal:case X.TextureCoordinate:case X.Tangent:case X.Color:case X.JointWeight:case X.SecondaryJointWeight:this._bufferType=Float32Array,this._tempBufferGetter=So;break;case X.JointId:case X.SecondaryJointId:this._bufferType=Uint16Array,this._tempBufferGetter=To;break;default:throw new Error(`Invalid attribute accessor type: ${t}`)}}createArray(t=1){return t=t>this.length?this.length:t,new this._bufferType(t*this._componentCount)}get(t,r=this.createArray()){if(r.length%this._componentCount!==0)throw new Error(`out.length, ${r.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let n=this._tempBufferGetter(r.length),s=this._bufferType.BYTES_PER_ELEMENT,o=s*r.length,c=this._componentCount*s;_wl_mesh_get_attribute_values(this._attribute,this._formatSize,this._offset+t*this._stride,this._stride,c,n.byteOffset,o);for(let l=0;l<r.length;++l)r[l]=n[l];return r}set(t,r){if(r.length%this._componentCount!==0)throw new Error(`out.length, ${r.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let n=this._bufferType.BYTES_PER_ELEMENT,s=n*r.length,o=this._componentCount*n;if(r.buffer!=HEAPU8.buffer){let c=this._tempBufferGetter(r.length);c.set(r),r=c}return _wl_mesh_set_attribute_values(this._attribute,o,r.byteOffset,s,this._formatSize,this._offset+t*this._stride,this._stride),this}},me=class{constructor(t){if(typeof t!="number"){if(!t?.pipeline)throw new Error("Missing parameter 'pipeline'");let r=t.pipeline,n=lengthBytesUTF8(r)+1;if(stringToUTF8(r,I,n),this._index=_wl_material_create(I),this._index<0)throw new Error(`No such pipeline '${r}'`)}else this._index=t;if(this._definition=_wl_material_get_definition(this._index),!_WL._materialDefinitions[this._definition])throw new Error(`Material Definition ${this._definition} not found for material with index ${this._index}`);return new Proxy(this,{get(r,n){let o=_WL._materialDefinitions[r._definition].get(n);if(!o)return r[n];if(_wl_material_get_param_value(r._index,o.index,I)){let c=o.type;switch(c.type){case J.UnsignedInt:return c.componentCount==1?ce[0]:new Uint32Array(HEAPU32.buffer,I,c.componentCount);case J.Int:return c.componentCount==1?$t[0]:new Int32Array(HEAP32.buffer,I,c.componentCount);case J.Float:return c.componentCount==1?g[0]:new Float32Array(HEAPF32.buffer,I,c.componentCount);case J.Sampler:return new Xe($t[0]);default:throw new Error(`Invalid type ${c} on parameter ${o.index} for material ${r._index}`)}}},set(r,n,s){let c=_WL._materialDefinitions[r._definition].get(n);if(!c)return r[n]=s,!0;switch(c.type.type){case J.UnsignedInt:case J.Int:case J.Sampler:let h=s instanceof Xe?s.id:s;_wl_material_set_param_value_uint(r._index,c.index,h);break;case J.Float:let p=1;if(typeof s=="number")g[0]=s;else{p=s.length;for(let i=0;i<p;++i)g[i]=s[i]}_wl_material_set_param_value_float(r._index,c.index,I,p);break;case J.Font:throw new Error("Setting font properties is currently unsupported.")}return!0}})}get shader(){return UTF8ToString(_wl_material_get_shader(this._index))}clone(){let t=_wl_material_clone(this._index);return t>0?new me(t):null}static wrap(t){return t>0?new me(t):null}},Ae=null,Xe=class{constructor(t){if(this._id=0,this._imageIndex=void 0,t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement){let r=Me.length;Me.push(t),this._imageIndex=r,this._id=_wl_renderer_addImage(r)}else this._id=t;Io[this._id]=this}get valid(){return this._id>=0}get id(){return this._id}update(){this.valid&&_wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return _wl_texture_width(this._id)}get height(){return _wl_texture_height(this._id)}updateSubImage(t,r,n,s){var o;if(!this.valid)return;Ae||(Ae=document.createElement("canvas"));let c=Me[this._imageIndex];if(c){Ae.width=n,Ae.height=s,(o=Ae.getContext("2d"))===null||o===void 0||o.drawImage(c,t,r,n,s,0,0,n,s),Me[this._imageIndex]=Ae;try{_wl_renderer_updateImage(this._id,this._imageIndex,t,(c.videoHeight||c.height)-r-s)}finally{Me[this._imageIndex]=c}}}destroy(){_wl_texture_destroy(this._id),this._imageIndex&&(Me[this._imageIndex]=null,this._imageIndex=void 0)}},Io={load:function(e,t){let r=new Image;return t!==void 0&&(r.crossOrigin=t),r.src=e,new Promise((n,s)=>{r.onload=function(){let o=new Xe(r);o.valid||s("Failed to add image "+r.src+" to texture atlas. Probably incompatible format."),n(o)}})}},Se=class{constructor(t){this._index=t}get duration(){return _wl_animation_get_duration(this._index)}get trackCount(){return _wl_animation_get_trackCount(this._index)}retarget(t){if(t instanceof xt){let s=_wl_animation_retargetToSkin(this._index,t._index);return new Se(s)}if(t.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+t.length.toString());let r=_malloc(2*t.length);for(let s=0;s<t.length;++s)HEAPU16[r>>1+s]=t[s].objectId;let n=_wl_animation_retarget(this._index,r);return _free(r),new Se(n)}},ne=class{constructor(t){this.objectId=t}get name(){return UTF8ToString(_wl_object_name(this.objectId))}set name(t){let r=lengthBytesUTF8(t)+1,n=_malloc(r);stringToUTF8(t,n,r),_wl_object_set_name(this.objectId,n),_free(n)}get parent(){let t=_wl_object_parent(this.objectId);return t==0?null:sr(t)}get children(){let t=_wl_object_get_children_count(this.objectId);if(t===0)return[];ar(t*2),_wl_object_get_children(this.objectId,I,Z>>1);let r=new Array(t);for(let n=0;n<t;++n)r[n]=sr(Ue[n]);return r}set parent(t){_wl_object_set_parent(this.objectId,t==null?0:t.objectId)}resetTransform(){_wl_object_reset_translation_rotation(this.objectId),_wl_object_reset_scaling(this.objectId)}resetTranslationRotation(){_wl_object_reset_translation_rotation(this.objectId)}resetRotation(){_wl_object_reset_rotation(this.objectId)}resetTranslation(){_wl_object_reset_translation(this.objectId)}resetScaling(){_wl_object_reset_scaling(this.objectId)}translate(t){_wl_object_translate(this.objectId,t[0],t[1],t[2])}translateObject(t){_wl_object_translate_obj(this.objectId,t[0],t[1],t[2])}translateWorld(t){_wl_object_translate_world(this.objectId,t[0],t[1],t[2])}rotateAxisAngleDeg(t,r){_wl_object_rotate_axis_angle(this.objectId,t[0],t[1],t[2],r)}rotateAxisAngleRad(t,r){_wl_object_rotate_axis_angle_rad(this.objectId,t[0],t[1],t[2],r)}rotateAxisAngleDegObject(t,r){_wl_object_rotate_axis_angle_obj(this.objectId,t[0],t[1],t[2],r)}rotateAxisAngleRadObject(t,r){_wl_object_rotate_axis_angle_rad_obj(this.objectId,t[0],t[1],t[2],r)}rotate(t){_wl_object_rotate_quat(this.objectId,t[0],t[1],t[2],t[3])}rotateObject(t){_wl_object_rotate_quat_obj(this.objectId,t[0],t[1],t[2],t[3])}scale(t){_wl_object_scale(this.objectId,t[0],t[1],t[2])}get transformLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_local(this.objectId),8)}set transformLocal(t){this.transformLocal.set(t),this.setDirty()}getTranslationLocal(t){return _wl_object_get_translation_local(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}getTranslationWorld(t){return _wl_object_get_translation_world(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}setTranslationLocal(t){_wl_object_set_translation_local(this.objectId,t[0],t[1],t[2])}setTranslationWorld(t){_wl_object_set_translation_world(this.objectId,t[0],t[1],t[2])}get transformWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_world(this.objectId),8)}set transformWorld(t){this.transformWorld.set(t),_wl_object_trans_world_to_local(this.objectId)}get scalingLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_local(this.objectId),3)}set scalingLocal(t){this.scalingLocal.set(t),this.setDirty()}get scalingWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_world(this.objectId),3)}set scalingWorld(t){this.scalingWorld.set(t),_wl_object_scaling_world_to_local(this.objectId)}get rotationLocal(){return this.transformLocal.subarray(0,4)}get rotationWorld(){return this.transformWorld.subarray(0,4)}set rotationLocal(t){_wl_object_set_rotation_local(this.objectId,t[0],t[1],t[2],t[3])}set rotationWorld(t){_wl_object_set_rotation_world(this.objectId,t[0],t[1],t[2],t[3])}getForward(t){return t[0]=0,t[1]=0,t[2]=-1,this.transformVectorWorld(t),t}getUp(t){return t[0]=0,t[1]=1,t[2]=0,this.transformVectorWorld(t),t}getRight(t){return t[0]=1,t[1]=0,t[2]=0,this.transformVectorWorld(t),t}transformVectorWorld(t,r){return r=r||t,g[0]=r[0],g[1]=r[1],g[2]=r[2],_wl_object_transformVectorWorld(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}transformVectorLocal(t,r){return r=r||t,g[0]=r[0],g[1]=r[1],g[2]=r[2],_wl_object_transformVectorLocal(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}transformPointWorld(t,r){return r=r||t,g[0]=r[0],g[1]=r[1],g[2]=r[2],_wl_object_transformPointWorld(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}transformPointLocal(t,r){return r=r||t,g[0]=r[0],g[1]=r[1],g[2]=r[2],_wl_object_transformPointLocal(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}transformVectorInverseWorld(t,r){return r=r||t,g[0]=r[0],g[1]=r[1],g[2]=r[2],_wl_object_transformVectorInverseWorld(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}transformVectorInverseLocal(t,r){return r=r||t,g[0]=r[0],g[1]=r[1],g[2]=r[2],_wl_object_transformVectorInverseLocal(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}transformPointInverseWorld(t,r){return r=r||t,g[0]=r[0],g[1]=r[1],g[2]=r[2],_wl_object_transformPointInverseWorld(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}transformPointInverseLocal(t,r){return r=r||t,g.set(r),_wl_object_transformPointInverseLocal(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t}toWorldSpaceTransform(t,r){return r=r||t,g.set(r),_wl_object_toWorldSpaceTransform(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=g[3],t[4]=g[4],t[5]=g[5],t[6]=g[6],t[7]=g[7],t}toLocalSpaceTransform(t,r){let n=this.parent;return r=r||t,n?n.toObjectSpaceTransform(r):t!==r&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7]),t}toObjectSpaceTransform(t,r){return r=r||t,g.set(r),_wl_object_toObjectSpaceTransform(this.objectId,I),t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=g[3],t[4]=g[4],t[5]=g[5],t[6]=g[6],t[7]=g[7],t}lookAt(t,r=jo){_wl_object_lookAt(this.objectId,t[0],t[1],t[2],r[0],r[1],r[2])}destroy(){_wl_scene_remove_object(this.objectId),this.objectId=null}setDirty(){_wl_object_set_dirty(this.objectId)}set active(t){let r=this.getComponents();for(let n of r)n.active=t}getComponent(t,r){let n=Zt(t)?t:t.TypeName,s=lengthBytesUTF8(n)+1,o=_malloc(s);stringToUTF8(n,o,s);let c=_wl_get_component_manager_index(o);if(_free(o),c<0){let h=_WL._componentTypeIndices[n],p=_wl_get_js_component_index(this.objectId,h,r||0);return p<0?null:_WL._components[p]}let l=_wl_get_component_id(this.objectId,c,r||0);return vt(n,c,l)}getComponents(t){let r=null,n=null;t&&(n=Zt(t)?t:t.TypeName,r=ne._typeIndexFor(n));let s=[],o=Math.floor(Z/3*2),c=_wl_object_get_components(this.objectId,I,o),l=2*c;_wl_object_get_component_types(this.objectId,I+l,o);let h=ne._typeIndexFor("js");for(let p=0;p<c;++p){let i=Pn[p+l],a=Ue[p];if(i==h){let d=_WL._components[_wl_get_js_component_index_for_id(a)];(r===null||d.type==n)&&s.push(d);continue}if(r===null){let d=ne._typeNameFor(i);s.push(vt(d,i,a))}else i==r&&s.push(vt(n,r,a))}return s}addComponent(t,r){let n=Zt(t)?t:t.TypeName,s=ne._typeIndexFor(n),o=null,c=null;if(s<0){if(!(n in _WL._componentTypeIndices))throw new TypeError("Unknown component type '"+n+"'");let l=_wl_object_add_js_component(this.objectId,_WL._componentTypeIndices[n]);c=_wl_get_js_component_index_for_id(l),o=_WL._components[c]}else{let l=_wl_object_add_component(this.objectId,s);o=vt(n,s,l)}if(r!==void 0)for(let l in r)wo.includes(l)||(o[l]=r[l]);return s<0&&_wljs_component_init(c),(!r||!("active"in r&&!r.active))&&(o.active=!0),o}get changed(){return!!_wl_object_is_changed(this.objectId)}equals(t){return t?this.objectId==t.objectId:!1}static _typeIndexFor(t){let r=lengthBytesUTF8(t)+1,n=_malloc(r);stringToUTF8(t,n,r);let s=_wl_get_component_manager_index(n);return _free(n),s}static _typeNameFor(t){return UTF8ToString(_wl_component_manager_name(t))}},xt=class{constructor(t){this._index=t}get jointCount(){return _wl_skin_get_joint_count(this._index)}get jointIds(){return new Uint16Array(HEAPU16.buffer,_wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}}});var U=A(()=>{xn();En()});var Ye=A(()=>{});var Q,or=A(()=>{Q=class{static setTag(t,r){t[this.tagKey]=r}static hasTag(t,r){return!(!t[this.tagKey]&&t[this.tagKey]!==r)}static getTag(t){return t[this.tagKey]}};Q.tagKey="TAG"});var Ln={};W(Ln,{default:()=>ee});var ee,wt=A(()=>{U();Ye();or();ee=class extends C{start(){Q.setTag(this.object,parseInt(this.tag))}};ee.TypeName="tag-component",ee.Properties={tag:{type:y.Enum,values:[0 .toString(),2 .toString()]}}});var Rn={};W(Rn,{SecondTestComponent:()=>qe});var qe,kn=A(()=>{U();qe=class extends C{start(){this._mesh=this.object.getComponent("mesh");let r=this._mesh.material.clone();this._mesh.material=r,this.color=[this.colorR,this.colorG,this.colorB,this.colorA],r.diffuseColor=this.color,r.ambientColor=[0,0,0,1],r.specularColor=[1,0,0,1]}};qe.TypeName="second",qe.Properties={test:{type:y.Int,default:1},colorR:{type:y.Float,default:1},colorG:{type:y.Float,default:1},colorB:{type:y.Float,default:1},colorA:{type:y.Float,default:1}}});function le(){return WL.scene}function Bn(){return WL.onXRSessionStart}var Ge=A(()=>{});var Je,Fn=A(()=>{Je=class{constructor(t){this._layerSize=t,this._layerData=new Array(this._layerSize);for(let r=0;r<this._layerSize;++r)this._layerData[r]=new Array(this._layerSize)}}});var ve,lr=A(()=>{te();Fn();ve=class{get gridSize(){return this._gridSize}get layerCount(){return this._layerCount}get cellSize(){return this._cellSize}constructor(t,r,n){this._gridSize=t,this._layerCount=r,this._cellSize=n,this._gridOffset=this._gridSize*this._cellSize/2,this._gridData=new Array(this._layerCount);for(let s=0;s<this._layerCount;++s)this._gridData[s]=new Je(this._gridSize);console.log(this._gridData)}getCellPositionVec3(t){return this.getCellPosition(t[0],t[1],t[2])}getCellPosition(t,r,n){let s=E.create();return s[1]=r*this._cellSize,s[0]=t*this._cellSize-this._gridOffset,s[2]=n*this._cellSize-this._gridOffset,s}getCellIndices(t,r,n){let s=E.create();return s[0]=Math.round((t+this._gridOffset)/this._cellSize),s[1]=Math.floor(r/this._cellSize),s[2]=Math.round((n+this._gridOffset)/this._cellSize),s}}});var Dn={};W(Dn,{default:()=>je});var je,Wn=A(()=>{U();Ge();lr();je=class extends C{start(){this._grid=new ve(2,10,.5);let r=this.debugVisualObject.getComponent("mesh"),n=le(),s=25/2;for(let o=0;o<this._grid.layerCount;++o)for(let c=0;c<this._grid.gridSize;++c)for(let l=0;l<this._grid.gridSize;++l){let h=n.addObject(this.object);h.addComponent("mesh",{mesh:r.mesh,material:r.material}),h.resetTranslation(),h.translate(this._grid.getCellPosition(c,o,l));let p=this._grid.cellSize;h.scale([p,p,p])}}};je.TypeName="grid-debug-component",je.Properties={debugVisualObject:{type:y.Object,default:null}}});var dr,V,de=A(()=>{dr=class{constructor(){this.PREFAB_UNAME_KEY="pun";this._prefabs=new Map}registerPrefab(t){let r=t.getPrefabUniqueName();if(this._prefabs.has(r))throw new Error("Can't register the same prefab twice: "+r);this._prefabs.set(r,t),t.object[this.PREFAB_UNAME_KEY]=r}getPrefab(t){return this._prefabs.has(t.TypeName)?this._prefabs.get(t.TypeName):null}getPrefabByName(t){return this._prefabs.has(t)?this._prefabs.get(t):null}removePrefab(t){this._prefabs.has(t.TypeName)&&this._prefabs.delete(t.TypeName)}},V=new dr});var hr,ge,_r=A(()=>{lr();hr=class{get grid(){return this._grid}constructor(t,r,n){this._grid=new ve(t,r,n)}},ge=new hr(30,10,.25)});var K,Mt=A(()=>{U();te();Ge();_r();wt();Ye();de();K=class extends C{start(){this._scene=le(),this._cellSize=ge.grid.cellSize}createPrevisObject(){this._previsObject=this._scene.addObject(null),this._previsObject.translateWorld([0,-5,0]);let r=this._scene.addObject(this._previsObject);r.translateObject([0,this._cellSize/2,0]),r.addComponent("mesh",{mesh:this.previsMesh,material:this.previsMat})}createBlock(r,n,s){let o=this._scene.addObject(s);o[V.PREFAB_UNAME_KEY]=this.getPrefabUniqueName(),o.translateWorld(r);let c=this._scene.addObject(o);c.resetRotation(),c.translateObject([0,this._cellSize/2,0]),c.rotate(this._previsObject.rotationWorld);let l=this.finalMat.clone();l.diffuseColor=n,c.addComponent("mesh",{mesh:this.finalMesh,material:l}),c.addComponent(ee,{tag:1});let h=this._cellSize/2+.001;return c.addComponent("collision",{collider:gt.AxisAlignedBox,extents:[h,h,h],group:1}),o}updatePrevisPosition(r){this._previsObject.setTranslationWorld(r);let n=E.create();this._previsObject.getTranslationWorld(n)}updatePrevisRotation(r,n){this._previsObject.rotateAxisAngleDeg([1,0,0],r),this._previsObject.rotateAxisAngleDeg([0,1,0],n)}setPrevisRotation(r){this._previsObject.resetRotation(),this._previsObject.rotationWorld=r}updatePrevisColor(r){this.previsMat.diffuseColor=r}};K.TypeName="",K.Properties={finalMesh:{type:y.Mesh},previsMesh:{type:y.Mesh},finalMat:{type:y.Material},previsMat:{type:y.Material}}});var Hn={};W(Hn,{default:()=>he});var pr,he,fr=A(()=>{U();Mt();de();pr=class extends K{getPrefabUniqueName(){return pr.TypeName}start(){super.start(),V.registerPrefab(this),this.createPrevisObject()}},he=pr;he.TypeName="block-slope-prefab",he.Properties={finalMesh:{type:y.Mesh},previsMesh:{type:y.Mesh},finalMat:{type:y.Material},previsMat:{type:y.Material}}});var ur,N,Ie=A(()=>{de();fr();mr();ur=class{constructor(){this._currentPrefab=null,this._currentColor=[.2,.6,.86,1],this.test()}test(){return Ir(this,null,function*(){yield new Promise(t=>setTimeout(t,1e3)),this._currentPrefab=V.getPrefab(he),this._currentPrefab.updatePrevisColor(this._currentColor)})}setBuildContainer(t){this._buildContainer=t}setCurrentPrevizPosition(t){this._currentPrefab.updatePrevisPosition(t)}addCurrentPrevizRotation(t,r){this._currentPrefab.updatePrevisRotation(t,r)}instanciatePrefabAt(t){this._currentPrefab.createBlock(t,this._currentColor,this._buildContainer)}setPrefab(t){this._currentPrefab=t}setColor(t){this._currentColor=t,this._currentPrefab.updatePrevisColor(this._currentColor)}getCurrentBuildData(){return this._buildContainer.getComponent(ie).generateBuildData()}loadBuild(t){this._buildContainer.getComponent(ie).loadBuildData(t)}},N=new ur});var Nn={};W(Nn,{default:()=>ie});var ie,mr=A(()=>{U();Ie();de();te();ie=class extends C{constructor(){super(...arguments);this.tempTime=0}init(){N.setBuildContainer(this.object)}generateBuildData(){let r=new Array;console.log(this.object.children);for(let n of this.object.children){let s=n.children[0],o=s.getComponent("mesh"),c=E.create();n.getTranslationWorld(c);let l=o.material.diffuseColor,h=fe.fromValues(l[0],l[1],l[2],l[3]);r.push({type:n[V.PREFAB_UNAME_KEY],color:h,position:c,rotation:s.rotationWorld})}return r}loadBuildData(r){this.clearBlocksInScene();let n;for(let s of r){n=V.getPrefabByName(s.type),n.setPrevisRotation(s.rotation),N.setPrefab(n);let o=new Float32Array([s.color[0],s.color[1],s.color[2],s.color[3]]);N.setColor(o),N.instanciatePrefabAt(s.position)}}clearBlocksInScene(){for(let r of this.object.children)r.destroy()}};ie.TypeName="build-container",ie.Properties={}});var Ze,zn=A(()=>{Ze=class{get isPressed(){return this._isPressed}get wasPressed(){return this._wasPressed}constructor(t,r){this._gamepadButton=t,this._index=r,this._isPressed=!1,this._wasPressed=!1,this._onPressedEvent=new Array,this._onReleasedEvent=new Array}update(){if(this._isPressed=this._gamepadButton.pressed,this._isPressed&&!this._wasPressed){for(let t of this._onPressedEvent)t(this);this._wasPressed=!0}if(!this._isPressed&&this._wasPressed){for(let t=0;t<this._onReleasedEvent.length;t++)this._onReleasedEvent[t](this);this._wasPressed=!1}}addPressedListener(t){return this._onPressedEvent.push(t)-1}addReleasedListener(t){return this._onReleasedEvent.push(t)-1}removePressedListener(t){this._onPressedEvent.splice(t,1)}removeReleasedListener(t){this._onReleasedEvent.splice(t,1)}clearPressedListeners(){this._onPressedEvent=new Array}clearReleasedListeners(){this._onReleasedEvent=new Array}}});var vr=A(()=>{});var Un=A(()=>{});var $e,Vn=A(()=>{zn();vr();Un();$e=class{constructor(t,r){this._joystickTriggerValue=.5;this.setup(t,r)}get hand(){return this._hand}get joystickXValue(){return this._gamepad.axes[2]}get joystickYValue(){return this._gamepad.axes[3]}get joystickXJustMoved(){return this._joystickXJustMoved}get joystickYJustMoved(){return this._joystickYJustMoved}setup(t,r){this._gamepad=t,this._hand=r,this.initButtons()}update(){for(let t of this._buttons.keys())this._buttons.get(t).update();this._joystickXIsMoving=Math.abs(this._gamepad.axes[2])>this._joystickTriggerValue,this._joystickYIsMoving=Math.abs(this._gamepad.axes[3])>this._joystickTriggerValue,this._joystickXJustMoved=this._joystickXIsMoving&&!this._joystickXWasMoving,this._joystickYJustMoved=this._joystickYIsMoving&&!this._joystickYWasMoving,this._joystickXWasMoving=this._joystickXIsMoving,this._joystickYWasMoving=this._joystickYIsMoving}getButton(t){return this._buttons.get(t)}initButtons(){let t=[0,1,4,5];this._buttons!=null&&(this._buttons.clear(),this._buttons=null),this._buttons=new Map;for(let r=0;r<t.length;++r){let n=t[r],s=this._gamepad.buttons[n],o=new Ze(s,n);this._buttons.set(n,o)}}}});var Xn=A(()=>{});var Yn={};W(Yn,{default:()=>_e});var _e,gr=A(()=>{U();te();Ge();_e=class extends C{get isPointing(){return this._isPointing}get currentHitPosition(){return this._currentHitPosition}get currentHitObject(){return this._currentHitObject}start(){this._scene=le(),this._rayMesh=this.rayVisualObject.getComponent("mesh"),this._rayMesh.material.diffuseColor=fe.create(),this.rayVisualObject.translate([0,0,-.5]),this._origin=[0,0,0],this._direction=[0,0,0]}update(r){this.rayOrigin.getTranslationWorld(this._origin),this.rayOrigin.getForward(this._direction);let n=this._scene.rayCast(this._origin,this._direction,1);n.hitCount>0?(this._isPointing=!0,this._currentHitPosition=E.clone(n.locations[0]),this._currentHitObject=n.objects[0],this.processRayStretch(),this.cursorHitVisualObject.setTranslationWorld(this._currentHitPosition)):(this._isPointing=!1,this.rayObject.resetScaling(),this.cursorHitVisualObject.setTranslationWorld([0,-5,0]))}processRayStretch(){let r=E.create();r[0]=this._origin[0],r[1]=this._origin[1],r[2]=this._origin[2];let n=E.distance(r,this._currentHitPosition);this.rayObject.resetScaling(),this.rayObject.scale([1,n-.05,1])}};_e.TypeName="pointer-ray",_e.Properties={rayOrigin:{type:y.Object},rayObject:{type:y.Object},rayVisualObject:{type:y.Object},cursorHitVisualObject:{type:y.Object}}});var be,qn=A(()=>{U();be=class extends C{init(){this._interactCallbacks=new Array}addInteractCallback(r){this._interactCallbacks.push(r)}removeInteractCallback(r){let n=this._interactCallbacks.indexOf(r);this._interactCallbacks.splice(n,1)}};be.TypeName="ui-element-base",be.Properties={}});var Gn={};W(Gn,{default:()=>z});var z,Ce=A(()=>{U();wt();Ye();qn();z=class extends be{start(){this._meshComponent=this.object.getComponent("mesh"),this._meshMaterial=this._meshComponent.material.clone(),this._meshComponent.material=this._meshMaterial,this._textComponent=this.textObject.getComponent("text"),this.object.addComponent(ee,{tag:2})}interact(){console.log("Button clicked: "+this.object.name);for(let r of this._interactCallbacks)r();this.processVisualFeedback()}processVisualFeedback(){this._meshMaterial.color=[.635,.73,1,1],setTimeout(()=>{this._meshMaterial.color=[1,1,1,1]},100)}};z.TypeName="ui-button",z.Properties={textObject:{type:y.Object}}});var br,ye,yr=A(()=>{br=class{constructor(){this._soundEmitters=new Map}registerEmitter(t){if(this._soundEmitters.has(t.emitterType)){console.warn("Only one emitter can be register by type");return}console.log(`Register emmitter ${t.emitterType}`),this._soundEmitters.set(t.emitterType,t)}playAt(t,r){if(!this._soundEmitters.has(t)){console.warn(`Can't play sound from emitter ${t}. It doesn't exist`);return}this._soundEmitters.get(t).playAt(r)}},ye=new br});var Oe=A(()=>{});var Jn={};W(Jn,{default:()=>Pe});var Pe,Zn=A(()=>{U();Ge();Vn();Xn();gr();vr();Ie();_r();or();Ye();Ce();yr();Oe();Pe=class extends C{start(){if(this._scene=le(),this.pointerMode=0,this.inputObject===null)throw new Error("Input Object must be defined");if(this._inputComponent=this.inputObject.getComponent("input"),this._hand=this._inputComponent.handedness,this.pointerRay===null)throw new Error("Pointer Ray Object must be defined");this._pointerRayComponent=this.pointerRay.getComponent(_e),Bn().push(this.onXrSessionStart.bind(this))}update(r){if(this._xrGamepad!=null){if(this._xrGamepad.update(),!this._pointerRayComponent.isPointing){N.setCurrentPrevizPosition([0,-5,0]);return}switch(Q.getTag(this._pointerRayComponent.currentHitObject)){case 1:case 0:{let n=this._pointerRayComponent.currentHitPosition,s=ge.grid.getCellIndices(n[0],n[1],n[2]),o=ge.grid.getCellPositionVec3(s);this._xrGamepad.joystickXJustMoved&&(N.addCurrentPrevizRotation(0,this._xrGamepad.joystickXValue>0?90:-90),ye.playAt(2,this._pointerRayComponent.currentHitPosition)),N.setCurrentPrevizPosition(o);break}case 2:{N.setCurrentPrevizPosition([0,-5,0]);break}}}}onXrSessionStart(r){this.inputSourcesSetup(r)}inputSourcesSetup(r){for(let n=0;n<r.inputSources.length;++n){let s=r.inputSources[n];s.handedness===this._hand&&(console.log("Setup hand : "+s.handedness+" For XR Controller "+this._hand),this.setupXrGamepad(s.gamepad))}r.addEventListener("inputsourceschange",this.onXrInputSourceChangeHandler.bind(this))}setupXrGamepad(r){this._xrGamepad=new $e(r,this._hand),this._xrGamepad.getButton(0).addPressedListener(this.onPlacementTriggerPressed.bind(this)),this._xrGamepad.getButton(5).addPressedListener(this.onDeleteButtonPressed.bind(this))}onXrInputSourceChangeHandler(r){for(let n=0;n<r.added.length;++n){let s=r.added[n];s.handedness===this._hand&&(console.log("Setup hand : "+s.handedness+" For XR Controller "+this._hand),this.setupXrGamepad(s.gamepad))}}onPlacementTriggerPressed(){if(this._pointerRayComponent.currentHitObject)switch(Q.getTag(this._pointerRayComponent.currentHitObject)){case 1:case 0:{let r=this._pointerRayComponent.currentHitPosition,n=ge.grid.getCellIndices(r[0],r[1],r[2]),s=ge.grid.getCellPositionVec3(n);N.instanciatePrefabAt(s),ye.playAt(1,this._pointerRayComponent.currentHitPosition);break}case 2:{let r=this._pointerRayComponent.currentHitObject.getComponent(z);r&&(r.interact(),ye.playAt(0,this._pointerRayComponent.currentHitPosition));break}}}onDeleteButtonPressed(){if(this._pointerRayComponent.currentHitObject)switch(Q.getTag(this._pointerRayComponent.currentHitObject)){case 1:{this._pointerRayComponent.currentHitObject.parent.destroy(),ye.playAt(3,this._pointerRayComponent.currentHitPosition);break}}}};Pe.TypeName="XR-Controller",Pe.Properties={pointerMode:{type:y.Int,default:0},inputObject:{type:y.Object,default:null},pointerRay:{type:y.Object,default:null}}});var $n={};W($n,{default:()=>Ee});var xr,Ee,Kn=A(()=>{U();Mt();de();xr=class extends K{getPrefabUniqueName(){return xr.TypeName}start(){super.start(),V.registerPrefab(this),this.createPrevisObject()}},Ee=xr;Ee.TypeName="block-prefab",Ee.Properties={finalMesh:{type:y.Mesh},previsMesh:{type:y.Mesh},finalMat:{type:y.Material},previsMat:{type:y.Material}}});var Qn={};W(Qn,{default:()=>Le});var wr,Le,ei=A(()=>{U();Mt();de();wr=class extends K{getPrefabUniqueName(){return wr.TypeName}start(){super.start(),V.registerPrefab(this),this.createPrevisObject()}},Le=wr;Le.TypeName="block-stair-prefab",Le.Properties={finalMesh:{type:y.Mesh},previsMesh:{type:y.Mesh},finalMat:{type:y.Material},previsMat:{type:y.Material}}});var ti={};W(ti,{default:()=>Re});var Re,ri=A(()=>{U();Ce();Ie();de();Re=class extends C{start(){this._prefabComponent=V.getPrefabByName(this.prefab[V.PREFAB_UNAME_KEY]),this._buttonComponent=this.object.getComponent(z),this._buttonComponent.addInteractCallback(this.onInteractHandler.bind(this))}onInteractHandler(){N.setPrefab(this._prefabComponent)}};Re.TypeName="block-selector-interactible",Re.Properties={prefab:{type:y.Object}}});var ni={};W(ni,{default:()=>ke});var ke,ii=A(()=>{U();Ce();Ie();ke=class extends C{start(){this._color=new Float32Array([this.red,this.green,this.blue,1]),this._buttonComponent=this.object.getComponent(z),this._buttonComponent.addInteractCallback(this.onInteractHandler.bind(this))}onInteractHandler(){N.setColor(this._color)}};ke.TypeName="color-selector-interactible",ke.Properties={red:{type:y.Float},green:{type:y.Float},blue:{type:y.Float}}});var Tt,Mr,se,si=A(()=>{Tt="SAVE_DATA",Mr=class{constructor(){if(!(typeof window=="undefined"||!window.localStorage)){if(this._localStorage=window.localStorage,this._localStorage.getItem(Tt)!==null){this.processExistingSaveData();return}this.createSaveData()}}processExistingSaveData(){this._saveData=JSON.parse(this._localStorage.getItem(Tt)),console.log(this._saveData)}createSaveData(){this._saveData={saves:new Array},this._localStorage.setItem(Tt,JSON.stringify(this._saveData))}getSavesEntries(){return this._saveData.saves}createNewSaveEntry(t){return{name:t,userPref:{color:[1,1,1],block:""},blocks:new Array}}createOrUpdateSaveEntry(t){let r=this._saveData.saves;for(let n=0;n<r.length;n++)if(r[n].name==t.name){r[n]=t;return}this._saveData.saves.push(t)}removeSaveEntry(t){let r=this._saveData.saves;for(let n=0;n<r.length;n++)if(r[n].name==t.name){r.splice(n,1);return}}flushSaves(){this._localStorage.setItem(Tt,JSON.stringify(this._saveData))}},se=new Mr});var ai={};W(ai,{default:()=>Be});var Be,oi=A(()=>{U();Ce();si();Ie();Be=class extends C{start(){this._loadButton=this.loadButtonObj.getComponent(z),this._newButton=this.newButtonObj.getComponent(z),this._nextButton=this.nextButtonObj.getComponent(z),this._saveButton=this.saveButtonObj.getComponent(z),this._removeButton=this.removeButtonObj.getComponent(z),this._loadButton.addInteractCallback(this.onLoadButtonClicked.bind(this)),this._newButton.addInteractCallback(this.onNewButtonPressed.bind(this)),this._nextButton.addInteractCallback(this.onNextButtonPressed.bind(this)),this._saveButton.addInteractCallback(this.onSaveButtonPressed.bind(this)),this._removeButton.addInteractCallback(this.onRemoveButtonPressed.bind(this)),this._saveCount=this.saveCountObj.getComponent("text"),this._saveName=this.saveNameObj.getComponent("text"),this._saveEntries=se.getSavesEntries(),this._currentSaveIndex=this._saveEntries.length<1?-1:0,this._saveCount.text="Saves: "+this._saveEntries.length,this._saveName.text=this._currentSaveIndex<0?"No save available":this._saveEntries[0].name,this.loadBlankSave()}onLoadButtonClicked(){this._currentSaveIndex<0||(this._currentBuildData=this._saveEntries[this._currentSaveIndex],console.log(this._currentBuildData),N.loadBuild(this._currentBuildData.blocks))}onNewButtonPressed(){this.setCurrentSelectedSave(-1),N.loadBuild(this._currentBuildData.blocks)}onNextButtonPressed(){this._currentSaveIndex++,this._currentSaveIndex>this._saveEntries.length-1&&(this._currentSaveIndex=0),this.setCurrentSelectedSave(this._currentSaveIndex),this._saveName.text=this._currentSaveIndex<0?"No save available":this._currentBuildData.name}onSaveButtonPressed(){this._currentBuildData.blocks=N.getCurrentBuildData(),se.createOrUpdateSaveEntry(this._currentBuildData),se.flushSaves(),this._saveEntries=se.getSavesEntries(),this._currentSaveIndex=this._currentSaveIndex<0?0:this._currentSaveIndex,this._saveCount.text="Saves: "+this._saveEntries.length,this._saveName.text=this._currentSaveIndex<0?"No save available":this._saveEntries[this._currentSaveIndex].name}onRemoveButtonPressed(){if(this._currentSaveIndex<0)return;let r=this._saveEntries[this._currentSaveIndex];if(r.name==this._currentBuildData.name&&(this.setCurrentSelectedSave(-1),N.loadBuild(this._currentBuildData.blocks)),se.removeSaveEntry(r),se.flushSaves(),this._saveEntries=se.getSavesEntries(),this._saveEntries.length<1)this._currentSaveIndex=-1;else{let n=this._currentSaveIndex>this._saveEntries.length-1;this._currentSaveIndex=n?0:this._currentSaveIndex}this._saveCount.text="Saves: "+this._saveEntries.length,this._saveName.text=this._currentSaveIndex<0?"No save available":this._saveEntries[this._currentSaveIndex].name}loadBlankSave(){this.setCurrentSelectedSave(-1),N.loadBuild(this._currentBuildData.blocks)}setCurrentSelectedSave(r){switch(r){case-1:this._currentBuildData=se.createNewSaveEntry(new Date().toLocaleString());break;default:this._currentBuildData=this._saveEntries[r];break}}};Be.TypeName="save-panel",Be.Properties={loadButtonObj:{type:y.Object,default:null},newButtonObj:{type:y.Object,default:null},nextButtonObj:{type:y.Object,default:null},saveButtonObj:{type:y.Object,default:null},removeButtonObj:{type:y.Object,default:null},saveCountObj:{type:y.Object,default:null},saveNameObj:{type:y.Object,default:null}}});var Y,Ke=A(()=>{U();yr();Y=class extends C{get emitterType(){return this._emitterType}init(){this.onInit(),ye.registerEmitter(this)}start(){this._audioSource=this.object.getComponent("howler-audio-source")}playAt(r){this.object.setTranslationWorld(r),this._audioSource.play()}};Y.TypeName="sound-emitter-base",Y.Properties={}});var ci={};W(ci,{default:()=>Qe});var Qe,li=A(()=>{Ke();Oe();Qe=class extends Y{onInit(){this._emitterType=0}};Qe.TypeName="sound-emitter-click"});var di={};W(di,{default:()=>et});var et,hi=A(()=>{Ke();Oe();et=class extends Y{onInit(){this._emitterType=1}};et.TypeName="sound-emitter-place"});var _i={};W(_i,{default:()=>tt});var tt,pi=A(()=>{Ke();Oe();tt=class extends Y{onInit(){this._emitterType=2}};tt.TypeName="sound-emitter-rotate"});var fi={};W(fi,{default:()=>rt});var rt,ui=A(()=>{Ke();Oe();rt=class extends Y{onInit(){this._emitterType=3}};rt.TypeName="sound-emitter-destroy"});Cr();Or();_n();pn();fn();un();mn();vn();gn();yn();var Oo=(wt(),F(Ln)).default,Po=(kn(),F(Rn)).SecondTestComponent,Eo=(Wn(),F(Dn)).default,Lo=(mr(),F(Nn)).default;WL.registerComponent(Oo);WL.registerComponent(Po);WL.registerComponent(Eo);WL.registerComponent(Lo);var Ro=(Zn(),F(Jn)).default,ko=(gr(),F(Yn)).default;WL.registerComponent(Ro);WL.registerComponent(ko);var Bo=(Kn(),F($n)).default,Fo=(ei(),F(Qn)).default,Do=(fr(),F(Hn)).default;WL.registerComponent(Bo);WL.registerComponent(Fo);WL.registerComponent(Do);var Wo=(Ce(),F(Gn)).default,Ho=(ri(),F(ti)).default,No=(ii(),F(ni)).default,zo=(oi(),F(ai)).default;WL.registerComponent(Wo);WL.registerComponent(Ho);WL.registerComponent(No);WL.registerComponent(zo);var Uo=(li(),F(ci)).default,Vo=(hi(),F(di)).default,Xo=(pi(),F(_i)).default,Yo=(ui(),F(fi)).default;WL.registerComponent(Uo);WL.registerComponent(Vo);WL.registerComponent(Xo);WL.registerComponent(Yo);})();
/*! Bundled license information:

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
*/
//# sourceMappingURL=wonderbrick-bundle.js.map
